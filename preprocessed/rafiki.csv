['Rafiki', ':', 'Machine', 'Learning', 'as', 'an', 'Analytics', 'Service', 'System', 'Wei', 'Wang†', ',', 'Sheng', 'Wang†', ',', 'Jinyang', 'Gao†', ',', 'Meihui', 'Zhang�', 'Gang', 'Chen‡', ',', 'Teck', 'Khim', 'Ng†', ',', 'Beng', 'Chin', 'Ooi†', '†National', 'University', 'of', 'Singapore', '�Beijing', 'Institute', 'of', 'Technology', '‡Zhejiang', 'University', '†', '{', 'wangwei', ',', 'jinyang.gao', ',', 'wangsh', ',', 'ngtk', ',', 'ooibc', '}', '@', 'comp.nus.edu.sg', '�meihui', 'zhang', '@', 'bit.edu.cn', ',', '‡', 'cg', '@', 'zju.edu.cn', 'ABSTRACT', 'Big', 'data', 'analytics', 'is', 'gaining', 'massive', 'momentum', 'in', 'the', 'last', 'few', 'years', '.', 'Applying', 'machine', 'learning', 'models', 'to', 'big', 'data', 'has', 'become', 'an', 'implicit', 'requirement', 'or', 'an', 'expectation', 'for', 'most', 'analysis', 'tasks', ',', 'especially', 'on', 'high-stakes', 'applications.Typical', 'applications', 'include', 'sentiment', 'analysis', 'against', 'reviews', 'for', 'analyzing', 'on-line', 'products', ',', 'image', 'classification', 'in', 'food', 'logging', 'applications', 'for', 'monitoring', 'user', '’', 's', 'daily', 'intake', 'and', 'stock', 'movement', 'prediction', '.', 'Extending', 'tra-', 'ditional', 'database', 'systems', 'to', 'support', 'the', 'above', 'analysis', 'is', 'intriguing', 'but', 'challenging', '.', 'First', ',', 'it', 'is', 'almost', 'impossible', 'to', 'implement', 'all', 'ma-', 'chine', 'learning', 'models', 'in', 'the', 'database', 'engines', '.', 'Second', ',', 'expertise', 'knowledge', 'is', 'required', 'to', 'optimize', 'the', 'training', 'and', 'inference', 'proce-', 'dures', 'in', 'terms', 'of', 'efficiency', 'and', 'effectiveness', ',', 'which', 'imposes', 'heavy', 'burden', 'on', 'the', 'system', 'users', '.', 'In', 'this', 'paper', ',', 'we', 'develop', 'and', 'present', 'a', 'system', ',', 'called', 'Rafiki', ',', 'to', 'provide', 'the', 'training', 'and', 'inference', 'ser-', 'vice', 'of', 'machine', 'learning', 'models', ',', 'and', 'facilitate', 'complex', 'analytics', 'on', 'top', 'of', 'cloud', 'data', 'storage', 'systems', '.', 'Rafiki', 'provides', 'distributed', 'hyper-parameter', 'tuning', 'for', 'the', 'training', 'service', ',', 'and', 'online', 'ensem-', 'ble', 'modeling', 'for', 'the', 'inference', 'service', 'which', 'trades', 'off', 'between', 'latency', 'and', 'accuracy', '.', 'Experimental', 'results', 'confirm', 'the', 'efficiency', ',', 'effectiveness', ',', 'scalability', 'and', 'usability', 'of', 'Rafiki', '.', '1', '.', 'INTRODUCTION', 'Data', 'analysis', 'plays', 'an', 'important', 'role', 'in', 'extracting', 'valuable', 'in-', 'sights', 'from', 'a', 'huge', 'amount', 'of', 'data', '.', 'Database', 'systems', 'have', 'been', 'traditionally', 'used', 'for', 'storing', 'and', 'analyzing', 'structured', 'data', ',', 'spatial-', 'temporal', 'data', ',', 'graph', 'data', ',', 'etc', '.', 'Other', 'data', ',', 'such', 'as', 'multimedia', 'data', '(', 'e.g.', ',', 'images', 'and', 'free', 'text', ')', ',', 'and', 'domain', 'specific', 'data', '(', 'e.g', ',', 'medical', 'data', 'and', 'sensor', 'data', ')', ',', 'are', 'being', 'generated', 'at', 'fast', 'speed', 'and', 'con-', 'stitutes', 'a', 'significant', 'portion', 'of', 'the', 'Big', 'Data', '[', '35', ']', '.', 'It', 'is', 'beneficial', 'to', 'analyze', 'these', 'data', 'for', 'database', 'applications', '[', '36', ']', '.', 'For', 'instance', ',', 'inferring', 'the', 'quality', 'of', 'a', 'product', 'from', 'the', 'review', 'column', 'in', 'the', 'sales', 'database', 'would', 'help', 'to', 'explain', 'the', 'sales', 'numbers', ';', 'Analyz-', 'ing', 'food', 'images', 'from', 'the', 'food', 'logging', 'application', 'can', 'extract', 'the', 'food', 'preference', 'of', 'people', 'from', 'different', 'ages', '.', 'However', ',', 'the', 'above', 'analysis', 'requires', 'machine', 'learning', 'models', ',', 'especially', 'deep', 'learn-', 'ing', '[', '17', ']', 'models', ',', 'for', 'sentiment', 'analysis', '[', '4', ']', 'to', 'classify', 'the', 'review', 'as', 'positive', 'or', 'negative', ',', 'and', 'image', 'classification', '[', '15', ']', 'to', 'recognize', 'the', 'food', 'type', 'from', 'images', '.', 'Figure', '1', 'shows', 'a', 'pipeline', 'of', 'data', 'analysis', ',', 'where', 'database', 'systems', 'have', 'been', 'widely', 'used', 'for', 'the', 'first', '3', 'stages', 'and', 'machine', 'learning', 'is', 'good', 'at', 'the', '4th', 'stage', '.', 'Big', 'Data', '大数据', '•', '3Vs', ':', 'Volume', ',', 'Velocity', 'and', 'Variety', '高容量，速度快，多样性', '–', 'Variety', 'implies', 'integrating', 'and', 'analyzing', 'data', '–', 'It', 'is', 'necessary', 'to', 'develop', 'end-to-end', 'solutions', 'that', 'scale', ',', 'are', 'easy', 'to', 'use', ',', 'and', 'minimize', 'human', 'effort', 'Acquisition', 'Extraction/', 'Cleaning/', 'Annotation', 'Integration', 'Analysis/', 'Modeling', 'Interpretation/', 'Visualization', 'Figure', '1', ':', 'Data', 'analytic', 'pipeline', '.', 'One', 'approach', 'to', 'integrating', 'the', 'machine', 'learning', 'techniques', 'into', 'database', 'applications', 'is', 'to', 'preprocess', 'the', 'data', 'off-line', 'and', 'add', 'the', 'prediction', 'results', 'into', 'a', 'new', 'column', ',', 'e.g', '.', 'a', 'column', 'for', 'the', 'food', 'type', '.', 'However', ',', 'such', 'off-line', 'preprocessing', 'has', 'two-folds', 'of', 'restric-', 'tion', '.', 'First', ',', 'it', 'requires', 'the', 'developers', 'to', 'have', 'expertise', 'knowledge', 'and', 'experience', 'of', 'training', 'machine', 'learning', 'models', '.', 'Second', ',', 'the', 'queries', 'can', 'not', 'involve', 'attributes', 'of', 'the', 'object', ',', 'e.g', '.', 'the', 'ingredients', 'of', 'food', ',', 'if', 'they', 'are', 'not', 'predicted', 'in', 'the', 'preprocessing', 'step', '.', 'In', 'addi-', 'tion', ',', 'it', 'would', 'waste', 'a', 'lot', 'of', 'time', 'to', 'do', 'the', 'prediction', 'for', 'all', 'the', 'rows', 'if', 'queries', 'only', 'read', 'the', 'food', 'type', 'column', 'of', 'few', 'rows', ',', 'e.g', '.', 'due', 'to', 'a', 'filtering', 'on', 'other', 'columns', '.', 'Another', 'approach', 'is', 'to', 'carry', 'out', 'the', 'pre-', 'diction', 'on-line', 'as', 'user-defined', 'functions', '(', 'UDFs', ')', 'in', 'the', 'SQL', 'query', '.', 'However', ',', 'it', 'is', 'challenging', 'to', 'implement', 'all', 'machine', 'learning', 'mod-', 'els', 'in', 'UDFs', 'by', 'database', 'users', '[', '23', ']', ',', 'for', 'machine', 'learning', 'models', 'vary', 'a', 'lot', 'in', 'terms', 'of', 'theory', 'and', 'implementation', '.', 'It', 'is', 'also', 'difficult', 'to', 'optimize', 'the', 'prediction', 'accuracy', 'in', 'the', 'database', 'engine', '.', 'A', 'better', 'solution', 'is', 'to', 'call', 'the', 'corresponding', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', '.', 'APIs', ',', 'in', 'the', 'UDFs', 'for', 'each', 'prediction', '(', 'or', 'analysis', ')', 'task', '.', 'Cloud', 'service', 'is', 'economical', ',', 'elastic', 'and', 'easy', 'to', 'use', '.', 'With', 'the', 'resurgence', 'of', 'AI', ',', 'cloud', 'providers', 'like', 'Amazon', '(', 'AWS', ')', ',', 'Google', 'and', 'Microsoft', '(', 'Azure', ')', 'have', 'built', 'machine', 'learning', 'services', 'on', 'their', 'cloud', 'platforms', '.', 'There', 'are', 'two', 'types', 'of', 'cloud', 'services', '.', 'The', 'first', 'one', 'is', 'to', 'provide', 'an', 'API', 'for', 'each', 'specific', 'task', ',', 'e.g', '.', 'image', 'classifi-', 'cation', 'and', 'sentiment', 'analysis', '.', 'Such', 'APIs', 'are', 'available', 'on', 'Amazon', 'AWS1', 'and', 'Google', 'cloud', 'platform2', '.', 'The', 'disadvantage', 'is', 'that', 'the', 'accuracy', 'could', 'be', 'low', 'since', 'the', 'models', 'are', 'trained', 'by', 'Amazon', 'and', 'Google', 'with', 'their', 'data', ',', 'which', 'is', 'likely', 'to', 'be', 'different', 'from', 'the', 'users', '’', 'data', '.', 'The', 'second', 'type', 'of', 'service', 'overcomes', 'this', 'issue', 'by', 'providing', 'the', 'training', 'service', ',', 'where', 'users', 'can', 'upload', 'their', 'own', 'datasets', 'to', 'conduct', 'training', '.', 'This', 'service', 'is', 'available', 'on', 'Amazon', 'AWS', 'and', 'Microsoft', 'Azure', '.', 'However', ',', 'only', 'a', 'limited', 'number', 'of', 'ma-', 'chine', 'learning', 'models', 'are', 'supported', '[', '37', ']', '.', 'For', 'example', ',', 'only', 'sim-', '1https', ':', '//aws.amazon.com/machine-learning/', '2https', ':', '//cloud.google.com/products/machine-learning/', '1', 'ple', 'logistic', 'regression', 'or', 'linear', 'regression', 'models3', 'are', 'supported', 'by', 'Amazon', '.', 'Deep', 'learning', 'models', 'such', 'as', 'convolutional', 'neural', 'networks', '(', 'ConvNets', ')', 'and', 'recurrent', 'neural', 'networks', '(', 'RNN', ')', 'are', 'not', 'included', '.', 'As', 'a', 'machine', 'learning', 'cloud', 'service', ',', 'it', 'not', 'only', 'needs', 'to', 'cover', 'a', 'wide', 'range', 'of', 'models', ',', 'including', 'deep', 'learning', 'models', ',', 'but', 'also', 'provide', 'an', 'easy-to-use', ',', 'efficient', 'and', 'effective', 'service', 'for', 'users', 'with-', 'out', 'much', 'machine', 'learning', 'knowledge', 'and', 'experience', ',', 'e.g', '.', 'database', 'users', '.', 'Considering', 'that', 'different', 'models', 'may', 'result', 'in', 'different', 'performance', 'in', 'terms', 'of', 'efficiency', '(', 'e.g', '.', 'latency', ')', 'and', 'effectiveness', '(', 'e.g', '.', 'accuracy', ')', ',', 'the', 'cloud', 'service', 'has', 'to', 'select', 'the', 'proper', 'models', 'for', 'a', 'given', 'task', '.', 'Moreover', ',', 'most', 'machine', 'learning', 'models', 'and', 'the', 'training', 'algorithms', 'come', 'with', 'a', 'set', 'of', 'hyper-parameters', 'or', 'knobs', ',', 'e.g', '.', 'number', 'of', 'layers', 'and', 'size', 'of', 'each', 'layer', 'in', 'a', 'neural', 'network', '.', 'Some', 'hyper-parameters', 'are', 'vital', 'for', 'the', 'convergence', 'of', 'the', 'training', 'algorithm', 'and', 'the', 'final', 'model', 'performance', ',', 'e.g', '.', 'the', 'learning', 'rate', 'of', 'the', 'stochastic', 'gradient', 'descent', '(', 'SGD', ')', 'algorithm', '.', 'Manual', 'hyper-', 'parameter', 'tuning', 'requires', 'rich', 'experience', 'and', 'is', 'tedious', '.', 'Random', 'search', 'and', 'Bayesian', 'optimization', 'are', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approaches', '.', 'However', ',', 'both', 'are', 'costly', 'as', 'they', 'have', 'to', 'train', 'the', 'model', 'till', 'convergence', ',', 'which', 'may', 'take', 'hundreds', 'of', 'hours', '.', 'A', 'dis-', 'tributed', 'tuning', 'platform', 'is', 'desirable', '.', 'Besides', 'training', ',', 'inference4', 'also', 'matters', 'as', 'it', 'directly', 'affects', 'the', 'user', 'experience', '.', 'Machine', 'learning', 'products', 'often', 'ensemble', 'multiple', 'models', 'and', 'average', 'the', 'results', 'to', 'boost', 'the', 'prediction', 'performance', '.', 'However', ',', 'ensemble', 'modeling', 'incurs', 'a', 'larger', 'latency', '(', 'i.e', '.', 'response', 'time', ')', 'compared', 'with', 'using', 'a', 'single', 'prediction', 'model', '.', 'Therefore', ',', 'there', 'is', 'a', 'trade-off', 'be-', 'tween', 'accuracy', 'and', 'latency', '.', 'There', 'have', 'been', 'studies', 'on', 'these', 'challenges', 'for', 'providing', 'ma-', 'chine', 'learning', 'as', 'a', 'service', '.', 'mlbench', '[', '37', ']', 'compares', 'the', 'cloud', 'ser-', 'vice', 'of', 'Amazon', 'and', 'Azure', 'over', 'a', 'set', 'of', 'binary', 'classification', 'tasks', '.', 'Ease.ml', '[', '18', ']', 'builds', 'a', 'training', 'platform', 'with', 'model', 'selection', 'aim-', 'ing', 'at', 'optimizing', 'the', 'resource', 'utilization', '.', 'Google', 'Vizier', '[', '9', ']', 'is', 'a', 'distributed', 'hyper-parameter', 'tuning', 'platform', 'that', 'provides', 'tuning', 'service', 'for', 'other', 'systems', '.', 'Clipper', '[', '5', ']', 'focuses', 'on', 'the', 'inference', 'by', 'proposing', 'a', 'general', 'framework', 'and', 'specific', 'optimization', 'for', 'effi-', 'ciency', 'and', 'accuracy', '.', 'In', 'this', 'paper', ',', 'we', 'present', 'a', 'system', ',', 'called', 'Rafiki', ',', 'to', 'provide', 'both', 'the', 'training', 'and', 'inference', 'services', 'for', 'machine', 'learning', 'mod-', 'els', '.', 'With', 'Rafiki', ',', '(', 'database', ')', 'users', 'are', 'exempted', 'from', 'managing', 'the', 'hardware', 'resource', ',', 'constructing', 'the', '(', 'deep', 'learning', ')', 'models', ',', 'tun-', 'ing', 'the', 'hyper-parameters', ',', 'optimizing', 'the', 'prediction', 'accuracy', 'and', 'speed', '.', 'Instead', ',', 'they', 'simply', 'upload', 'their', 'datasets', 'and', 'configure', 'the', 'service', 'to', 'conduct', 'training', 'and', 'then', 'deploy', 'the', 'model', 'for', 'infer-', 'ence', '.', 'As', 'a', 'cloud', 'service', 'system', '[', '1', ',', '6', ']', ',', 'Rafiki', 'manages', 'the', 'hard-', 'ware', 'resources', ',', 'failure', 'recovery', ',', 'etc', '.', 'It', 'comes', 'with', 'a', 'set', 'of', 'built-in', '(', 'deep', 'learning', ')', 'models', 'for', 'popular', 'tasks', 'such', 'as', 'image', 'and', 'text', 'processing', '.', 'In', 'addition', ',', 'we', 'make', 'the', 'following', 'contributions', 'to', 'make', 'Rafiki', 'easy-to-use', ',', 'efficient', 'and', 'effective', '.', '1', '.', 'We', 'propose', 'a', 'unified', 'system', 'architecture', 'for', 'both', 'the', 'train-', 'ing', 'and', 'the', 'inference', 'services', '.', 'We', 'observe', 'that', 'the', 'two', 'ser-', 'vices', 'share', 'some', 'common', 'components', 'such', 'as', 'a', 'parameter', 'server', 'for', 'model', 'parameter', 'storage', ',', 'and', 'distributed', 'comput-', 'ing', 'environment', 'for', 'distributed', 'hyper-parameter', 'tuning', 'and', 'parallel', 'inference', '.', 'By', 'sharing', 'the', 'same', 'underlying', 'storage', ',', 'communication', 'protocols', 'and', 'computation', 'resource', ',', 'we', 'im-', 'plicitly', 'avoid', 'some', 'technical', 'debts', '[', '25', ']', '.', 'Moreover', ',', 'by', 'com-', '3https', ':', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4We', 'use', 'the', 'term', 'deployment', ',', 'inference', 'and', 'serving', 'interchange-', 'ably', '.', 'bining', 'the', 'two', 'services', 'together', ',', 'Rafiki', 'enables', 'instant', 'model', 'deployment', 'after', 'training', '.', '2', '.', 'For', 'the', 'training', 'service', ',', 'we', 'first', 'propose', 'a', 'general', 'frame-', 'work', 'for', 'distributed', 'hyper-parameter', 'tuning', ',', 'which', 'is', 'ex-', 'tensible', 'for', 'popular', 'hyper-parameter', 'tuning', 'algorithms', 'in-', 'cluding', 'random', 'search', 'and', 'Bayesian', 'optimization', '.', 'In', 'addi-', 'tion', ',', 'we', 'propose', 'a', 'collaborative', 'tuning', 'scheme', 'specifically', 'for', 'deep', 'learning', 'models', ',', 'which', 'uses', 'the', 'model', 'parameters', 'from', 'the', 'current', 'top', 'performing', 'training', 'trials', 'to', 'initialize', 'new', 'trials', '.', '3', '.', 'For', 'the', 'inference', 'service', ',', 'we', 'propose', 'a', 'scheduling', 'algorithm', 'based', 'on', 'reinforcement', 'learning', 'to', 'optimize', 'the', 'overall', 'ac-', 'curacy', 'and', 'reduce', 'latency', '.', 'Both', 'algorithms', 'are', 'adaptive', 'to', 'the', 'changes', 'of', 'the', 'request', 'arrival', 'rate', '.', '4', '.', 'We', 'conduct', 'micro-benchmark', 'experiments', 'to', 'evaluate', 'the', 'performance', 'of', 'our', 'proposed', 'algorithms', '.', 'In', 'the', 'reminder', 'of', 'this', 'paper', ',', 'we', 'give', 'the', 'system', 'architecture', 'in', 'Section', '3', '.', 'Section', '4', 'describes', 'the', 'training', 'service', 'and', 'the', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'algorithm', '.', 'The', 'deployment', 'ser-', 'vice', 'and', 'optimization', 'techniques', 'are', 'introduced', 'in', 'Section', '5', '.', 'Sec-', 'tion', '6', 'describes', 'the', 'system', 'implementation', '.', 'We', 'explain', 'the', 'ex-', 'perimental', 'study', 'in', 'Section', '7', 'and', 'then', 'introduce', 'related', 'works', 'in', 'Section', '2', '.', '2', '.', 'RELATED', 'WORK', 'Rafiki', 'is', 'a', 'SaaS', 'that', 'provides', 'analytics', 'services', 'based', 'on', 'ma-', 'chine', 'learning', '.', 'Optimization', 'techniques', 'are', 'proposed', 'for', 'both', 'the', 'training', '(', 'i.e', '.', 'distributed', 'hyper-parameter', 'tuning', ')', 'and', 'the', 'inference', 'stage', '(', 'i.e', '.', 'accuracy', 'and', 'latency', 'optimization', ')', '.', 'In', 'this', 'section', ',', 'we', 'review', 'related', 'work', 'on', 'SaaS', ',', 'hyper-parameter', 'tuning', ',', 'inference', 'op-', 'timization', ',', 'and', 'reinforcement', 'learning', 'which', 'is', 'adopted', 'by', 'Rafiki', 'for', 'inference', 'optimization', '.', '2.1', 'Software', 'as', 'a', 'Service', 'Cloud', 'computing', 'has', 'changed', 'the', 'way', 'of', 'IT', 'operation', 'in', 'many', 'companies', 'by', 'providing', 'infrastructure', 'as', 'a', 'service', '(', 'IaaS', ')', ',', 'platform', 'as', 'a', 'service', '(', 'PaaS', ')', 'and', 'software', 'as', 'a', 'service', '(', 'SaaS', ')', '.', 'With', 'IaaS', ',', 'users', 'and', 'companies', 'can', 'use', 'remote', 'physical', 'or', 'virtual', 'machines', 'instead', 'of', 'establishing', 'their', 'own', 'data', 'center', '.', 'Based', 'on', 'user', 'require-', 'ments', ',', 'IaaS', 'can', 'scale', 'up', 'the', 'compute', 'resources', 'quickly', '.', 'PaaS', ',', 'e.g.', ',', 'Microsoft', 'Azure', ',', 'provides', 'development', 'toolkit', 'and', 'running', 'envi-', 'ronment', ',', 'which', 'can', 'be', 'adjusted', 'automatically', 'based', 'on', 'business', 'demand', '.', 'SaaS', ',', 'including', 'database', 'as', 'a', 'service', '[', '1', ',', '6', ']', ',', 'installs', 'soft-', 'ware', 'on', 'cloud', 'computing', 'platforms', 'and', 'provides', 'application', 'ser-', 'vices', ',', 'which', 'simplifies', 'software', 'maintenance', '.', 'The', '‘', 'pay', 'as', 'you', 'go', '’', 'pricing', 'model', 'is', 'convenient', 'and', 'economic', 'for', '(', 'small', ')', 'companies', 'and', 'research', 'labs', '.', 'Recently', ',', 'machine', 'learning', '(', 'especially', 'deep', 'learning', ')', 'has', 'gain', 'a', 'lot', 'of', 'interest', 'due', 'to', 'its', 'outstanding', 'performance', 'in', 'analytic', 'and', 'predictive', 'tasks', '.', 'There', 'are', 'two', 'primary', 'steps', 'to', 'apply', 'machine', 'learning', 'for', 'an', 'application', ',', 'namely', 'training', 'and', 'inference', '.', 'Cloud', 'providers', ',', 'like', 'Amazon', 'AWS', ',', 'Microsoft', 'Azure', 'and', 'Google', 'Cloud', ',', 'have', 'already', 'included', 'some', 'services', 'for', 'the', 'two', 'steps', '.', 'However', ',', 'their', 'training', 'services', 'have', 'limited', 'support', 'for', 'deep', 'learning', 'mod-', 'els', ',', 'and', 'their', 'inference', 'services', 'can', 'not', 'be', 'customized', 'for', 'customers', '’', 'data', '(', 'see', 'the', 'explanation', 'in', 'Section', '1', ')', '.', 'There', 'are', 'also', 'research', 'papers', 'towards', 'efficient', 'resource', 'allocation', 'for', 'training', '[', '18', ']', 'and', 'efficient', 'inference', '[', '5', ']', 'on', 'the', 'cloud', '.', 'Rafiki', 'differs', 'from', 'the', 'exist-', 'ing', 'cloud', 'services', 'on', 'both', 'the', 'service', 'types', 'and', 'the', 'optimization', 'techniques', '.', 'Firstly', ',', 'Rafiki', 'allows', 'users', 'to', 'train', 'machine', 'learning', '2', '(', 'including', 'deep', 'learning', ')', 'models', 'on', 'their', 'own', 'data', ',', 'and', 'then', 'de-', 'ploy', 'them', 'for', 'inference', '.', 'Secondly', ',', 'Rafiki', 'has', 'special', 'optimization', 'for', 'the', 'training', 'and', 'inference', 'service', ',', 'compared', 'with', 'the', 'existing', 'approaches', 'as', 'explained', 'in', 'the', 'following', 'two', 'subsections', '.', '2.2', 'Hyper-parameter', 'Tuning', 'To', 'train', 'a', 'machine', 'learning', 'model', 'for', 'an', 'application', ',', 'we', 'need', 'to', 'decide', 'many', 'hyper-parameters', 'related', 'to', 'the', 'model', 'structure', ',', 'opti-', 'mization', 'algorithm', 'and', 'data', 'preprocessing', 'operations', '.', 'All', 'hyper-', 'parameter', 'tuning', 'algorithms', 'work', 'by', 'empirical', 'trials', '.', 'Random', 'search', '[', '3', ']', 'randomly', 'selects', 'the', 'value', 'of', 'each', 'hyper-parameter', 'and', 'then', 'try', 'it', '.', 'It', 'has', 'shown', 'to', 'be', 'more', 'efficient', 'than', 'grid', 'search', 'that', 'enumerates', 'all', 'possible', 'hyper-parameter', 'combinations', '.', 'Bayesian', 'optimization', '[', '28', ']', 'assumes', 'the', 'optimization', 'function', '(', 'hyper-parameters', 'as', 'the', 'input', 'and', 'the', 'inference', 'performance', 'as', 'the', 'output', ')', 'follows', 'Gaussian', 'process', '.', 'It', 'samples', 'the', 'next', 'point', 'in', 'the', 'hyper-parameter', 'space', 'based', 'on', 'existing', 'trials', '(', 'according', 'to', 'an', 'acquisition', 'function', ')', '.', 'Reinforcement', 'learning', 'has', 'recently', 'been', 'applied', 'to', 'tune', 'the', 'archi-', 'tecture', 'related', 'hyper-parameters', '[', '38', ']', '.', 'Google', 'Vizier', '[', '9', ']', 'provides', 'hyper-parameter', 'tuning', 'service', 'on', 'the', 'cloud', '.', 'Rafiki', 'provides', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'service', ',', 'which', 'is', 'compatible', 'with', 'all', 'the', 'above', 'mentioned', 'hyper-parameter', 'tuning', 'algorithms', '.', 'In', 'ad-', 'dition', ',', 'it', 'supports', 'collaborative', 'tuning', 'that', 'shares', 'model', 'parame-', 'ters', 'across', 'trials', '.', 'Our', 'experiments', 'confirm', 'the', 'effectiveness', 'of', 'the', 'collaborative', 'tuning', 'scheme', '.', '2.3', 'Inference', 'Optimization', 'To', 'improve', 'the', 'inference', 'accuracy', ',', 'ensemble', 'modeling', 'that', 'trains', 'and', 'deploys', 'multiple', 'models', 'is', 'widely', 'applied', '.', 'For', 'real-time', 'in-', 'ference', ',', 'latency', 'is', 'another', 'critical', 'metric', 'of', 'the', 'inference', 'service', '.', 'NoScope', '[', '14', ']', 'proposes', 'specific', 'inference', 'optimization', 'for', 'video', 'querying', '.', 'Clipper', '[', '5', ']', 'studies', 'multiple', 'optimization', 'techniques', 'to', 'improve', 'the', 'throughput', '(', 'via', 'batch', 'size', ')', 'and', 'reduce', 'latency', '(', 'via', 'caching', ')', '.', 'It', 'also', 'proposes', 'to', 'do', 'model', 'selection', 'for', 'ensemble', 'mod-', 'eling', 'using', 'multi-armed', 'bandit', 'algorithms', '.', 'Compared', 'with', 'Clip-', 'per', ',', 'Rafiki', 'provides', 'both', 'training', 'and', 'inference', 'services', ',', 'whereas', 'Clipper', 'focuses', 'only', 'on', 'the', 'inference', 'service', '.', 'Also', ',', 'Clipper', 'op-', 'timizes', 'the', 'throughput', ',', 'latency', 'and', 'accuracy', 'separately', ',', 'whereas', 'Rafiki', 'models', 'them', 'together', 'to', 'find', 'the', 'optimal', 'model', 'selection', 'and', 'batch', 'size', '.', 'TensorFlow', 'serving', '[', '2', ']', 'and', 'TFX', '[', '21', ']', 'provide', 'inference', 'service', 'for', 'models', 'trained', 'using', 'Tensorflow', '.', 'Rafiki', 'and', 'Clipper', 'are', 'both', 'implementation', 'agnostic', '.', 'They', 'communicate', 'with', 'the', 'training', 'and', 'inference', 'programs', 'in', 'Docker', 'containers', 'via', 'RPC', '.', '2.4', 'Reinforcement', 'Learning', 'In', 'reinforcement', 'learning', '(', 'RL', ')', '[', '31', ']', ',', 'each', 'time', 'an', 'agent', 'takes', 'one', 'action', ',', 'it', 'enters', 'the', 'next', 'state', '.', 'The', 'environment', 'returns', 'a', 'reward', 'based', 'on', 'the', 'action', 'and', 'the', 'states', '.', 'The', 'learning', 'objective', 'is', 'to', 'maximize', 'the', 'aggregated', 'rewards', '.', 'RL', 'algorithms', 'decide', 'the', 'ac-', 'tion', 'to', 'take', 'based', 'on', 'the', 'current', 'state', 'and', 'experience', 'gained', 'from', 'previous', 'trials', '(', 'exploration', ')', '.', 'Policy', 'gradient', 'based', 'RL', 'algorithms', 'maximize', 'the', 'expected', 'reward', 'by', 'taking', 'actions', 'following', 'a', 'policy', 'function', 'πθ', '(', 'at|st', ')', 'over', 'n', 'steps', '(', 'Equation', '1', ')', ',', 'where', 'ς', 'represents', 'a', 'trajectory', 'of', 'n', '(', 'action', 'at', ',', 'state', 'st', ',', 'reward', 'Rt', ')', 'tuples', ',', 'and', 'γ', 'is', 'a', 'decaying', 'factor', '.', 'The', 'expectation', 'is', 'taken', 'over', 'all', 'possible', 'trajec-', 'tories', '.', 'πθ', 'is', 'usually', 'implemented', 'using', 'a', 'multi-layer', 'perceptron', 'model', '(', 'θ', 'represents', 'the', 'parameters', ')', 'that', 'takes', 'the', 'state', 'vector', 'as', 'input', 'and', 'generates', 'the', 'action', '(', 'a', 'scalar', 'value', 'for', 'continuous', 'action', 'or', 'a', 'Softmax', 'output', 'for', 'discrete', 'actions', ')', '.', 'Equation', '1', 'is', 'optimized', 'using', 'stochastic', 'gradient', 'ascent', 'methods', '.', 'Equation', '3', 'is', 'used', 'as', 'a', '‘', 'surrogate', '’', 'function', 'for', 'the', 'objective', 'as', 'its', 'gradient', 'is', 'easy', 'to', 'com-', 'pute', 'via', 'automatic', 'differentiation', '.', 'J', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'n∑', 't=0', 'γtRt', ']', ',', '(', '1', ')', 'OθJ', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'n∑', 't=0', 'Oθ', 'log', 'πθ', '(', 'at|st', ')', 'T∑', 't=0', 'γtRt', ']', '(', '2', ')', 'Ĵ', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'T∑', 't=0', 'log', 'πθ', '(', 'at|st', ')', 'n∑', 't=0', 'γtRt', ']', '(', '3', ')', 'Many', 'approaches', 'have', 'been', 'proposed', 'to', 'improve', 'the', 'policy', 'gra-', 'dient', 'by', 'reducing', 'the', 'variance', 'of', 'the', 'rewards', ',', 'including', 'actor-critic', 'model', '[', '20', ']', 'which', 'subtracts', 'the', 'reward', 'Rt', 'by', 'a', 'baseline', 'V', '(', 'st', ')', '.', 'V', '(', 'st', ')', 'is', 'an', 'estimation', 'of', 'the', 'reward', ',', 'which', 'is', 'also', 'approximated', 'using', 'a', 'neural', 'network', 'like', 'the', 'policy', 'function', '.', 'Then', 'Rt', 'in', 'the', 'above', 'equations', 'becomesRt−V', '(', 'st', ')', '.', 'Yuxi', '[', '19', ']', 'has', 'done', 'a', 'survey', 'of', 'deep', 'reinforcement', 'learning', ',', 'including', 'the', 'actor-critic', 'model', 'used', 'in', 'this', 'paper', '.', '3', '.', 'SYSTEM', 'OVERVIEW', 'In', 'this', 'section', ',', 'we', 'present', 'the', 'system', 'architecture', 'of', 'Rafiki', 'and', 'illustrate', 'its', 'usability', 'with', 'some', 'use', 'cases', '.', 'To', 'use', 'Rafiki', ',', 'users', 'simply', 'configure', 'the', 'training', 'or', 'inference', 'jobs', 'through', 'either', 'RESTFul', 'APIs', 'or', 'Python', 'SDK', '.', 'In', 'Figure', '2', '(', 'left', 'column', ')', ',', 'we', 'show', 'one', 'image', 'classification', 'example', 'using', 'the', 'Python', 'SDK', '.', 'The', 'training', 'code', 'consists', 'of', '4', 'lines', '.', 'The', 'first', 'line', 'loads', 'the', 'images', 'from', 'a', 'folder', 'into', 'Rafiki', '’', 's', 'distributed', 'data', 'stor-', 'age', '(', 'HDFS', ')', ',', 'where', 'all', 'images', 'from', 'the', 'same', 'subfolder', 'are', 'labeled', 'with', 'the', 'subfolder', 'name', ',', 'i.e', '.', 'food', 'name', '.', 'The', 'second', 'line', 'creates', 'a', 'configuration', 'object', 'representing', 'hyper-parameter', 'tuning', 'options', '(', 'see', 'Section', '4.2', 'for', 'details', ')', '.', 'The', 'third', 'line', 'creates', 'the', 'training', 'job', 'by', 'passing', 'the', 'data', ',', 'the', 'options', 'and', 'the', 'input/output', 'shapes', '(', 'a', 'tuple', 'or', 'a', 'list', 'of', 'tuples', ')', '.', 'The', 'input-output', 'shapes', 'are', 'used', 'for', 'model', 'cus-', 'tomization', '.', 'For', 'example', ',', 'ConvNets', 'usually', 'accept', 'input', 'images', 'of', 'a', 'fixed', 'shape', ',', 'i.e', '.', 'the', 'input', 'shape', ',', 'and', 'adapt', 'the', 'final', 'output', 'layer', 'to', 'generate', 'the', 'same', 'number', 'of', 'outputs', 'as', 'the', 'output', 'shape', ',', 'which', 'could', 'be', 'the', 'total', 'number', 'of', 'classes', 'or', 'bounding-box', 'shape', '.', 'The', 'last', 'line', 'submits', 'the', 'job', 'through', 'RESTFul', 'APIs', 'to', 'Rafiki', 'for', 'exe-', 'cution', '.', 'It', 'returns', 'a', 'job', 'ID', 'as', 'a', 'handle', 'for', 'job', 'monitoring', '.', 'Once', 'the', 'training', 'finishes', ',', 'we', 'can', 'deploy', 'the', 'models', 'instantly', 'as', 'shown', 'in', 'infer.py', '.', 'It', 'gets', 'the', 'model', 'instances', ',', 'each', 'of', 'which', 'consists', 'of', 'the', 'model', 'name', 'and', 'the', 'parameter', 'names', 'for', 'retrieving', 'the', 'parameter', 'values', 'from', 'Rafiki', '’', 's', 'parameter', 'server', '.', 'It', 'then', 'uses', 'the', 'second', 'line', 'to', 'create', 'the', 'inference', 'job', 'with', 'the', 'given', 'models', '.', 'After', 'the', 'model', 'is', 'deployed', 'by', 'line', '3', ',', 'application', 'users', 'can', 'submit', 'their', 'requests', 'to', 'this', 'job', 'for', 'prediction', 'as', 'shown', 'by', 'the', 'code', 'in', 'query.py', '.', 'Ap-', 'plications', 'like', 'a', 'mobile', 'App', 'can', 'send', 'RESTFul', 'requests', 'to', 'do', 'the', 'query', '.', 'For', 'each', 'training', 'job', ',', 'Rafiki', 'selects', 'the', 'corresponding', 'built-in', 'models', 'based', 'on', 'the', 'task', 'type', '.', 'The', 'table', 'in', 'Figure', '2', 'lists', 'some', 'built-in', 'tasks', 'and', 'the', 'models', '.', 'With', 'the', 'proliferation', 'of', 'machine', 'learning', ',', 'we', 'are', 'able', 'to', 'find', 'open', 'source', 'implementations', 'for', 'al-', 'most', 'every', 'model', '.', 'Figure', '3', 'compares', 'the', 'memory', 'footprint', ',', 'ac-', 'curacy', 'and', 'inference', 'speed', 'of', 'some', 'open', 'source', 'ConvNets5', '.', '5', 'Groups', 'of', 'ConvNets', 'are', 'compared', ',', 'including', 'Inception', 'ConvNets', '[', '32', ']', ',', 'MobileNet', '[', '12', ']', ',', 'NASNets', '[', '38', ']', ',', 'ResNets', '[', '10', ']', 'and', 'VGGs', '[', '27', ']', '.', 'The', 'accuracy', 'is', 'measured', 'based', 'on', 'the', 'top-1', 'prediction', 'of', 'images', 'from', 'the', 'validation', 'dataset', 'of', 'ImageNet', '.', 'The', 'inference', 'time', 'and', 'mem-', 'ory', 'footprint', 'is', 'averaged', 'over', '50', 'iterations', ',', 'each', 'with', '50', 'images', '(', 'i.e', '.', 'batch', 'size=50', ')', '.', '5https', ':', '//github.com/tensorflow/models/tree/master/research/slim/', '3', 'Data', 'Hyper-tune', 'Hyper-tune', 'Ensemble', 'modelling', 'ResNet', 'Parameter', 'Task', 'Models', 'Image', 'classification', 'VGG', ',', 'ResNet', ',', 'Squeezenet', ',', 'XceptionNet', ',', 'InceptionNet', 'Object', 'detection', 'YOLO', ',', 'SSD', ',', 'FasterRCNN', 'Sentiment', 'analysis', 'TemporalCNN', ',', 'FastText', ',', 'CharacterRNN', '…', '…', 'ResNet', 'ResNetVGG', 'VGG', 'VGG', 'Master', 'Worker', 'Rafiki', 'user', 'code', 'Rafiki', 'Application', 'user', 'code', '#', 'train.py', 'import', 'rafiki', 'data', '=', 'rafiki.import_images', '(', "'food/", "'", ')', 'hyper', '=', 'rafiki.HyperConf', '(', ')', 'job', '=', 'rafiki.Train', '(', "name='train", '’', ',', 'data=data', ',', 'task=', "''", 'ImageClassification', "''", ',', 'input_shape=', '(', '3,256,256', ')', ',', 'output_shape=', '(', '120', ',', ')', ',', 'hyper', '=', 'hyper', ')', 'job_id', '=', 'job.run', '(', ')', '#', 'infer.py', 'models', '=', 'rafiki.get_models', '(', 'job_id', ')', 'job', '=', 'rafiki.Inference', '(', 'models', ')', 'job_id', '=', 'job.run', '(', ')', 'img', '=', 'Image.load', '(', "'test.jpg", "'", ')', 'ret', '=', 'rafiki.query', '(', 'job=job_id', ',', 'data=', '{', "'img", "'", ':', 'img', '}', ')', 'print', '(', 'ret', '[', "'label", "'", ']', ')', 'ret', '[', '‘', 'label', '’', ']', 'Figure', '2', ':', 'Overview', 'of', 'Rafiki', '.', '0.2', '0.4', '0.6', '0.8', '1.0', 'Time', 'for', 'Each', 'Iteration', '(', 's', ')', '0.70', '0.75', '0.80', 'Ac', 'cu', 'ra', 'cy', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'Figure', '3', ':', 'Accuracy', ',', 'inference', 'time', 'and', 'memory', 'footprint', 'of', 'popular', 'ConvNets', '.', 'Hyper-parameter', 'tuning', '(', 'See', 'Section', '4.2', ')', 'is', 'conducted', 'for', 'every', 'selected', 'model', '.', 'For', 'example', ',', 'two', 'sets', 'of', 'hyper-parameters', 'are', 'be-', 'ing', 'tested', 'for', 'ResNet', '[', '10', ']', '(', 'resp', '.', 'VGG', '[', '27', ']', ')', 'as', 'shown', 'in', 'Figure', '2', '.', 'The', 'trained', 'model', 'parameters', 'are', 'stored', 'in', 'the', 'global', 'parameter', 'server', '(', 'PS', ')', ',', 'which', 'is', 'a', 'persistent', 'distributed', 'in-memory', 'storage', '.', 'Once', 'the', 'training', 'is', 'done', ',', 'the', 'inference', 'workers', 'fetch', 'the', 'parame-', 'ters', 'from', 'the', 'PS', 'efficiently', '.', 'The', 'inference', 'job', 'launches', 'the', 'models', 'passed', 'by', 'user', 'configuration', '.', 'Ensemble', 'modeling', '(', 'See', 'section', '5', ')', 'is', 'applied', 'to', 'optimize', 'the', 'inference', 'accuracy', 'of', 'the', 'requests', 'from', 'application', '(', 'e.g', '.', 'database', ')', 'users', '.', 'Rafiki', 'is', 'compatible', 'for', 'any', 'machine', 'learning', 'framework', ',', 'in-', 'cluding', 'TensorFlow', '[', '2', ']', ',', 'Scikit-learn', ',', 'Kears', ',', 'etc.', ',', 'although', 'we', 'have', 'built', 'it', 'on', 'top', 'of', 'Apache', 'Singa', '[', '34', ',', '22', ',', '33', ']', 'due', 'to', 'its', 'efficiency', 'and', 'scalable', 'architecture', '.', 'More', 'details', 'Rafiki', 'implementation', 'will', 'be', 'described', 'in', 'Section', '6', '.', '4', '.', 'TRAINING', 'SERVICE', 'The', 'training', 'service', 'consists', 'of', 'two', 'steps', ',', 'namely', 'model', 'selec-', 'tion', 'and', 'hyper-parameter', 'tuning', '.', 'We', 'adopt', 'a', 'simple', 'model', 'selec-', 'tion', 'strategy', 'in', 'Rafiki', '.', 'For', 'hyper-parameter', 'tuning', ',', 'we', 'first', 'pro-', 'pose', 'a', 'general', 'programming', 'model', 'for', 'distributed', 'tuning', ',', 'and', 'then', 'propose', 'a', 'collaborative', 'tuning', 'scheme', '.', '4.1', 'Model', 'Selection', 'Every', 'built-in', 'model', 'in', 'Rafiki', 'is', 'registered', 'under', 'a', 'task', ',', 'e.g', '.', 'im-', 'age', 'classification', 'or', 'sentiment', 'analysis', '.', 'Each', 'model', 'is', 'associated', 'with', 'some', 'meta', 'data', 'including', 'its', 'training', 'cost', ',', 'e.g', '.', 'the', 'speed', 'and', 'memory', 'consumption', ',', 'and', 'the', 'performance', 'on', 'each', 'dataset', '(', 'e.g', '.', 'accuracy', 'or', 'area-under-curve', ')', '.', 'Ease.ml', '[', '18', ']', 'proposes', 'to', 'convert', 'the', 'model', 'selection', 'into', 'a', 'multi-armed', 'bandit', 'problem', ',', 'where', 'ev-', 'ery', 'model', '(', 'i.e', '.', 'an', 'arm', ')', 'gets', 'the', 'chance', 'of', 'training', '.', 'After', 'many', 'trials', ',', 'the', 'chance', 'of', 'under-performed', 'models', 'would', 'be', 'decreased', '.', 'We', 'observe', 'that', 'the', 'models', 'for', 'the', 'same', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', '.', 'For', 'example', ',', 'ResNet', '[', '10', ']', 'is', 'better', 'than', 'AlexNet', '[', '15', ']', 'and', 'SqueezeNet', '[', '13', ']', 'for', 'a', 'bunch', 'of', 'datasets', 'including', 'Ima-', 'geNet', '[', '7', ']', ',', 'CIFAR-106', ',', 'etc..', 'Therefore', ',', 'we', 'adopt', 'a', 'simple', 'model', 'selection', 'strategy', 'without', 'any', 'advanced', 'analysis', '.', 'We', 'select', 'the', 'models', 'with', 'similar', 'performance', 'but', 'with', 'different', 'architectures', '.', 'This', 'is', 'to', 'create', 'a', 'diverse', 'model', 'set', '[', '16', ']', 'whose', 'performance', 'would', 'be', 'boosted', 'when', 'applying', 'ensemble', 'modeling', '.', '4.2', 'Distributed', 'Hyper-parameter', 'Tuning', 'Hyper-parameter', 'tuning', 'usually', 'has', 'to', 'run', 'many', 'different', 'sets', 'of', 'hyper-parameters', '.', 'Distributed', 'tuning', 'by', 'running', 'these', 'instances', 'in', 'parallel', 'is', 'a', 'natural', 'solution', 'for', 'reducing', 'the', 'tuning', 'time', '.', 'There', '6https', ':', '//www.cs.toronto.edu/', 'kriz/cifar.html', '4', 'Table', '1', ':', 'Hyper-parameter', 'groups', '.', 'Group', 'Hyper-parameter', 'Example', 'Domain', '1', '.', 'Data', 'preprocessing', 'Image', 'rotation', '[', '0,30', ')', 'Image', 'cropping', '[', '0,32', ']', 'Whitening', '{', 'PCA', ',', 'ZCA', '}', '2', '.', 'Model', 'architecture', 'Number', 'of', 'layers', 'Z+', 'N', 'cluster', 'Z+', 'Kernel', '{', 'Linear', ',', 'RBF', ',', 'Poly', '}', '3', '.', 'Training', 'algorithm', 'Learning', 'rate', 'R+', 'Weight', 'decay', 'R+', 'Momentum', 'R+', 'are', 'three', 'popular', 'approaches', 'for', 'hyper-parameter', 'tuning', ',', 'namely', 'grid', 'search', ',', 'random', 'search', '[', '3', ']', 'and', 'Bayesian', 'optimization', '[', '26', ']', '.', 'To', 'support', 'these', 'algorithms', ',', 'we', 'need', 'a', 'general', 'and', 'extensible', 'pro-', 'gramming', 'model', '.', '4.2.1', 'Programming', 'Model', 'We', 'cluster', 'the', 'hyper-parameters', 'involved', 'in', 'training', 'a', 'machine', 'learning', 'model', 'into', 'three', 'groups', 'as', 'shown', 'in', 'Table', '1', '.', 'Data', 'prepro-', 'cessing', 'adopts', 'different', 'approaches', 'to', 'normalize', 'the', 'data', ',', 'augment', 'the', 'dataset', 'and', 'extract', 'features', 'from', 'the', 'raw', 'data', ',', 'i.e', '.', 'feature', 'en-', 'gineering', '.', 'Most', 'machine', 'learning', 'models', 'have', 'some', 'tuning', 'knobs', 'which', 'form', 'the', 'architecture', '’', 's', 'hyper-parameters', ',', 'e.g', '.', 'the', 'number', 'of', 'trees', 'in', 'a', 'random', 'forest', ',', 'number', 'of', 'layers', 'of', 'ConvNets', 'and', 'the', 'kernel', 'function', 'of', 'SVM', '.', 'The', 'optimization', 'algorithms', ',', 'especially', 'the', 'gradient', 'based', 'optimization', 'algorithms', 'like', 'SGD', ',', 'have', 'many', 'hyper-parameters', ',', 'including', 'the', 'initial', 'learning', 'rate', ',', 'the', 'decaying', 'rate', 'and', 'decaying', 'method', '(', 'linear', 'or', 'exponential', ')', ',', 'etc', '.', 'From', 'Table', '1', 'we', 'can', 'see', 'that', 'the', 'hyper-parameters', 'could', 'come', 'from', 'a', 'range', 'or', 'a', 'list', 'of', 'numbers', 'or', 'categories', '.', 'All', 'possible', 'as-', 'signments', 'of', 'the', 'hyper-parameters', 'construct', 'the', 'hyper-parameter', 'space', ',', 'denoted', 'as', 'H.', 'Following', 'the', 'convention', '[', '9', ']', ',', 'we', 'call', 'one', 'point', 'in', 'the', 'space', 'as', 'a', 'trial', ',', 'denoted', 'as', 'h.', 'Rafiki', 'provides', 'a', 'Hyper-', 'Space', 'class', 'with', 'the', 'functions', 'shown', 'in', 'Figure', '4', 'for', 'developers', 'to', 'specify', 'the', 'hyper-parameter', 'space', '.', 'import', 'rafiki', 'data', '=', 'rafiki.import_images', '(', "'food/", "'", ')', 'hyper', '=', 'rafiki.HyperConf', '(', ')', 'job', '=', 'rafiki.Train', '(', "name='train", '’', ',', 'data=data', ',', 'task=', "''", 'ImageClassification', "''", ',', 'input_shape=', '(', '3,256,256', ')', ',', 'output_shape=', '(', '120', ',', ')', ',', 'hyper', '=', 'hyper', ')', 'job_id', '=', 'job.run', '(', ')', 'models', '=', 'rafiki.get_models', '(', 'job_id', ')', 'job', '=', 'rafiki.Inference', '(', 'models', ')', 'job_id', '=', 'job.run', '(', ')', 'img', '=', 'Image.load', '(', "'test.jpg", "'", ')', 'ret', '=', 'rafiki.query', '(', 'job=job_id', ',', 'data=', '{', "'img", "'", ':', 'img', '}', ')', 'print', '(', 'ret', '[', "'label", "'", ']', ')', 'class', 'HyperSpace', '(', ')', ':', 'def', 'add_range_knob', '(', 'name', ',', 'dtype', ',', 'min', ',', 'max', ',', 'depends=None', ',', 'pre_hook=None', ',', 'post_hook=None', ')', 'def', 'add_categorical_knob', '(', 'name', ',', 'dtype', ',', 'list', ',', 'depends=None', ',', 'pre_hook=None', ',', 'post_hook=None', ')', 'Figure', '4', ':', 'HyperSpace', 'APIs', '.', 'The', 'first', 'function', 'defines', 'the', 'domain', 'of', 'a', 'hyper-parameter', 'as', 'a', 'range', '[', 'min', ',', 'max', ')', ';', 'dtype', 'represents', 'the', 'data', 'type', 'which', 'could', 'be', 'float', ',', 'integer', 'or', 'string', '.', 'depends', 'is', 'a', 'list', 'of', 'other', 'hyper-parameters', 'whose', 'values', 'directly', 'affect', 'the', 'generation', 'of', 'this', 'hyper-parameter', '.', 'For', 'example', ',', 'if', 'the', 'initial', 'learning', 'rate', 'is', 'very', 'large', ',', 'then', 'we', 'would', 'prefer', 'a', 'larger', 'decay', 'rate', 'to', 'decease', 'the', 'learning', 'rate', 'quickly', '.', 'There-', 'fore', ',', 'the', 'decay', 'rate', 'has', 'to', 'be', 'generated', 'after', 'generating', 'the', 'learn-', 'ing', 'rate', '.', 'To', 'enforce', 'such', 'relation', ',', 'we', 'can', 'add', 'learning', 'rate', 'into', 'the', 'depends', 'list', 'and', 'add', 'a', 'post', 'hook', 'function', 'to', 'adjust', 'the', 'value', 'of', 'learning', 'rate', 'decay', '.', 'The', 'second', 'function', 'defines', 'a', 'categori-', 'cal', 'hyper-parameter', ',', 'where', 'list', 'represents', 'the', 'candidates', '.', 'depends', ',', 'pre', 'hook', ',', 'post', 'hook', 'are', 'analogous', 'to', 'those', 'of', 'the', 'range', 'knob', '.', 'The', 'whole', 'hyper-parameter', 'tuning', 'process', 'for', 'one', 'model', 'over', 'a', 'dataset', 'is', 'called', 'a', 'study', '.', 'The', 'performance', 'of', 'the', 'trial', 'h', 'is', 'de-', 'noted', 'as', 'ph', '.', 'A', 'larger', 'ph', 'indicates', 'a', 'better', 'performance', '(', 'e.g', '.', 'ac-', 'curacy', ')', '.', 'For', 'distributed', 'hyper-parameter', 'tuning', ',', 'we', 'have', 'a', 'master', 'and', 'multiple', 'workers', 'for', 'each', 'study', '.', 'The', 'master', 'generates', 'trials', 'for', 'workers', ',', 'and', 'the', 'workers', 'evaluate', 'the', 'trials', '.', 'At', 'one', 'time', ',', 'each', 'worker', 'trains', 'the', 'model', 'with', 'a', 'given', 'trial', '.', 'The', 'workflow', 'of', 'a', 'study', 'at', 'the', 'master', 'side', 'is', 'explained', 'in', 'Algorithm', '1', '.', 'The', 'master', 'iter-', 'ates', 'over', 'an', 'event', 'loop', 'to', 'collect', 'the', 'performance', 'of', 'each', 'trial', ',', 'i.e', '.', '<', 'h', ',', 'ph', ',', 't', '>', ',', 'and', 'generates', 'the', 'next', 'trial', 'by', 'TrialAdvisor', 'that', 'im-', 'plements', 'the', 'hyper-parameter', 'search', 'algorithm', ',', 'e.g', '.', 'random', 'search', 'or', 'Bayesian', 'optimization', '.', 'It', 'stops', 'when', 'there', 'is', 'no', 'more', 'trials', 'to', 'test', 'or', 'the', 'user', 'configured', 'stop', 'criteria', 'is', 'satisfied', '(', 'e.g', '.', 'total', 'num-', 'ber', 'of', 'trials', ')', '.', 'Finally', ',', 'the', 'best', 'parameters', 'are', 'put', 'into', 'the', 'parameter', 'server', 'for', 'the', 'inference', 'service', '.', 'The', 'worker', 'side', 'keeps', 'requesting', 'trials', 'from', 'the', 'master', ',', 'conducting', 'the', 'training', 'and', 'reporting', 'the', 'results', 'to', 'the', 'master', '.', 'Algorithm', '1', 'Study', '(', 'HyperTune', 'conf', ',', 'TrialAdvisor', 'adv', ')', '1', ':', 'num', '=', '0', '2', ':', 'while', 'conf.stop', '(', 'num', ')', 'do', '3', ':', 'msg', '=', 'ReceiveMsg', '(', ')', '4', ':', 'if', 'msg.type', '==', 'kRequest', 'then', '5', ':', 'trial', '=', 'adv.next', '(', 'msg.worker', ')', '6', ':', 'if', 'trial', 'is', 'nil', 'then', '7', ':', 'break', '8', ':', 'else', '9', ':', 'send', '(', 'msg.worker', ',', 'trial', ')', '10', ':', 'end', 'if', '11', ':', 'else', 'if', 'msg.type', '==', 'kReport', 'then', '12', ':', 'adv.collect', '(', 'msg.worker', ',', 'msg.p', ',', 'msg.trial', ')', '13', ':', 'else', 'if', 'msg.type', '==', 'kFinish', 'then', '14', ':', 'num', '+=', '1', '15', ':', 'if', 'adv.is', 'best', '(', 'msg.worker', ')', 'then', '16', ':', 'send', '(', 'msg.worker', ',', 'kPut', ')', '17', ':', 'end', 'if', '18', ':', 'end', 'if', '19', ':', 'end', 'while', '20', ':', 'return', 'adv.best', 'trial', '(', ')', '4.2.2', 'Collaborative', 'Tuning', 'In', 'the', 'above', 'section', ',', 'we', 'have', 'introduced', 'our', 'distributed', 'hyper-', 'parameter', 'tuning', 'framework', '.', 'Next', ',', 'we', 'extend', 'the', 'framework', 'by', 'proposing', 'a', 'collaborative', 'tuning', 'scheme', '.', 'SGD', 'is', 'widely', 'used', 'for', 'training', 'machine', 'learning', 'models', '.', 'We', 'often', 'observe', 'that', 'the', 'training', 'loss', 'stays', 'in', 'a', 'plateau', 'after', 'a', 'while', ',', 'and', 'then', 'drops', 'suddenly', 'if', 'we', 'decrease', 'the', 'learning', 'rate', 'of', 'SGD', ',', 'e.g', '.', 'from', '0.1', 'to', '0.01', 'and', 'from', '0.01', 'to', '0.001', '[', '10', ']', '.', 'Based', 'on', 'this', 'observation', ',', 'we', 'can', 'see', 'that', 'some', 'hyper-parameters', 'should', 'be', 'changed', 'during', 'training', 'to', 'get', 'out', 'of', 'the', 'plateau', 'and', 'de-', 'rive', 'better', 'performance', '.', 'Therefore', ',', 'if', 'we', 'fix', 'the', 'model', 'architec-', 'ture', 'and', 'tune', 'the', 'hyper-parameters', 'from', 'group', '1', 'and', '3', 'in', 'Table', '1', ',', 'then', 'the', 'model', 'parameters', 'trained', 'using', 'one', 'hyper-parameter', 'trial', 'should', 'be', 'reused', 'to', 'initialize', 'the', 'same', 'model', 'with', 'another', 'trial', '.', 'By', 'selecting', 'the', 'parameters', 'from', 'the', 'top', 'performing', 'trials', 'to', 'continue', 'with', 'the', 'hyper-parameter', 'tuning', ',', 'the', 'old', 'trials', 'are', 'just', 'like', 'pre-', 'training', '[', '11', ']', '.', 'In', 'fact', ',', 'a', 'good', 'model', 'initialization', 'results', 'in', 'faster', 'convergence', 'and', 'better', 'performance', '[', '30', ']', '.', 'Users', 'typically', 'fine-tune', 'popular', 'ConvNet', 'architectures', 'over', 'their', 'own', 'datasets', '.', 'Conse-', 'quently', ',', 'this', 'collaborative', 'tuning', 'scheme', 'is', 'likely', 'to', 'converge', 'to', 'a', 'good', 'state', '.', 'It', 'is', 'not', 'straightforward', 'to', 'tune', 'hyper-parameters', 'related', 'to', 'the', 'model', 'architecture', '.', 'This', 'is', 'because', 'when', 'the', 'architecture', 'changes', ',', 'the', 'parameters', 'also', 'change', '.', 'For', 'example', ',', 'the', 'parameters', 'for', 'a', 'convolution', 'layer', 'with', 'filter', 'size', '3x3', 'can', 'not', 'be', 'used', 'to', 'initialize', '5', 'the', 'convolution', 'layer', 'of', 'another', 'ConvNet', 'whose', 'filter', 'size', 'is', '5x5', '.', 'However', ',', 'during', 'architecture', 'tuning', ',', 'there', 'are', 'many', 'architectures', 'available', '.', 'It', 'is', 'likely', 'that', 'some', 'architectures', 'share', 'the', 'same', 'config-', 'urations', 'of', 'one', 'convolution', 'layer', '.', 'For', 'instance', ',', 'if', 'ConvNet', 'a', '’', 's', '3rd', 'convolution', 'layer', 'and', 'ConvNet', 'b', '’', 's', '3rd', 'layer', 'have', 'the', 'same', 'convo-', 'lution', 'setting', ',', 'then', 'we', 'can', 'use', 'the', 'parametersW', 'from', 'ConvNet', 'a', '’', 's', '3rd', 'layer', 'to', 'initialize', 'ConvNet', 'b', '’', 's', '3rd', 'layer', '.', 'We', 'just', 'store', 'allW', 's', 'in', 'a', 'parameter', 'server', 'and', 'fetch', 'the', 'shape', 'matched', 'W', 'to', 'initialize', 'the', 'layers', 'in', 'new', 'trials', '(', 'ConvNets', ')', '.', 'If', 'the', 'performance', 'of', 'the', 'new', 'trail', 'is', 'better', 'than', 'the', 'older', 'one', ',', 'we', 'overwrite', 'the', 'W', 'in', 'the', 'parameter', 'server', 'with', 'the', 'new', 'values', '.', 'A', 'B', 'C', '𝛼', '=', '1', '𝛼', '=', '0.1', '𝛼', '=', '0.01', '𝛼', '=', '0.1', '𝛼', '=', '0.01', '𝛼', '=', '0.1', 'Figure', '5', ':', 'A', 'collaborative', 'tuning', 'example', '.', 'The', 'whole', 'process', 'is', 'illustrated', 'in', 'Figure', '5', ',', 'where', '3', 'workers', 'are', 'running', 'trials', 'to', 'tune', 'the', 'hyper-parameters', '(', 'e.g', '.', 'the', 'learning', 'rate', ')', 'of', 'the', 'same', 'model', '.', 'After', 'a', 'while', ',', 'the', 'performance', 'of', 'worker', 'A', 'stops', 'increasing', '.', 'The', 'training', 'stops', 'automatically', 'according', 'to', 'early', 'stopping', 'criteria', ',', 'e.g', 'the', 'training', 'loss', 'is', 'not', 'decreasing', 'for', '5', 'consecutive', 'epochs', '.', 'Early', 'stopping', 'is', 'widely', 'used', 'for', 'training', 'machine', 'learning', 'models7', '.', 'The', 'new', 'trial', 'on', 'worker', 'A', 'uses', 'the', 'pa-', 'rameters', 'from', 'the', 'current', 'best', 'worker', ',', 'which', 'is', 'B', '.', 'The', 'work', 'done', 'by', 'B', 'serves', 'as', 'the', 'pre-training', 'for', 'the', 'new', 'trial', 'on', 'A', '.', 'Similarly', ',', 'when', 'C', 'enters', 'the', 'plateau', ',', 'the', 'master', 'instructs', 'it', 'to', 'start', 'a', 'new', 'trial', 'on', 'C', 'using', 'the', 'parameters', 'from', 'A', ',', 'whose', 'model', 'has', 'the', 'best', 'performance', 'at', 'that', 'point', 'in', 'time', '.', 'The', 'control', 'flow', 'for', 'this', 'collaborative', 'tuning', 'scheme', 'is', 'described', 'in', 'Algorithm', '2', '.', 'It', 'is', 'similar', 'to', 'Algorithm', '1', 'except', 'that', 'the', 'master', 'instructs', 'the', 'worker', 'to', 'save', 'the', 'model', 'parameters', 'into', 'a', 'global', 'pa-', 'rameter', 'server', '(', 'Line', '9', ')', 'if', 'the', 'model', '’', 's', 'performance', 'is', 'significantly', 'larger', 'than', 'the', 'current', 'best', 'performance', '(', 'Line', '8', ')', '.', 'The', 'performance', 'difference', ',', 'i.e', '.', 'conf.delta', 'is', 'a', 'configuration', 'parameter', 'in', 'Hyper-', 'Conf', ',', 'which', 'is', 'set', 'according', 'to', 'the', 'user', '’', 's', 'expectation', 'about', 'the', 'performance', 'of', 'the', 'model', '.', 'For', 'example', ',', 'for', 'MNIST', 'image', 'classi-', 'fication', ',', 'an', 'improvement', 'of', '0.1', '%', 'is', 'very', 'large', 'as', 'the', 'current', 'best', 'performance', 'is', 'above', '99', '%', '.', 'For', 'CIFAR-10', 'image', 'classification', ',', 'we', 'may', 'set', 'the', 'delta', 'to', 'be', '0.5', '%', 'as', 'the', 'best', 'accuracy', 'is', 'about', '97.4', '%', '[', '8', ']', ',', 'which', 'means', 'that', 'there', 'is', 'a', 'bigger', 'improvement', 'space', '.', 'We', 'notice', 'that', 'bad', 'parameter', 'initialization', 'degrades', 'the', 'perfor-', 'mance', 'in', 'our', 'experiments', '.', 'This', 'is', 'very', 'serious', 'for', 'random', 'search', '.', 'Because', 'the', 'checkpoint', 'from', 'one', 'trial', 'with', 'poor', 'accuracy', 'would', 'affect', 'the', 'next', 'trials', 'as', 'the', 'model', 'parameters', 'are', 'initialized', 'into', 'a', 'poor', 'state', '.', 'To', 'resolve', 'this', 'problem', ',', 'a', 'α-greedy', 'strategy', 'is', 'intro-', 'duced', 'in', 'our', 'implementation', ',', 'which', 'initializes', 'the', 'model', 'param-', 'eters', 'either', 'by', 'random', 'initialization', 'or', 'from', 'a', 'pre-trained', 'model', 'checkpoint', 'file', '.', 'A', 'threshold', 'α', 'represents', 'the', 'probability', 'of', 'choos-', 'ing', 'random', 'initialization', 'and', '(', '1-α', ')', 'represents', 'the', 'probability', 'of', 'us-', 'ing', 'pre-trained', 'checkpoint', 'files', '.', 'α', 'decreases', 'gradually', 'to', 'decrease', 'the', 'chance', 'of', 'random', 'initialization', ',', 'i.e', '.', 'increasing', 'the', 'chance', 'of', 'CoStudy', '.', 'This', 'α-greedy', 'strategy', 'is', 'widely', 'used', 'in', 'reinforcement', 'learning', 'to', 'balance', 'the', 'exploration', 'and', 'exploitation', '.', '5', '.', 'INFERENCE', 'SERVICE', '7https', ':', '//keras.io/callbacks/', '#', 'earlystopping', 'Algorithm', '2', 'CoStudy', '(', 'HyperTune', 'conf', ',', 'TrialAdvisor', 'adv', ')', '1', ':', 'num', '=', '0', ',', 'best', 'p', '=', '0', '2', ':', 'while', 'conf.stop', '(', 'num', ')', 'do', '3', ':', 'msg', '=', 'ReceiveMsg', '(', ')', '4', ':', 'if', 'msg.type', '==', 'kRequest', 'then', '5', ':', '...', '.', '//', 'same', 'as', 'Algorithm', '1', '6', ':', 'else', 'if', 'msg.type', '==', 'kReport', 'then', '7', ':', 'adv.collect', '(', 'msg.worker', ',', 'msg.p', ',', 'msg.trial', ')', '8', ':', 'if', 'msg.p', '-', 'best', 'p', '>', 'conf.delta', 'then', '9', ':', 'send', '(', 'msg.worker', ',', 'kPut', ')', '10', ':', 'best', 'p', '=', 'msg.p', '11', ':', 'else', 'if', 'adv.early', 'stopping', '(', 'msg.worker', ',', 'conf', ')', 'then', '12', ':', 'send', '(', 'msg.worker', ',', 'kStop', ')', '13', ':', 'end', 'if', '14', ':', 'else', 'if', 'msg.type', '==', 'kFinish', 'then', '15', ':', 'num', '+=', '1', '16', ':', 'end', 'if', '17', ':', 'end', 'while', '18', ':', 'return', 'adv.best', 'trial', '(', ')', 'Inference', 'service', 'provides', 'real-time', 'request', 'serving', 'by', 'deploy-', 'ing', 'the', 'trained', 'model', '.', 'Other', 'services', ',', 'like', 'database', 'services', ',', 'sim-', 'ply', 'optimize', 'the', 'throughput', 'with', 'the', 'constraint', 'on', 'latency', ',', 'which', 'is', 'set', 'manually', 'as', 'a', 'service', 'level', 'objective', '(', 'SLO', ')', ',', 'denoted', 'as', 'τ', ',', 'e.g', '.', 'τ', '=', '0.1', 'seconds', '.', 'For', 'machine', 'learning', 'services', ',', 'accuracy', 'becomes', 'an', 'important', 'optimization', 'objective', '.', 'The', 'accuracy', 'refers', 'to', 'a', 'wide', 'range', 'of', 'performance', 'measurements', ',', 'e.g', '.', 'negative', 'error', ',', 'precision', ',', 'recall', ',', 'F1', ',', 'area', 'under', 'curve', ',', 'etc', '.', 'A', 'larger', 'value', '(', 'accuracy', ')', 'indicates', 'better', 'performance', '.', 'If', 'we', 'set', 'latency', 'as', 'a', 'hard', 'constraint', 'as', 'shown', 'in', 'Equation', '4', ',', 'overdue', 'requests', 'would', 'get', '‘', 'time', 'out', '’', 'responses', '.', 'Typically', ',', 'a', 'delayed', 'response', 'is', 'better', 'than', 'an', 'error', 'of', '‘', 'time', 'out', '’', 'for', 'the', 'end-users', '.', 'Hence', ',', 'we', 'process', 'the', 'requests', 'in', 'the', 'queue', 'se-', 'quentially', 'following', 'FIFO', '(', 'first-in-first-out', ')', '.', 'The', 'objective', 'is', 'to', 'maximize', 'the', 'accuracy', 'and', 'minimize', 'the', 'exceeding', 'time', 'accord-', 'ing', 'to', 'τ', '.', 'However', ',', 'typically', ',', 'there', 'is', 'a', 'trade-off', 'between', 'accuracy', 'and', 'latency', '.', 'For', 'example', ',', 'ensemble', 'modeling', 'with', 'more', 'models', 'increases', 'both', 'the', 'accuracy', 'and', 'the', 'latency', '.', 'We', 'shall', 'optimize', 'the', 'model', 'selection', 'for', 'ensemble', 'modeling', 'in', 'Section', '5.2', '.', 'Before', 'that', ',', 'we', 'discuss', 'a', 'simpler', 'case', 'with', 'a', 'single', 'inference', 'model', '.', 'Table', '2', 'summarizes', 'the', 'notations', 'used', 'in', 'this', 'section', '.', 'maxAccuracy', '(', 'S', ')', '(', '4', ')', 'subject', 'to', '∀s', '∈', 'S', ',', 'l', '(', 's', ')', '<', 'τ', '5.1', 'Single', 'Inference', 'Model', 'When', 'there', 'is', 'only', 'one', 'single', 'model', 'deployed', 'for', 'an', 'application', ',', 'the', 'accuracy', 'of', 'the', 'inference', 'service', 'is', 'fixed', 'from', 'the', 'system', '’', 's', 'per-', 'spective', '.', 'Therefore', ',', 'the', 'optimization', 'objective', 'is', 'reduced', 'to', 'mini-', 'mizing', 'the', 'exceeding', 'time', ',', 'which', 'is', 'formalized', 'in', 'Equation', '5.', 'min', '∑', 's∈Smax', '(', '0', ',', 'l', '(', 's', ')', '−', 'τ', ')', '|S|', '(', '5', ')', 'The', 'latency', 'l', '(', 's', ')', 'of', 'a', 'request', 'includes', 'the', 'waiting', 'time', 'in', 'the', 'queue', 'w', '(', 's', ')', ',', 'and', 'the', 'inference', 'time', 'which', 'depends', 'on', 'the', 'model', 'complexity', ',', 'hardware', 'efficiency', '(', 'i.e', '.', 'FLOPS', ')', 'and', 'the', 'batch', 'size', '.', 'The', 'batch', 'size', 'decides', 'the', 'number', 'of', 'requests', 'to', 'be', 'processed', 'to-', 'gether', '.', 'Modern', 'processing', 'units', ',', 'like', 'CPU', 'and', 'GPU', ',', 'exploit', 'data', 'parallelism', 'techniques', '(', 'e.g', '.', 'SIMD', ')', 'to', 'improve', 'the', 'throughput', 'and', 'reduce', 'the', 'computation', 'cost', '.', 'Hence', ',', 'a', 'large', 'batch', 'size', 'is', 'necessary', '6', 'Table', '2', ':', 'Notations', '.', 'Name', 'Definition', 'S', 'request', 'list', 'M', 'model', 'list', 'τ', 'latency', 'requirement', 'b', '∈', 'B', 'one', 'batch', 'size', 'from', 'a', 'candidate', 'list', 'qk', 'the', 'k−th', 'oldest', 'requests', 'in', 'the', 'queue', 'q', ':', 'k', 'is', 'the', 'oldest', 'k', 'requests', 'qk', ':', 'is', 'the', 'latest', '|Q|', '−', 'k', 'requests', 'c', '(', 'b', ')', 'inference', 'time', 'for', 'batch', 'size', 'b', 'c', '(', 'm', ',', 'b', ')', 'inference', 'time', 'for', 'model', 'm', 'and', 'batch', 'size', 'b', 'w', '(', 's', ')', 'waiting', 'time', 'for', 'a', 'request', 's', 'in', 'the', 'queue', 'l', '(', 's', ')', 'latency', '(', 'waiting', '+', 'inference', 'time', ')', 'of', 'a', 'request', 'β', 'balancing', 'factor', 'between', 'accuracy', 'and', 'latency', 'v', 'binary', 'vector', 'for', 'model', 'selection', 'R', '(', ')', 'reward', 'function', 'over', 'a', 'set', 'of', 'requests', 'to', 'saturate', 'the', 'parallelism', 'capacity', '.', 'Once', 'the', 'model', 'is', 'deployed', 'on', 'a', 'cloud', 'platform', ',', 'the', 'model', 'complexity', 'and', 'hardware', 'efficiency', 'are', 'fixed', '.', 'Therefore', ',', 'Rafiki', 'tunes', 'the', 'batch', 'size', 'to', 'optimize', 'the', 'latency', '.', 'To', 'construct', 'a', 'large', 'batch', ',', 'e.g', '.', 'with', 'b', 'requests', ',', 'we', 'have', 'to', 'delay', 'the', 'processing', 'until', 'all', 'b', 'requests', 'arrive', ',', 'which', 'may', 'incur', 'a', 'large', 'latency', 'for', 'the', 'old', 'requests', 'if', 'the', 'request', 'arrival', 'rate', 'is', 'low', '.', 'The', 'op-', 'timal', 'batch', 'size', 'is', 'thus', 'influenced', 'by', 'SLO', 'τ', ',', 'the', 'queue', 'status', '(', 'e.g', '.', 'the', 'waiting', 'time', ')', ',', 'and', 'the', 'request', 'arrival', 'rate', 'which', 'varies', 'along', 'time', '.', 'Since', 'the', 'inference', 'time', 'of', 'two', 'similar', 'batch', 'sizes', 'varies', 'lit-', 'tle', ',', 'e.g', '.', 'b=8', 'and', 'b=9', ',', 'a', 'candidate', 'batch', 'size', 'list', 'should', 'include', 'values', 'that', 'have', 'significant', 'difference', 'with', 'each', 'other', 'w.r.t', 'the', 'in-', 'ference', 'time', ',', 'e.g', '.', 'B', '=', '{', '16', ',', '32', ',', '48', ',', '64', ',', '...', '}', '.', 'The', 'largest', 'batch', 'size', 'is', 'determined', 'by', 'the', 'system', '(', 'GPU', ')', 'memory', '.', 'c', '(', 'b', ')', ',', 'the', 'latency', 'of', 'processing', 'a', 'batch', 'of', 'b', 'requests', 'b', '∈', 'B', ',', 'is', 'determined', 'by', 'the', 'hard-', 'ware', 'resource', '(', 'e.g', '.', 'GPU', 'memory', ')', ',', 'and', 'the', 'model', '’', 's', 'complexity', '.', 'Figure', '3', 'shows', 'the', 'inference', 'time', ',', 'memory', 'footprint', 'and', 'accuracy', 'of', 'popular', 'ConvNets', 'trained', 'on', 'ImageNet', '.', 'Algorithm', '3', 'shows', 'a', 'greedy', 'solution', 'for', 'this', 'problem', '.', 'It', 'al-', 'ways', 'applies', 'the', 'largest', 'batch', 'size', 'possible', '.', 'If', 'the', 'queue', 'length', '(', 'i.e', '.', 'number', 'of', 'requests', 'in', 'the', 'queue', ')', 'is', 'larger', 'than', 'the', 'largest', 'batch', 'size', 'b', '=', 'max', '(', 'B', ')', ',', 'then', 'the', 'oldest', 'b', 'requests', 'are', 'processed', 'in', 'one', 'batch', '.', 'Otherwise', ',', 'it', 'waits', 'until', 'the', 'oldest', 'request', '(', 'q0', ')', 'is', 'about', 'to', 'overdue', 'as', 'checked', 'by', 'Line', '8.', 'b', 'is', 'the', 'largest', 'batch', 'size', 'in', 'B', 'that', 'is', 'smaller', 'or', 'equal', 'to', 'the', 'queue', 'length', '(', 'Line', '8', ')', '.', 'δ', 'is', 'a', 'back-off', 'constant', ',', 'which', 'is', 'equivalent', 'to', 'reducing', 'the', 'batch', 'size', 'in', 'Additive-Increase-Multiplicative-Decrease', 'scheme', '(', 'AIMD', ')', '[', '5', ']', ',', 'e.g', '.', 'δ', '=', '0.1τ', '.', 'Algorithm', '3', 'Inference', '(', 'Queue', 'q', ',', 'Model', 'm', ')', '1', ':', 'while', 'True', 'do', '2', ':', 'b', '=', 'maxB', '3', ':', 'if', 'len', '(', 'q', ')', '>', '=', 'b', 'then', '4', ':', 'm.infer', '(', 'q0', ':', 'b', ')', '5', ':', 'deque', '(', 'q0', ':', 'b', ')', '6', ':', 'else', '7', ':', 'b', '=', 'max', '{', 'b', '∈', 'B', ',', 'b', '<', '=', 'len', '(', 'q', ')', '}', '8', ':', 'if', 'c', '(', 'b', ')', '+', 'w', '(', 'q0', ')', '+', 'δ', '>', '=', 'τ', 'then', '9', ':', 'm.infer', '(', 'q0', ':', 'b', ')', '10', ':', 'deque', '(', 'q0', ':', 'b', ')', '11', ':', 'end', 'if', '12', ':', 'end', 'if', '13', ':', 'end', 'while', '5.2', 'Multiple', 'Inference', 'Models', 'Single', 'Model', 'Two', 'Models', 'Three', 'Models', 'Four', 'Models', 'Ensemble', 'Method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'Ac', 'cu', 'ra', 'cy', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'Figure', '6', ':', 'Accuracy', 'of', 'ensemble', 'modeling', 'with', 'different', 'models', '.', 'Ensemble', 'modeling', 'is', 'an', 'effective', 'and', 'popular', 'approach', 'to', 'im-', 'prove', 'the', 'inference', 'accuracy', '.', 'To', 'give', 'an', 'example', ',', 'we', 'compare', 'the', 'performance', 'of', 'different', 'ensemble', 'of', '4', 'ConvNets', 'as', 'shown', 'in', 'Figure', '6', '.', 'Majority', 'voting', 'is', 'applied', 'to', 'aggregate', 'the', 'predictions', '.', 'The', 'accuracy', 'is', 'evaluated', 'over', 'the', 'validation', 'dataset', 'of', 'ImageNet', '.', 'Generally', 'with', 'more', 'models', ',', 'the', 'accuracy', 'is', 'better', '.', 'The', 'exception', 'is', 'that', 'the', 'ensemble', 'of', 'resnet', 'v2', '101', 'and', 'inception', 'v3', ',', 'which', 'is', 'not', 'as', 'good', 'as', 'the', 'single', 'best', 'model', ',', 'i.e', '.', 'inception', 'resnet', 'v2', '.', 'In', 'fact', ',', 'the', 'prediction', 'of', 'the', 'ensemble', 'modeling', 'is', 'the', 'same', 'as', 'incep-', 'tion', 'v3', 'because', 'when', 'there', 'is', 'a', 'tie', ',', 'the', 'prediction', 'from', 'the', 'model', 'with', 'the', 'best', 'accuracy', 'is', 'selected', 'as', 'the', 'final', 'prediction', '.', 'Parallel', 'ensemble', 'modeling', 'by', 'running', 'one', 'model', 'per', 'node', '(', 'or', 'GPU', ')', 'is', 'a', 'straight-forward', 'way', 'to', 'scale', 'the', 'system', 'and', 'improve', 'the', 'throughput', '.', 'However', ',', 'the', 'latency', 'could', 'be', 'high', 'due', 'to', 'stragglers', '.', 'For', 'example', ',', 'as', 'shown', 'in', 'Figure', '3', ',', 'the', 'node', 'running', 'nasnet', 'large', 'would', 'be', 'very', 'slow', 'although', 'its', 'accuracy', 'is', 'high', '.', 'In', 'addition', ',', 'en-', 'semble', 'modeling', 'is', 'also', 'costly', 'in', 'terms', 'of', 'throughput', 'when', 'com-', 'pared', 'with', 'serving', 'different', 'requests', 'on', 'different', 'nodes', '(', 'i.e', '.', 'no', 'ensemble', ')', '.', 'We', 'can', 'see', 'that', 'there', 'is', 'a', 'trade-off', 'between', 'latency', '(', 'throughput', ')', 'and', 'accuracy', ',', 'which', 'is', 'controlled', 'by', 'the', 'model', 'selec-', 'tion', '.', 'If', 'the', 'requests', 'arrive', 'slowly', ',', 'we', 'simply', 'run', 'all', 'models', 'for', 'each', 'batch', 'to', 'get', 'the', 'best', 'accuracy', '.', 'However', ',', 'when', 'the', 'request', 'arrival', 'rate', 'is', 'high', ',', 'like', 'in', 'Section', '5.1', ',', 'we', 'have', 'to', 'select', 'different', 'models', 'for', 'different', 'requests', 'to', 'increase', 'the', 'throughput', 'and', 'reduce', 'the', 'latency', '.', 'In', 'addition', ',', 'the', 'model', 'selection', 'for', 'the', 'current', 'batch', 'also', 'affects', 'the', 'next', 'batch', '.', 'For', 'example', ',', 'if', 'we', 'use', 'all', 'models', 'for', 'a', 'batch', ',', 'the', 'next', 'batch', 'has', 'to', 'wait', 'until', 'at', 'least', 'one', 'model', 'finishes', '.', 'To', 'solve', 'Equation', '4', ',', 'we', 'have', 'to', 'balance', 'the', 'accuracy', 'and', 'latency', 'to', 'get', 'a', 'single', 'optimization', 'objective', '.', 'We', 'move', 'the', 'latency', 'term', 'into', 'the', 'objective', 'as', 'shown', 'in', 'Equation', '6', '.', 'It', 'maximizes', 'a', 'reward', 'functionR', 'related', 'to', 'the', 'prediction', 'accuracy', 'and', 'penalizes', 'overdue', 'requests', '.', 'β', 'balances', 'the', 'accuracy', 'and', 'the', 'latency', 'in', 'the', 'objective', '.', 'If', 'the', 'ground', 'truth', 'of', 'each', 'request', 'is', 'not', 'available', 'for', 'evaluating', 'the', 'accuracy', ',', 'which', 'is', 'the', 'normal', 'case', ',', 'we', 'have', 'to', 'find', 'a', 'surrogate', 'accuracy', '.', 'maxR', '(', 'S', ')', '−', 'βR', '(', '{', 's', '∈', 'S', ',', 'l', '(', 's', ')', '>', 'τ', '}', ')', '(', '6', ')', 'Like', 'the', 'analysis', 'for', 'single', 'inference', 'model', ',', 'we', 'need', 'to', 'consider', 'the', 'batch', 'size', 'selection', 'as', 'well', '.', 'It', 'is', 'difficult', 'to', 'design', 'an', 'optimal', 'policy', 'for', 'this', 'complex', 'decision', 'making', 'problem', ',', 'which', 'decides', 'both', 'the', 'model', 'selection', 'and', 'batch', 'size', 'selection', '.', 'In', 'this', 'paper', ',', '7', 'we', 'propose', 'to', 'optimize', 'Equation', '6', 'using', 'reinforcement', 'learning', '(', 'RL', ')', '.', 'RL', 'optimizes', 'an', 'objective', 'over', 'a', 'long', 'term', 'by', 'trying', 'different', 'actions', 'and', 'entering', 'the', 'corresponding', 'states', 'to', 'collect', 'rewards', '.', 'By', 'setting', 'the', 'reward', 'as', 'Equation', '6', 'and', 'defining', 'the', 'actions', 'to', 'be', 'model', 'selection', 'and', 'batch', 'selection', ',', 'we', 'can', 'apply', 'RL', 'for', 'our', 'optimization', 'problem', '.', 'RL', 'has', 'three', 'core', 'concepts', ',', 'namely', ',', 'the', 'action', ',', 'reward', 'and', 'state', '.', 'Once', 'these', 'three', 'concepts', 'are', 'defined', ',', 'we', 'can', 'apply', 'existing', 'RL', 'al-', 'gorithms', 'to', 'do', 'optimization', '.', 'We', 'define', 'the', 'three', 'concepts', 'w.r.t', 'our', 'optimization', 'problem', 'as', 'follows', '.', 'First', ',', 'the', 'state', 'space', 'consists', 'of', ':', 'a', ')', 'the', 'queue', 'status', 'represented', 'by', 'the', 'waiting', 'time', 'of', 'each', 'request', 'in', 'the', 'queue', '.', 'The', 'waiting', 'time', 'of', 'all', 'requests', 'form', 'a', 'feature', 'vec-', 'tor', '.', 'To', 'generate', 'a', 'fixed', 'length', 'feature', 'vector', ',', 'we', 'pad', 'with', '0', 'for', 'the', 'shorter', 'queues', 'and', 'truncate', 'the', 'longer', 'queues', '.', 'b', ')', 'the', 'model', 'status', 'represented', 'by', 'a', 'vector', 'including', 'the', 'inference', 'time', 'for', 'different', 'models', 'with', 'different', 'batch', 'sizes', ',', 'i.e', '.', 'c', '(', 'm', ',', 'b', ')', ',', 'm', '∈M', ',', 'b', '∈', 'B', ',', 'and', 'the', 'left', 'time', 'to', 'finish', 'the', 'existing', 'requests', 'dispatched', 'to', 'it', '.', 'The', 'two', 'feature', 'vectors', 'are', 'concatenated', 'into', 'a', 'state', 'feature', 'vector', ',', 'which', 'is', 'the', 'input', 'to', 'the', 'RL', 'model', 'for', 'generating', 'the', 'action', '.', 'Second', ',', 'the', 'action', 'decides', 'the', 'batch', 'size', 'b', 'and', 'model', 'selection', 'represented', 'by', 'a', 'binary', 'vector', 'v', 'of', 'length', '|M', '|', '(', '1', 'for', 'selected', ';', '0', 'for', 'unselected', ')', '.', 'The', 'action', 'space', 'size', 'is', 'thus', '(', '2|M|−', '1', ')', '∗', '|B|', '.', 'We', 'exclude', 'the', 'case', 'where', 'v', '=', '0', ',', 'i.e', '.', 'none', 'of', 'the', 'models', 'are', 'selected', '.', 'Third', ',', 'following', 'Equation', '6', ',', 'the', 'reward', 'for', 'one', 'batch', 'of', 'requests', 'without', 'ground', 'truth', 'labels', 'is', 'defined', 'in', 'Equation', '7', ',', 'a', '(', 'M', '[', 'v', ']', ')', 'is', 'the', 'accuracy', 'of', 'the', 'selected', 'models', '(', 'ensemble', 'modeling', ')', '.', 'In', 'this', 'paper', ',', 'we', 'use', 'the', 'accuracy', 'evaluated', 'on', 'a', 'validation', 'dataset', 'as', 'the', 'surrogate', 'accu-', 'racy', '.', 'In', 'the', 'experiment', ',', 'we', 'use', 'the', 'ImageNet', '’', 's', 'validation', 'dataset', 'to', 'evaluate', 'the', 'accuracy', 'of', 'different', 'ensemble', 'combinations', 'for', 'im-', 'age', 'classification', '.', 'The', 'results', 'are', 'shown', 'in', 'Figure', '6', '.', 'The', 'reward', 'shown', 'in', 'Equation', '7', 'considers', 'the', 'accuracy', ',', 'the', 'latency', '(', 'indirectly', 'represented', 'by', 'the', 'number', 'of', 'overdue', 'requests', ')', 'and', 'the', 'number', 'of', 'requests', '.', 'a', '(', 'M', '[', 'v', ']', ')', '∗', '(', 'b−', 'β|', '{', 's', '∈', 'batch|l', '(', 's', ')', '>', 'τ', '}', '|', ')', '(', '7', ')', 'With', 'the', 'state', ',', 'action', 'and', 'reward', 'well', 'defined', ',', 'we', 'apply', 'the', 'actor-critic', 'algorithm', '[', '24', ']', 'to', 'optimize', 'the', 'overall', 'reward', 'by', 'learn-', 'ing', 'a', 'good', 'policy', 'for', 'selecting', 'the', 'models', 'and', 'batch', 'size', '.', '6', '.', 'SYSTEM', 'IMPLEMENTATION', 'In', 'this', 'section', ',', 'we', 'introduce', 'the', 'implementation', 'details', 'of', 'Rafiki', ',', 'including', 'the', 'cluster', 'management', ',', 'data', 'and', 'parameter', 'storage', ',', 'and', 'failure', 'recovery', '.', '6.1', 'Cluster', 'Management', 'Manager', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Train', '(', ')', 'Inference', '(', ')', 'Node', 'A', 'Node', 'CNode', 'B', 'Figure', '7', ':', 'Rafiki', 'cluster', 'topology', '.', 'Rafiki', 'uses', 'Kubernetes', 'to', 'manage', 'the', 'Docker', 'containers', ',', 'which', 'run', 'the', 'masters', ',', 'workers', ',', 'data', 'servers', 'and', 'parameter', 'servers', 'as', 'shown', 'in', 'Figure', '7', '.', 'Docker', 'container', 'is', 'widely', 'used', 'for', 'applica-', 'tion', 'deployment', ',', 'which', 'bundles', 'the', 'application', 'code', '(', 'e.g', '.', 'training', 'and', 'inference', 'code', ')', 'and', 'libraries', '(', 'e.g', '.', 'Keras', ')', 'to', 'avoid', 'tedious', 'en-', 'vironment', 'setup', '.', 'New', 'models', ',', 'hyper-parameter', 'tuning', 'algorithms', ',', 'and', 'ensemble', 'modeling', 'approaches', 'are', 'deployed', 'as', 'new', 'Docker', 'containers', '.', 'On', 'each', 'physical', 'node', ',', 'there', 'could', 'be', 'multiple', 'masters', 'and', 'workers', 'for', 'different', 'jobs', ',', 'including', 'both', 'training', 'and', 'infer-', 'ence', 'jobs', '.', 'These', 'jobs', 'are', 'started', 'by', 'the', 'Rafiki', 'manager', ',', 'which', 'accepts', 'job', 'submissions', 'from', 'users', '(', 'See', 'Figure', '2', ')', '.', 'Once', 'a', 'job', 'is', 'launched', ',', 'users', 'communicate', 'with', 'its', 'master', 'directly', 'to', 'get', 'the', 'training', 'progress', 'or', 'submit', 'query', 'requests', '.', 'Rafiki', 'prefers', 'to', 'locate', 'the', 'master', 'and', 'workers', 'for', 'the', 'same', 'job', 'in', 'the', 'same', 'physical', 'node', 'to', 'avoid', 'network', 'communication', 'overhead', '.', '6.2', 'Data', 'and', 'Parameter', 'Storage', 'Deep', 'learning', 'models', 'are', 'typically', 'trained', 'over', 'large', 'datasets', 'that', 'would', 'consume', 'a', 'lot', 'of', 'space', 'if', 'stored', 'in', 'CPU', 'memory', '.', 'There-', 'fore', ',', 'Rafiki', 'uses', 'HDFS', 'for', 'data', 'storage', ',', 'where', 'the', '‘', 'data', 'nodes', '’', 'are', 'also', 'docker', 'containers', '.', 'Users', 'upload', 'their', 'datasets', 'into', 'the', 'HDFS', 'via', 'Rafiki', 'utility', 'functions', ',', 'e.g', '.', 'rafiki.import', 'images', '(', 'see', 'Fig-', 'ure', '2', ')', '.', 'The', 'training', 'dataset', 'is', 'downloaded', 'to', 'a', 'local', 'directory', 'be-', 'fore', 'training', ',', 'via', 'rafiki.download', '(', ')', 'by', 'passing', 'the', 'dataset', 'name', '.', 'For', 'model', 'parameters', ',', 'Rafiki', 'has', 'its', 'own', 'distributed', 'parameter', 'server', '.', 'The', 'parameter', 'server', 'is', 'designed', 'with', 'special', 'optimiza-', 'tion', 'for', 'hyper-parameter', 'training', 'and', 'inference', '.', 'In', 'particular', ',', 'the', 'hyper-parameters', 'will', 'be', 'cached', 'in', 'memory', 'if', 'they', 'are', 'accessed', 'frequently', ',', 'e.g', '.', 'when', 'Rafiki', 'is', 'doing', 'hyper-parameter', 'training', '.', 'Otherwise', ',', 'they', 'are', 'stored', 'in', 'HDFS', '.', 'The', 'parameters', 'trained', 'for', 'the', 'same', 'model', 'but', 'different', 'datasets', 'can', 'be', 'shared', 'as', 'long', 'as', 'the', 'privacy', 'setting', 'is', 'public', '.', 'It', 'has', 'been', 'shown', 'that', 'training', 'warm-up', 'by', 'using', 'the', 'parameters', 'pre-trained', 'on', 'other', 'datasets', 'speeds', 'up', 'the', 'training', '[', '21', ']', '.', '6.3', 'Failure', 'Recovery', 'For', 'both', 'the', 'hyper-parameter', 'training', 'and', 'inference', 'services', ',', 'the', 'workers', 'are', 'stateless', '.', 'Hence', ',', 'Rafiki', 'manager', 'can', 'easily', 'recover', 'these', 'nodes', 'by', 'running', 'a', 'new', 'docker', 'container', 'and', 'registering', 'it', 'into', 'the', 'training', 'or', 'inference', 'master', '.', 'However', ',', 'for', 'the', 'masters', ',', 'they', 'have', 'state', 'information', '.', 'For', 'example', ',', 'the', 'master', 'for', 'the', 'training', 'ser-', 'vice', 'records', 'the', 'current', 'best', 'hyper-parameter', 'trial', '.', 'The', 'master', 'for', 'the', 'inference', 'service', 'has', 'the', 'state', ',', 'action', 'and', 'reward', 'for', 'reinforce-', 'ment', 'learning', '.', 'Rafiki', 'checkpoints', 'these', '(', 'small', ')', 'state', 'information', 'of', 'masters', 'for', 'fast', 'failure', 'recovery', '.', '7', '.', 'EXPERIMENTAL', 'STUDY', 'In', 'this', 'section', 'we', 'evaluate', 'the', 'scalability', ',', 'efficiency', 'and', 'effec-', 'tiveness', 'of', 'Rafiki', 'for', 'hyper-parameter', 'tuning', 'and', 'inference', 'ser-', 'vice', 'optimization', 'respectively', '.', 'The', 'experiments', 'are', 'conducted', 'on', 'three', 'machines', ',', 'each', 'with', '3', 'Nvidia', 'GTX', '1080Ti', 'GPUs', ',', '1', 'Intel', 'E5-1650v4', 'CPU', 'and', '64GB', 'memory', '.', '7.1', 'Evaluation', 'of', 'Hyper-parameter', 'Tuning', 'Task', 'and', 'Dataset', 'We', 'test', 'Rafiki', '’', 's', 'distributed', 'hyper-parameter', 'tuning', 'service', 'by', 'running', 'it', 'to', 'tune', 'the', 'hyper-parameters', 'of', 'deep', 'ConvNets', 'over', 'CIFAR-10', 'for', 'image', 'classification', '.', 'CIFAR-10', 'is', 'a', 'popular', 'benchmark', 'dataset', 'with', 'RGB', 'images', 'from', '10', 'categories', '.', 'Each', 'category', 'has', '5000', 'training', 'images', '(', 'including', '1000', 'validation', 'images', ')', 'and', '1000', 'test', 'images', '.', 'All', 'images', 'are', 'of', 'size', '32x32', '.', 'There', 'is', 'a', 'standard', 'sequence', 'of', 'preprocessing', 'steps', 'for', 'CIFAR-10', ',', 'which', 'subtracts', 'the', 'mean', 'and', 'divides', 'the', 'standard', 'deviation', 'from', 'each', 'channel', 'computed', 'on', 'the', 'training', 'images', ',', 'pads', 'each', 'image', 'with', '4', 'pixels', 'of', 'zeros', 'on', 'each', 'side', 'to', 'obtain', 'a', '40x40', 'pixel', 'image', ',', 'ran-', 'domly', 'crops', 'a', '32x32', 'patch', ',', 'and', 'then', 'flips', '(', 'horizontal', 'direction', ')', 'the', 'image', 'randomly', 'with', 'probability', '0.5', '.', '8', '0', '100', '200', 'Trial', 'Index', '20', '40', '60', '80', 'Va', 'lid', 'at', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', '0', '100', '200', 'Trial', 'Index', 'With', 'CoStudy', '(', 'a', ')', '25', '50', '75', 'Validation', 'Accuracy', '0', '50', '100', 'Nu', 'm', 'be', 'r', 'o', 'f', 'T', 'ria', 'ls', 'Without', 'CoStudyWith', 'CoStudy', '(', 'b', ')', '0', '100', '200', 'Total', 'Training', 'Epochs', '20', '40', '60', '80', 'Va', 'lid', 'at', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Wihtout', 'CoStudy', 'With', 'CoStudy', '(', 'c', ')', 'Figure', '8', ':', 'Hyper-parameter', 'tuning', 'based', 'on', 'random', 'search', '.', '0', '50', '100', 'Trial', 'Index', '20', '40', '60', '80', 'Va', 'lid', 'at', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', '0', '50', '100', 'Trial', 'Index', 'With', 'CoStudy', '(', 'a', ')', '25', '50', '75', 'Validation', 'Accuracy', '0', '25', '50', '75', '100', 'Nu', 'm', 'be', 'r', 'o', 'f', 'T', 'ria', 'ls', 'Without', 'CoStudyWith', 'CoStudy', '(', 'b', ')', '0', '50', '100', 'Total', 'Training', 'Epochs', '40', '60', '80', 'Va', 'lid', 'at', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', 'With', 'CoStudy', '(', 'c', ')', 'Figure', '9', ':', 'Hyper-parameter', 'tuning', 'based', 'on', 'Bayesian', 'optimization', '.', '7.1.1', 'Tuning', 'Optimization', 'Hyper-parameters', 'We', 'fix', 'the', 'ConvNet', 'architecture', 'to', 'be', 'the', 'same', 'as', 'shown', 'in', 'Table', '5', 'of', '[', '29', ']', ',', 'which', 'has', '8', 'convolution', 'layers', '.', 'The', 'hyper-parameters', 'to', 'be', 'tuned', 'are', 'from', 'the', 'optimization', 'algorithm', ',', 'including', 'momen-', 'tum', ',', 'learning', 'rate', ',', 'weight', 'decay', 'coefficients', ',', 'dropout', 'rates', ',', 'and', 'standard', 'deviations', 'of', 'the', 'Gaussian', 'distribution', 'for', 'weight', 'initial-', 'ization', '.', 'We', 'run', 'each', 'trial', 'with', 'early', 'stopping', ',', 'which', 'terminates', 'the', 'training', 'when', 'the', 'validation', 'loss', 'stops', 'decreasing', '.', 'We', 'compare', 'the', 'naı̈ve', 'distributed', 'tuning', 'algorithm', ',', 'i.e', '.', 'Study', '(', 'Algorithm', '1', ')', 'and', 'the', 'collaborative', 'tuning', 'algorithm', '.', 'i.e', '.', 'CoS-', 'tudy', '(', 'Algorithm', '2', ')', 'with', 'different', 'TrialAdvisor', 'algorithms', '.', 'Figure', '8', 'shows', 'the', 'comparison', 'using', 'random', 'search', '[', '3', ']', 'for', 'TrialAdvisor', '.', 'In', 'particular', ',', 'each', 'point', 'in', 'Figure', '8a', 'stands', 'for', 'one', 'trial', '.', 'We', 'can', 'see', 'that', 'the', 'top', 'area', 'for', 'CoStudy', 'is', 'denser', 'than', 'that', 'for', 'Study', '.', 'In', 'other', 'words', ',', 'CoStudy', 'is', 'more', 'likely', 'to', 'get', 'better', 'performance', '.', 'This', 'is', 'confirmed', 'in', 'Figure', '8b', ',', 'which', 'shows', 'that', 'CoStudy', 'has', 'more', 'trials', 'with', 'high', 'accuracy', '(', 'i.e', '.', 'accuracy', '>', '50', '%', ')', 'than', 'Study', ',', 'and', 'has', 'fewer', 'trials', 'with', 'low', 'accuracy', '(', 'i.e.', ',', 'accuracy≤50', '%', ')', '.', 'Figure', '8c', 'illustrates', 'the', 'tuning', 'progress', 'of', 'the', 'two', 'approaches', ',', 'where', 'each', 'point', 'on', 'the', 'line', 'represents', 'the', 'best', 'performance', 'among', 'all', 'trials', 'conducted', 'so', 'far', '.', 'The', 'x-axis', 'is', 'the', 'total', 'number', 'of', 'training', 'epochs8', ',', 'which', 'corre-', 'sponds', 'to', 'the', 'tuning', 'time', '(', '=total', 'number', 'of', 'epochs', 'times', 'the', 'time', 'per', 'epoch', ')', '.', 'We', 'can', 'observe', 'that', 'CoStudy', 'is', 'faster', 'than', 'Study', 'and', 'achieves', 'better', 'accuracy', 'than', 'Study', '.', 'Notice', 'that', 'the', 'validation', 'ac-', 'curacy', 'is', 'very', 'high', '(', '>', '91', '%', ')', '.', 'Therefore', ',', 'a', 'small', 'difference', '(', '1', '%', ')', 'indicates', 'significant', 'improvement', '.', 'Figure', '9', 'compares', 'Study', 'and', 'CoStudy', 'using', 'Gaussian', 'process', 'based', 'Bayesian', 'Optimization', '(', 'BO', ')', '9', 'for', 'TrialAdvisor', '.', 'Comparing', 'Figure', '9a', 'and', 'Figure', '8a', ',', 'we', 'can', 'see', 'there', 'are', 'more', 'points', 'in', 'the', 'top', 'area', 'of', 'BO', 'figures', '.', 'In', 'other', 'words', ',', 'BO', 'is', 'better', 'than', 'random', '8training', 'the', 'model', 'by', 'scanning', 'the', 'dataset', 'once', 'is', 'called', 'one', 'epoch', '.', '9https', ':', '//github.com/scikit-optimize', 'searchwhich', 'has', 'been', 'observed', 'in', 'other', 'papers', '[', '28', ']', '.', 'In', 'Figure', '9a', ',', 'CoStudy', 'has', 'a', 'few', 'more', 'points', 'in', 'the', 'right', 'bottom', 'area', 'than', 'CoS-', 'tudy', '.', 'After', 'doing', 'an', 'in-depth', 'inspection', ',', 'we', 'found', 'that', 'those', 'points', 'were', 'trials', 'initialized', 'randomly', 'instead', 'of', 'from', 'pre-trained', 'models', '.', 'For', 'Study', ',', 'it', 'always', 'uses', 'random', 'initialization', ',', 'hence', 'the', 'BO', 'algo-', 'rithm', 'has', 'a', 'fixed', 'prior', 'about', 'the', 'initialization', 'method', '.', 'However', ',', 'for', 'CoStuy', ',', 'its', 'initialization', 'is', 'from', 'pre-trained', 'models', 'for', 'most', 'time', '.', 'These', 'random', 'initialization', 'trials', 'change', 'the', 'prior', 'and', 'thus', 'get', 'biased', 'estimation', 'about', 'the', 'Gaussian', 'process', ',', 'which', 'leads', 'to', 'poor', 'accuracy', '.', 'Since', 'we', 'are', 'decaying', 'α', 'to', 'reduce', 'the', 'chance', 'of', 'random', 'initialization', ',', 'there', 'are', 'fewer', 'and', 'fewer', 'points', 'in', 'the', 'right', 'bottom', 'area', '.', 'Overall', ',', 'CoStudy', 'achieves', 'better', 'accuracy', 'as', 'shown', 'in', 'Figure', '9b', 'and', 'Figure', '9c', '.', 'We', 'study', 'the', 'scalability', 'of', 'Rafiki', 'by', 'varying', 'the', 'number', 'of', 'work-', 'ers', '.', 'Figure', '11', 'compares', 'the', '3', 'jobs', 'running', 'over', '1', ',', '2', ',', '4', 'and', '8', 'GPUs', 'respectively', '.', 'Each', 'point', 'on', 'the', 'curves', 'in', 'the', 'figure', 'represents', 'the', 'best', 'validation', 'performance', 'among', 'all', 'trials', 'that', 'have', 'been', 'tested', 'so', 'far', '.', 'The', 'x-axis', 'is', 'the', 'wall', 'clock', 'time', '.', 'We', 'can', 'see', 'that', 'with', 'more', 'GPUs', ',', 'the', 'tuning', 'becomes', 'faster', '.', 'It', 'scales', 'almost', 'linearly', '.', '7.2', 'Evaluation', 'of', 'Inference', 'Optimization', 'We', 'use', 'image', 'classification', 'as', 'the', 'application', 'to', 'test', 'the', 'opti-', 'mization', 'techniques', 'introduced', 'in', 'Section', '5', '.', 'The', 'inference', 'models', 'are', 'ConvNets', 'trained', 'over', 'the', 'ImageNet', '[', '15', ']', 'benchmark', 'dataset', '.', 'ImageNet', 'is', 'a', 'popular', 'image', 'classification', 'benchmark', 'with', 'many', 'open-source', 'ConvNets', 'trained', 'on', 'it', '(', 'Figure', '3', ')', '.', 'It', 'has', '1.2', 'million', 'RGB', 'training', 'images', 'and', '50,000', 'validation', 'images', '.', 'Our', 'environment', 'simulator', 'randomly', 'samples', 'images', 'from', 'the', 'validation', 'dataset', 'as', 'requests', '.', 'The', 'number', 'of', 'requests', 'is', 'deter-', 'mined', 'as', 'follows', '.', 'First', ',', 'to', 'simulate', 'the', 'scenario', 'with', 'very', 'high', 'arriving', 'rate', 'and', 'very', 'low', 'arriving', 'rate', ',', 'we', 'set', 'the', 'arriving', 'rate', 'based', 'on', 'the', 'maximum', 'throughput', 'ru', 'and', 'minimum', 'throughput', 'rl', '.', 'Specifically', ',', 'the', 'maximum', 'throughput', 'is', 'the', 'sum', 'of', 'all', 'models', '’', 'throughput', ',', 'which', 'is', 'achieved', 'when', 'all', 'models', 'run', 'asynchronously', '9', '0', '250', '500', '750', '1000', '1250', '1500', 'Time', '(', 'seconds', ')', '0', '100', '200', '300', '400', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'RL', 'Greedy', 'Request', 'Rate', 'Figure', '10', ':', 'Single', 'inference', 'model', 'with', 'the', 'arriving', 'rate', 'defined', 'based', 'on', 'the', 'maximum', 'throughput', '.', '1', '2', '4', '8', 'Number', 'of', 'Workers', '0', '500', '1000', '1500', 'W', 'al', 'l', 'T', 'im', 'e', '(', 'M', 'in', 'ut', 'es', ')', '(', 'a', ')', '0', '250', '500', '750', '1000', 'Wall', 'Time', '(', 'Minutes', ')', '80', '85', '90', '95', 'Va', 'lid', 'at', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', '1', 'Worker', '2', 'Workers', '4', 'Workers', '8', 'Workers', '(', 'b', ')', 'Figure', '11', ':', 'Scalability', 'test', 'of', 'distributed', 'hyper-parameter', 'tuning', '.', 'T/2T/4', 'rm', 't', '0.1T', '0.1T', 'Figure', '12', ':', 'Sine', 'function', 'for', 'controlling', 'the', 'request', 'arriving', 'rate', '.', 'to', 'process', 'different', 'batches', 'of', 'requests', '.', 'In', 'contrast', ',', 'when', 'all', 'mod-', 'els', 'run', 'synchronously', ',', 'the', 'slowest', 'model', '’', 's', 'throughput', 'is', 'just', 'the', 'minimum', 'throughput', '.', 'Second', ',', 'we', 'use', 'a', 'sine', 'function', 'and', 'the', 'extreme', 'throughput', 'values', 'to', 'define', 'the', 'request', 'arriving', 'rate', ',', 'i.e', '.', 'r', '=', 'γsin', '(', 't', ')', '+', 'b', '.', 'The', 'slope', 'γ', 'and', 'intercept', 'b', 'are', 'derived', 'by', 'solving', 'Equation', '8', 'and', '9', ',', 'where', 'T', 'is', 'the', 'cycle', 'period', 'which', 'is', 'configured', 'to', 'be', '500', '×', 'τ', 'in', 'our', 'experiments', '.', 'The', 'first', 'equation', 'is', 'to', 'make', 'sure', 'that', 'more', 'requests', 'than', 'ru', '(', 'or', 'rl', ')', 'are', 'generated', 'for', '20', '%', 'of', 'each', 'cycle', 'period', '(', 'Figure', '12', ',', 'T', '×', '20', '%', '=', '0.2T', ')', '.', 'In', 'this', 'way', ',', 'we', 'are', 'simulating', 'the', 'real-life', 'environment', 'where', 'there', 'are', 'overwhelming', 'requests', 'coming', 'at', 'times', '.', 'The', 'second', 'equa-', 'tion', 'is', 'to', 'make', 'sure', 'that', 'the', 'highest', 'arriving', 'rate', 'is', 'not', 'too', 'large', ',', 'otherwise', 'the', 'request', 'queue', 'would', 'be', 'filled', 'up', 'very', 'quickly', 'and', 'new', 'requests', 'have', 'to', 'be', 'dropped', '.', 'Finally', ',', 'a', 'small', 'random', 'noise', 'is', 'applied', 'over', 'r', 'to', 'prevent', 'the', 'RL', 'algorithm', 'from', 'remembering', 'the', 'sine', 'function', '.', 'To', 'conclude', ',', 'the', 'number', 'of', 'new', 'requests', 'is', 'δ', '×', '(', 'γsin', '(', 't', ')', '+', 'b', ')', '×', '(', '1', '+', 'φ', ')', ',', 'φ', '∼', 'N', '(', '0', ',', '0.1', ')', ')', ',', 'where', 'δ', 'is', 'the', 'time', 'span', 'between', 'the', 'last', 'invocation', 'of', 'the', 'simulator', 'and', 'the', 'current', 'time', '.', 'k', '×', 'sin', '(', 'T/2−', '0.2×', '2T/2', ')', '+', 'b', '=', 'ru', 'or', 'rl', '(', '8', ')', 'k', '×', 'sin', '(', 'T/2', ')', '+', 'b', '=', '1.1×', 'ru', 'or', 'rl', '(', '9', ')', '7.2.1', 'Single', 'Inference', 'Model', 'We', 'use', 'inception', 'v3', 'trained', 'over', 'ImageNet', 'as', 'the', 'single', 'infer-', 'ence', 'model', '.', 'Besides', 'the', 'greedy', 'algorithm', '(', 'Algorithm', '3', ')', ',', 'we', 'also', 'run', 'the', 'RL', 'algorithm', 'from', 'Section', '5.2', 'to', 'decide', 'the', 'batch', 'size', '.', 'The', 'state', 'is', 'the', 'same', 'as', 'that', 'in', 'Section', '5.2', 'except', 'that', 'the', 'model', 'related', 'status', 'is', 'removed', '.', 'The', 'batch', 'size', 'list', 'is', 'B', '=', '{', '16', ',', '32', ',', '48', ',', '64', '}', '.', 'The', 'maximum', 'throughput', 'is', 'max', 'b/c', '(', 'b', ')', '=', '64/0.23', '=', '272', 'images/second', 'and', 'the', 'minimum', 'throughput', 'is', 'min', 'b/c', '(', 'b', ')', '=', '16/0.07', '=', '228', '.', 'We', 'set', 'τ', '=', 'c', '(', '64', ')', '×', '2', '=', '0.56s', '.', 'Figure', '10', 'compares', 'the', 'RL', 'algorithm', 'and', 'the', 'greedy', 'algorithm', 'with', 'the', 'arriving', 'rate', 'defined', 'based', 'on', 'the', 'maximum', 'throughput', 'ru', '.', 'We', 'can', 'see', 'that', 'after', 'a', 'few', 'iterations', ',', 'RL', 'performs', 'similarly', 'as', 'the', 'greedy', 'algorithm', 'when', 'the', 'request', 'arriving', 'rate', 'r', 'is', 'high', '.', 'When', 'r', 'is', 'low', ',', 'RL', 'performs', 'better', 'than', 'the', 'greedy', 'algorithm', '.', 'This', 'is', 'because', 'there', 'are', 'a', 'few', 'requests', 'left', 'when', 'the', 'queue', 'length', 'does', 'not', 'equal', 'to', 'any', 'batch', 'size', 'in', 'Line', '7', 'of', 'Algorithm', '3', '.', 'These', 'left', 'requests', 'are', 'likely', 'to', 'overdue', 'because', 'the', 'new', 'requests', 'are', 'coming', 'slowly', 'to', 'form', 'a', 'new', 'batch', '.', 'Figure', '13', 'compares', 'the', 'RL', 'algorithm', 'and', 'the', 'greedy', 'algorithm', 'with', 'the', 'ar-', 'riving', 'rate', 'defined', 'based', 'on', 'the', 'minimum', 'throughput', 'rl', '.', 'We', 'can', 'see', 'that', 'RL', 'performs', 'better', 'than', 'the', 'greedy', 'algorithm', 'when', 'the', 'ar-', 'riving', 'rate', 'is', 'either', 'high', 'or', 'low', '.', 'Overall', ',', 'since', 'the', 'arriving', 'rate', 'is', 'smaller', 'than', 'that', 'in', 'Figure', '10', ',', 'there', 'are', 'fewer', 'overdue', 'requests', '.', '7.2.2', 'Multiple', 'Inference', 'Models', 'In', 'the', 'following', 'experiments', ',', 'we', 'select', 'inception', 'v3', ',', 'inception', 'v4', 'and', 'inception', 'resnet', 'v2', 'to', 'construct', 'the', 'model', 'list', 'M', '.', 'The', 'maxi-', 'mum', 'throughput', 'and', 'minimum', 'throughput', 'are', '572', 'requests/second', 'and', '128', 'requests/second', 'respectively', '.', 'The', 'experimental', 'results', 'are', 'plotted', 'in', 'Figure', '14', ',', 'Figure', '15', 'and', 'Figure', '16', '.', 'The', 'legend', 'text', '‘', 'Overdue', '’', 'represents', 'for', 'the', 'number', 'of', 'overdue', 'requests', 'per', 'sec-', 'ond', ',', 'and', '‘', 'Arriving', '’', 'stands', 'for', 'the', 'request', 'arriving', 'rate', '.', 'We', 'compare', 'our', 'RL', 'algorithm', 'with', 'two', 'baseline', 'algorithms', 're-', 'spectively', '.', 'For', 'each', 'baseline', ',', 'we', 'use', 'the', 'greedy', 'algorithm', 'to', 'find', 'the', 'batch', 'size', '.', 'They', 'differ', 'in', 'the', 'model', 'selection', 'strategy', '.', 'The', 'first', 'baseline', 'runs', 'all', 'models', 'synchronously', 'for', 'each', 'batch', 'of', 'requests', '.', 'Correspondingly', ',', 'the', 'requests', 'are', 'generated', 'using', 'the', 'rate', 'based', 'on', 'rl', '.', 'From', 'Figure', '14a', 'and', 'Figure', '14b', ',', 'we', 'can', 'see', 'that', 'the', 'greedy', 'algorithm', 'has', 'the', 'fixed', 'accuracy', ',', 'whereas', 'the', 'RL', 'algorithm', '’', 's', 'ac-', 'curacy', 'is', 'high', '(', 'resp', '.', 'low', ')', 'when', 'the', 'rate', 'is', 'low', '(', 'resp', '.', 'high', ')', '.', 'In', '10', '0', '250', '500', '750', '1000', '1250', '1500', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', '250', '300', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'RL', 'Greedy', 'Request', 'Rate', 'Figure', '13', ':', 'Single', 'inference', 'model', 'with', 'the', 'arriving', 'rate', 'defined', 'based', 'on', 'the', 'minimum', 'throughput', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'a', ')', 'Greedy', 'algorithm', '.', '23000', '23500', '24000', 'Time', '(', 'seconds', ')', '0.802', '0.804', '0.806', '0.808', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'b', ')', 'RL', 'algorithm', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'c', ')', 'Greedy', 'algorithm', '.', '23000', '23500', '24000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'd', ')', 'RL', 'algorithm', '.', 'Figure', '14', ':', 'Multiple', 'model', 'inference', 'with', 'the', 'arriving', 'rate', 'defined', 'based', 'on', 'the', 'minimum', 'throughput', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0.76', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '100', '200', '300', '400', '500', '600', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'a', ')', 'Greedy', 'algorithm', '.', '13500', '14000', '14500', 'Time', '(', 'seconds', ')', '0.76', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '100', '200', '300', '400', '500', '600', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'b', ')', 'RL', 'algorithm', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0', '200', '400', '600', '800', '1000', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'c', ')', 'Greedy', 'algorithm', '.', '13500', '14000', '14500', 'Time', '(', 'seconds', ')', '0', '200', '400', '600', '800', '1000', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'd', ')', 'RL', 'algorithm', '.', 'Figure', '15', ':', 'Multiple', 'model', 'inference', 'with', 'the', 'arriving', 'rate', 'defined', 'based', 'on', 'the', 'maximum', 'throughput', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0.800', '0.805', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'a', ')', 'β', '=', '0', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0.795', '0.800', '0.805', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', '(', 'b', ')', 'β', '=', '1', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'c', ')', 'β', '=', '0', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'on', 'd', 'Overdue', 'Arriving', '(', 'd', ')', 'β', '=', '1', '.', 'Figure', '16', ':', 'Comparison', 'of', 'the', 'effect', 'of', 'different', 'β', 'for', 'the', 'RL', 'algorithm', '.', 'fact', ',', 'the', 'synchronous', 'algorithm', 'always', 'uses', 'all', 'models', 'to', 'do', 'en-', 'semble', 'modelling', ',', 'whereas', 'the', 'RL', 'algorithm', 'uses', 'fewer', 'models', 'to', 'do', 'ensemble', 'modeling', 'when', 'the', 'arriving', 'rate', 'is', 'high', '.', 'Since', 'the', 'request', 'arriving', 'rate', 'is', 'very', 'low', ',', 'the', 'baseline', 'is', 'able', 'to', 'handle', 'al-', 'most', 'all', 'requests', '.', 'Similar', 'to', 'Figure', '13', ',', 'some', 'overdue', 'requests', 'in', 'Figure', '14c', 'are', 'due', 'to', 'the', 'mismatch', 'of', 'the', 'queue', 'size', 'and', 'the', 'batch', 'size', 'in', 'Algorithm', '3', '.', 'The', 'second', 'baseline', 'runs', 'all', 'models', 'asynchronously', ',', 'one', 'model', 'per', 'batch', 'of', 'requests', '.', 'In', 'other', 'words', ',', 'there', 'is', 'no', 'ensemble', 'mod-', 'eling', '.', 'Correspondingly', ',', 'the', 'requests', 'are', 'generated', 'using', 'the', 'rate', 'based', 'on', 'ru', '.', 'We', 'can', 'see', 'that', 'RL', 'has', 'better', 'accuracy', '(', 'Figure', '15a', 'and', '15b', ')', 'and', 'fewer', 'overdue', 'requests', '(', 'Figure', '15c', 'and', '15d', ')', 'than', 'the', '11', 'baseline', '.', 'Moreover', ',', 'it', 'is', 'adaptive', 'to', 'the', 'request', 'arriving', 'rate', '.', 'When', 'the', 'rate', 'is', 'high', ',', 'it', 'uses', 'fewer', 'models', 'to', 'serve', 'the', 'same', 'batch', 'to', 'im-', 'prove', 'the', 'throughput', 'and', 'reduce', 'the', 'overdue', 'requests', '.', 'When', 'the', 'rate', 'is', 'low', ',', 'it', 'uses', 'more', 'models', 'to', 'serve', 'the', 'same', 'batch', 'to', 'improve', 'the', 'accuracy', '.', 'We', 'also', 'compare', 'the', 'effect', 'of', 'different', 'β', ',', 'namely', 'β', '=', '0', 'and', 'β', '=', '1', 'in', 'the', 'reward', 'function', ',', 'i.e', '.', 'Equation', '7', '.', 'Figure', '16', 'shows', 'the', 'results', 'with', 'the', 'requests', 'generated', 'based', 'on', 'rl', '.', 'We', 'can', 'see', 'that', 'when', 'β', 'is', 'smaller', ',', 'the', 'accuracy', '(', 'Figure', '16a', ')', 'is', 'higher', '.', 'This', 'is', 'because', 'the', 'reward', 'function', 'focus', 'more', 'on', 'the', 'accuracy', 'part', '.', 'Con-', 'sequently', ',', 'there', 'are', 'many', 'overdue', 'requests', 'as', 'shown', 'in', 'Figure', '16c', '.', 'In', 'contrast', ',', 'when', 'β', '=', '1', ',', 'the', 'reward', 'function', 'tries', 'to', 'avoid', 'overdue', 'requests', 'by', 'reducing', 'the', 'number', 'of', 'models', 'for', 'ensemble', '.', 'There-', 'fore', ',', 'the', 'accuracy', 'and', 'the', 'number', 'of', 'overdue', 'requests', 'are', 'smaller', '(', 'Figure', '16b', 'and', 'Figure', '16d', ')', '.', '8', '.', 'CASE', 'STUDY', 'ON', 'USABILITY', 'curl', '-i', '-F=', '@', 'image.jpg', 'http', ':', '//', '<', 'ip', 'of', 'rafiki', '>', ':', '<', 'app', 'port', '>', '/api', 'CREATE', 'TABLE', 'foodlog', '(', 'user_id', 'integer', ',', 'age', 'integer', 'NOT', 'NULL', ',', 'location', 'text', 'NOT', 'NULL', ',', 'time', 'text', 'NOT', 'NULL', ',', 'image_path', 'text', 'NOT', 'NULL', ',', 'PRIMARY', 'KEY', '(', 'user_id', ',', 'time', ')', ')', ';', 'SELECT', 'UDF_FOOD_NAME', '(', 'image_path', ')', 'as', 'food_name', ',', 'count', '(', '*', ')', 'FROM', 'foodlog', 'WHERE', 'age', '>', '30', 'GROUP', 'BY', 'food_name', ';', 'Figure', '17', ':', 'SQL', 'for', 'table', 'creation', '.', 'In', 'this', 'section', ',', 'we', 'detail', 'how', 'Rafiki', 'can', 'help', 'a', 'database', 'expert', 'use', 'deep', 'learning', 'services', 'easily', 'in', 'an', 'existing', 'application', '.', 'We', 'present', 'a', 'scenario', 'for', 'analyzing', 'the', 'food', 'preference', 'of', 'users', 'of', 'a', 'food', 'logging', 'application', 'as', 'shown', 'in', 'Figure', '2', '.', 'This', 'application', 'keeps', 'a', 'log', 'for', 'the', 'food', 'that', 'the', 'user', 'eats', 'by', 'storing', 'the', 'time', ',', 'loca-', 'tion', 'and', 'photo', 'of', 'each', 'meal', '.', 'For', 'simplicity', ',', 'we', 'assume', 'that', 'all', 'data', 'is', 'stored', 'in', 'one', 'table', 'created', 'in', 'Figure', '17', '.', 'Each', 'row', 'in', 'the', 'table', 'contains', 'information', 'about', 'a', 'meal', '.', 'The', 'image', 'path', 'is', 'a', 'file', 'path', 'for', 'an', 'image', '.', 'This', 'image', 'contains', 'the', 'picture', 'of', 'the', 'food', ',', 'however', 'there', 'is', 'no', 'direct', 'way', 'to', 'query', 'the', 'information', '(', 'e.g.', ',', 'name', ')', 'of', 'the', 'food', 'image', '.', 'Using', 'Rafiki', ',', 'the', 'database', 'developer', 'collaborates', 'with', 'a', 'deep', 'learning', 'expert', 'who', 'develops', 'and', 'trains', 'an', 'image', 'recog-', 'nition', 'model', 'for', 'the', 'food', 'images', '.', 'This', 'trained', 'model', 'is', 'shared', 'in', 'Rafiki', 'and', 'provides', 'recognition', 'services', 'to', 'database', 'users', 'as', 'a', 'black', 'box', 'via', 'Web', 'APIs', '.', 'Figure', '18', 'displays', 'the', 'web', 'interface', 'of', 'Rafiki', '.', 'Figure', '18', ':', 'Rafiki', 'web', 'interface', '.', 'Deep', 'Learning', 'Expert', 'The', 'deep', 'learning', 'expert', 'prepares', 'the', 'training', '(', 'train.py', ')', 'and', 'serving', '(', 'serve.py', ')', 'scripts', 'for', 'a', 'deep', 'learning', 'model', '[', '10', ']', 'using', 'Apache', 'SINGA', '10', '.', '10http', ':', '//singa.apache.org/', 'Database', 'User', 'After', 'uploading', 'the', 'training', 'dataset', ',', 'i.e', '.', 'a', 'set', 'of', 'food', 'image', 'and', 'label', 'pairs', ',', 'into', 'the', 'Rafiki', ',', 'the', 'database', 'user', 'starts', 'the', 'training', 'job', '.', 'Once', 'the', 'training', 'is', 'finished', ',', 'the', 'user', 'deploys', 'the', 'trained', 'model', 'for', 'a', 'serving', 'job', '.', 'Afterwards', ',', 'he', 'exploits', 'the', 'deep', 'learning', 'service', 'to', 'get', 'the', 'food', 'name', 'by', 'sending', 'a', 'request', 'to', 'Rafiki', 'via', 'an', 'user-defined', 'function', '(', 'UDF', ')', '.', 'The', 'food', 'name', '(', ')', 'function', 'calls', 'the', 'Web', 'API', 'of', 'the', 'serving', 'application', 'in', 'Rafiki', '.', 'In', 'particular', ',', 'the', 'function', 'is', 'executed', 'only', 'on', 'the', 'images', 'of', 'the', 'rows', 'that', 'sat-', 'isfy', 'the', 'condition', '(', 'age', 'is', 'greater', 'than', '30', ')', '.', 'Consequently', ',', 'it', 'saves', 'much', 'time', '.', 'Batch', 'processing', 'is', 'supported', 'at', 'the', 'Rafiki', 'side', 'to', 'im-', 'prove', 'the', 'efficiency', '.', 'Furthermore', ',', 'when', 'the', 'model', 'is', 'modified', 'or', 're-trained', 'in', 'Rafiki', ',', 'there', 'is', 'no', 'change', 'to', 'the', 'SQL', 'query', 'at', 'the', 'database', 'user', '’', 's', 'side', '.', 'curl', '-i', '-F=', '@', 'image.jpg', 'http', ':', '//', '<', 'ip', 'of', 'rafiki', '>', ':', '<', 'app', 'port', '>', '/api', 'CREATE', 'TABLE', 'foodlog', '(', 'user_id', 'integer', ',', 'age', 'integer', 'NOT', 'NULL', ',', 'location', 'text', 'NOT', 'NULL', ',', 'time', 'text', 'NOT', 'NULL', ',', 'image_path', 'text', 'NOT', 'NULL', ',', 'PRIMARY', 'KEY', '(', 'user_id', ',', 'time', ')', ')', ';', 'SELECT', 'UDF_FOOD_NAME', '(', 'image_path', ')', 'as', 'food_name', ',', 'count', '(', '*', ')', 'FROM', 'foodlog', 'WHERE', 'age', '>', '30', 'GROUP', 'BY', 'food_name', ';', 'select', 'food_name', '(', 'image_path', ')', 'as', 'name', ',', 'count', '(', '*', ')', 'from', 'foodlog', 'where', 'age', '>', '52', 'group', 'by', 'name', ';', 'This', 'service', 'can', 'also', 'serve', 'requests', 'from', 'mobile', 'Apps', 'as', 'demon-', 'strated', 'in', 'Figure', '2', '.', 'We', 'have', 'created', 'a', 'food', 'logging', 'App', 'which', 'sends', 'requests', 'to', 'Rafiki', 'for', 'food', 'image', 'prediction', '.', '9', '.', 'CONCLUSIONS', 'Complex', 'analytics', 'has', 'become', 'an', 'inherent', 'and', 'expected', 'func-', 'tionality', 'to', 'be', 'supported', 'by', 'big', 'data', 'systems', '.', 'However', ',', 'it', 'is', 'widely', 'recognized', 'that', 'machine', 'learning', 'models', 'are', 'not', 'easy', 'to', 'build', 'and', 'train', ',', 'and', 'they', 'are', 'sensitive', 'to', 'data', 'distributions', 'and', 'characteris-', 'tics', '.', 'It', 'is', 'therefore', 'important', 'to', 'reduce', 'the', 'pain', 'points', 'of', 'imple-', 'menting', 'and', 'tuning', 'of', 'dataset', 'specific', 'models', ',', 'as', 'a', 'step', 'towards', 'making', 'AI', 'more', 'usable', '.', 'In', 'this', 'paper', ',', 'we', 'present', 'Rafiki', 'to', 'provide', 'the', 'training', 'and', 'inference', 'service', 'of', 'machine', 'learning', 'models', ',', 'and', 'facilitate', 'complex', 'analytics', 'on', 'top', 'of', 'cloud', 'data', 'storage', 'systems', '.', 'Rafiki', 'supports', 'effective', 'distributed', 'hyper-parameter', 'tuning', 'for', 'the', 'training', 'service', ',', 'and', 'online', 'ensemble', 'modeling', 'for', 'the', 'inference', 'service', 'that', 'is', 'amenable', 'to', 'the', 'trade', 'off', 'between', 'latency', 'and', 'accu-', 'racy', '.', 'The', 'system', 'is', 'evaluated', 'with', 'various', 'benchmarks', 'to', 'illustrate', 'its', 'efficiency', ',', 'effectiveness', 'and', 'scalability', '.', 'We', 'also', 'conducted', 'a', 'case', 'study', 'that', 'demonstrates', 'how', 'the', 'system', 'enables', 'a', 'database', 'developer', 'to', 'use', 'deep', 'learning', 'services', 'easily', '.', '10', '.', 'REFERENCES', '[', '1', ']', 'Providing', 'database', 'as', 'a', 'service', '.', 'In', 'Proceedings', 'of', 'the', '18th', 'International', 'Conference', 'on', 'Data', 'Engineering', ',', 'ICDE', '’', '02', ',', 'pages', '29–', ',', 'Washington', ',', 'DC', ',', 'USA', ',', '2002', '.', 'IEEE', 'Computer', 'Society', '.', '[', '2', ']', 'M.', 'Abadi', ',', 'P.', 'Barham', ',', 'J.', 'Chen', ',', 'Z.', 'Chen', ',', 'A.', 'Davis', ',', 'J', '.', 'Dean', ',', 'M.', 'Devin', ',', 'S.', 'Ghemawat', ',', 'G.', 'Irving', ',', 'M.', 'Isard', ',', 'M.', 'Kudlur', ',', 'J.', 'Levenberg', ',', 'R.', 'Monga', ',', 'S.', 'Moore', ',', 'D.', 'G.', 'Murray', ',', 'B.', 'Steiner', ',', 'P.', 'Tucker', ',', 'V.', 'Vasudevan', ',', 'P.', 'Warden', ',', 'M.', 'Wicke', ',', 'Y.', 'Yu', ',', 'and', 'X.', 'Zheng', '.', 'Tensorflow', ':', 'A', 'system', 'for', 'large-scale', 'machine', 'learning', '.', 'In', '12th', 'USENIX', 'Symposium', 'on', 'Operating', 'Systems', 'Design', 'and', 'Implementation', '(', 'OSDI', '16', ')', ',', 'pages', '265–283', ',', 'GA', ',', '2016', '.', 'USENIX', 'Association', '.', '[', '3', ']', 'J.', 'Bergstra', 'and', 'Y.', 'Bengio', '.', 'Random', 'search', 'for', 'hyper-parameter', 'optimization', '.', 'J.', 'Mach', '.', 'Learn', '.', 'Res.', ',', '13:281–305', ',', 'Feb.', '2012', '.', '[', '4', ']', 'R.', 'Collobert', ',', 'J.', 'Weston', ',', 'L.', 'Bottou', ',', 'M.', 'Karlen', ',', 'K.', 'Kavukcuoglu', ',', 'and', 'P.', 'P.', 'Kuksa', '.', 'Natural', 'language', 'processing', '(', 'almost', ')', 'from', 'scratch', '.', 'CoRR', ',', 'abs/1103.0398', ',', '2011', '.', '12', '[', '5', ']', 'D.', 'Crankshaw', ',', 'X.', 'Wang', ',', 'G.', 'Zhou', ',', 'M.', 'J.', 'Franklin', ',', 'J.', 'E.', 'Gonzalez', ',', 'and', 'I.', 'Stoica', '.', 'Clipper', ':', 'A', 'low-latency', 'online', 'prediction', 'serving', 'system', '.', 'In', '14th', 'USENIX', 'Symposium', 'on', 'Networked', 'Systems', 'Design', 'and', 'Implementation', '(', 'NSDI', '17', ')', ',', 'pages', '613–627', ',', 'Boston', ',', 'MA', ',', '2017', '.', 'USENIX', 'Association', '.', '[', '6', ']', 'C.', 'Curino', ',', 'E.', 'Philip', 'Charles', 'Jones', ',', 'R.', 'Popa', ',', 'N.', 'Malviya', ',', 'E.', 'Wu', ',', 'S.', 'Madden', ',', 'H.', 'Balakrishnan', ',', 'and', 'N.', 'Zeldovich', '.', 'Relational', 'cloud', ':', 'A', 'database-as-a-service', 'for', 'the', 'cloud', ',', '04', '2011', '.', '[', '7', ']', 'J.', 'Deng', ',', 'W.', 'Dong', ',', 'R.', 'Socher', ',', 'L.-J', '.', 'Li', ',', 'K.', 'Li', ',', 'and', 'L.', 'Fei-Fei', '.', 'ImageNet', ':', 'A', 'Large-Scale', 'Hierarchical', 'Image', 'Database', '.', 'In', 'CVPR09', ',', '2009', '.', '[', '8', ']', 'T.', 'Devries', 'and', 'G.', 'W.', 'Taylor', '.', 'Improved', 'regularization', 'of', 'convolutional', 'neural', 'networks', 'with', 'cutout', '.', 'CoRR', ',', 'abs/1708.04552', ',', '2017', '.', '[', '9', ']', 'D.', 'Golovin', ',', 'B.', 'Solnik', ',', 'S.', 'Moitra', ',', 'G.', 'Kochanski', ',', 'J.', 'E.', 'Karro', ',', 'and', 'D.', 'Sculley', ',', 'editors', '.', 'Google', 'Vizier', ':', 'A', 'Service', 'for', 'Black-Box', 'Optimization', ',', '2017', '.', '[', '10', ']', 'K.', 'He', ',', 'X.', 'Zhang', ',', 'S.', 'Ren', ',', 'and', 'J', '.', 'Sun', '.', 'Deep', 'residual', 'learning', 'for', 'image', 'recognition', '.', 'CoRR', ',', 'abs/1512.03385', ',', '2015', '.', '[', '11', ']', 'G.', 'E.', 'Hinton', ',', 'S.', 'Osindero', ',', 'and', 'Y.-W.', 'Teh', '.', 'A', 'fast', 'learning', 'algorithm', 'for', 'deep', 'belief', 'nets', '.', 'Neural', 'Comput.', ',', '18', '(', '7', ')', ':1527–1554', ',', 'July', '2006', '.', '[', '12', ']', 'A.', 'G.', 'Howard', ',', 'M.', 'Zhu', ',', 'B.', 'Chen', ',', 'D.', 'Kalenichenko', ',', 'W.', 'Wang', ',', 'T.', 'Weyand', ',', 'M.', 'Andreetto', ',', 'and', 'H.', 'Adam', '.', 'Mobilenets', ':', 'Efficient', 'convolutional', 'neural', 'networks', 'for', 'mobile', 'vision', 'applications', '.', 'CoRR', ',', 'abs/1704.04861', ',', '2017', '.', '[', '13', ']', 'F.', 'N.', 'Iandola', ',', 'M.', 'W.', 'Moskewicz', ',', 'K.', 'Ashraf', ',', 'S.', 'Han', ',', 'W.', 'J.', 'Dally', ',', 'and', 'K.', 'Keutzer', '.', 'Squeezenet', ':', 'Alexnet-level', 'accuracy', 'with', '50x', 'fewer', 'parameters', 'and', '<', '1mb', 'model', 'size', '.', 'CoRR', ',', 'abs/1602.07360', ',', '2016', '.', '[', '14', ']', 'D.', 'Kang', ',', 'J.', 'Emmons', ',', 'F.', 'Abuzaid', ',', 'P.', 'Bailis', ',', 'and', 'M.', 'Zaharia', '.', 'Noscope', ':', 'Optimizing', 'neural', 'network', 'queries', 'over', 'video', 'at', 'scale', '.', 'Proc', '.', 'VLDB', 'Endow.', ',', '10', '(', '11', ')', ':1586–1597', ',', 'Aug.', '2017', '.', '[', '15', ']', 'A.', 'Krizhevsky', ',', 'I.', 'Sutskever', ',', 'and', 'G.', 'E.', 'Hinton', '.', 'Imagenet', 'classification', 'with', 'deep', 'convolutional', 'neural', 'networks', '.', 'In', 'NIPS', ',', 'pages', '1106–1114', ',', '2012', '.', '[', '16', ']', 'L.', 'I.', 'Kuncheva', 'and', 'C.', 'J.', 'Whitaker', '.', 'Measures', 'of', 'diversity', 'in', 'classifier', 'ensembles', 'and', 'their', 'relationship', 'with', 'the', 'ensemble', 'accuracy', '.', 'Mach', '.', 'Learn.', ',', '51', '(', '2', ')', ':181–207', ',', 'May', '2003', '.', '[', '17', ']', 'Y.', 'LeCun', ',', 'Y.', 'Bengio', ',', 'and', 'G.', 'Hinton', '.', 'Deep', 'learning', '.', 'Nature', ',', '521', '(', '7553', ')', ':436–444', ',', '2015', '.', '[', '18', ']', 'T.', 'Li', ',', 'J.', 'Zhong', ',', 'J.', 'Liu', ',', 'W.', 'Wu', ',', 'and', 'C.', 'Zhang', '.', 'Ease.ml', ':', 'Towards', 'multi-tenant', 'resource', 'sharing', 'for', 'machine', 'learning', 'workloads', '.', 'arXiv:1708.07308', ',', '2017', '.', '[', '19', ']', 'Y.', 'Li', '.', 'Deep', 'reinforcement', 'learning', ':', 'An', 'overview', '.', 'CoRR', ',', 'abs/1701.07274', ',', '2017', '.', '[', '20', ']', 'V.', 'Mnih', ',', 'A.', 'Puigdomènech', 'Badia', ',', 'M.', 'Mirza', ',', 'A.', 'Graves', ',', 'T.', 'P.', 'Lillicrap', ',', 'T.', 'Harley', ',', 'D.', 'Silver', ',', 'and', 'K.', 'Kavukcuoglu', '.', 'Asynchronous', 'Methods', 'for', 'Deep', 'Reinforcement', 'Learning', '.', 'ArXiv', 'e-prints', ',', 'Feb.', '2016', '.', '[', '21', ']', 'A.', 'N.', 'Modi', ',', 'C.', 'Y.', 'Koo', ',', 'C.', 'Y.', 'Foo', ',', 'C.', 'Mewald', ',', 'D.', 'M.', 'Baylor', ',', 'E.', 'Breck', ',', 'H.-T.', 'Cheng', ',', 'J.', 'Wilkiewicz', ',', 'L.', 'Koc', ',', 'L.', 'Lew', ',', 'M.', 'A.', 'Zinkevich', ',', 'M.', 'Wicke', ',', 'M.', 'Ispir', ',', 'N.', 'Polyzotis', ',', 'N.', 'Fiedel', ',', 'S.', 'E.', 'Haykal', ',', 'S.', 'Whang', ',', 'S.', 'Roy', ',', 'S.', 'Ramesh', ',', 'V.', 'Jain', ',', 'X.', 'Zhang', ',', 'and', 'Z.', 'Haque', '.', 'Tfx', ':', 'A', 'tensorflow-based', 'production-scale', 'machine', 'learning', 'platform', '.', 'In', 'KDD', '2017', ',', '2017', '.', '[', '22', ']', 'B.', 'C.', 'Ooi', ',', 'K.', 'Tan', ',', 'S.', 'Wang', ',', 'W.', 'Wang', ',', 'Q.', 'Cai', ',', 'G.', 'Chen', ',', 'J.', 'Gao', ',', 'Z.', 'Luo', ',', 'A.', 'K.', 'H.', 'Tung', ',', 'Y.', 'Wang', ',', 'Z.', 'Xie', ',', 'M.', 'Zhang', ',', 'and', 'K.', 'Zheng', '.', 'SINGA', ':', 'A', 'distributed', 'deep', 'learning', 'platform', '.', 'In', 'ACM', 'Multimedia', ',', 'pages', '685–688', ',', '2015', '.', '[', '23', ']', 'C.', 'Ré', ',', 'D.', 'Agrawal', ',', 'M.', 'Balazinska', ',', 'M.', 'I.', 'Cafarella', ',', 'M.', 'I.', 'Jordan', ',', 'T.', 'Kraska', ',', 'and', 'R.', 'Ramakrishnan', '.', 'Machine', 'learning', 'and', 'databases', ':', 'The', 'sound', 'of', 'things', 'to', 'come', 'or', 'a', 'cacophony', 'of', 'hype', '?', 'In', 'SIGMOD', ',', 'pages', '283–284', ',', '2015', '.', '[', '24', ']', 'J.', 'Schulman', ',', 'F.', 'Wolski', ',', 'P.', 'Dhariwal', ',', 'A.', 'Radford', ',', 'and', 'O.', 'Klimov', '.', 'Proximal', 'policy', 'optimization', 'algorithms', '.', 'CoRR', ',', 'abs/1707.06347', ',', '2017', '.', '[', '25', ']', 'D.', 'Sculley', ',', 'G.', 'Holt', ',', 'D.', 'Golovin', ',', 'E.', 'Davydov', ',', 'T.', 'Phillips', ',', 'D.', 'Ebner', ',', 'V.', 'Chaudhary', ',', 'and', 'M.', 'Young', '.', 'Machine', 'learning', ':', 'The', 'high', 'interest', 'credit', 'card', 'of', 'technical', 'debt', '.', 'In', 'SE4ML', ':', 'Software', 'Engineering', 'for', 'Machine', 'Learning', '(', 'NIPS', '2014', 'Workshop', ')', ',', '2014', '.', '[', '26', ']', 'B.', 'Shahriari', ',', 'K.', 'Swersky', ',', 'Z.', 'Wang', ',', 'R.', 'P.', 'Adams', ',', 'and', 'N.', 'de', 'Freitas', '.', 'Taking', 'the', 'human', 'out', 'of', 'the', 'loop', ':', 'A', 'review', 'of', 'bayesian', 'optimization', '.', 'Proceedings', 'of', 'the', 'IEEE', ',', '104', '(', '1', ')', ':148–175', ',', 'Jan', '2016', '.', '[', '27', ']', 'K.', 'Simonyan', 'and', 'A.', 'Zisserman', '.', 'Very', 'deep', 'convolutional', 'networks', 'for', 'large-scale', 'image', 'recognition', '.', 'CoRR', ',', 'abs/1409.1556', ',', '2014', '.', '[', '28', ']', 'J.', 'Snoek', ',', 'H.', 'Larochelle', ',', 'and', 'R.', 'P.', 'Adams', '.', 'Practical', 'Bayesian', 'Optimization', 'of', 'Machine', 'Learning', 'Algorithms', '.', 'ArXiv', 'e-prints', ',', 'June', '2012', '.', '[', '29', ']', 'J.', 'Snoek', ',', 'O.', 'Rippel', ',', 'K.', 'Swersky', ',', 'R.', 'Kiros', ',', 'N.', 'Satish', ',', 'N.', 'Sundaram', ',', 'M.', 'M.', 'A.', 'Patwary', ',', 'Prabhat', ',', 'and', 'R.', 'P.', 'Adams', '.', 'Scalable', 'Bayesian', 'Optimization', 'Using', 'Deep', 'Neural', 'Networks', '.', 'ArXiv', 'e-prints', ',', 'Feb.', '2015', '.', '[', '30', ']', 'I.', 'Sutskever', ',', 'J.', 'Martens', ',', 'G.', 'Dahl', ',', 'and', 'G.', 'Hinton', '.', 'On', 'the', 'importance', 'of', 'initialization', 'and', 'momentum', 'in', 'deep', 'learning', '.', 'In', 'Proceedings', 'of', 'the', '30th', 'International', 'Conference', 'on', 'International', 'Conference', 'on', 'Machine', 'Learning', '-', 'Volume', '28', ',', 'ICML', '’', '13', ',', 'pages', 'III–1139–III–1147', '.', 'JMLR.org', ',', '2013', '.', '[', '31', ']', 'R.', 'S.', 'Sutton', 'and', 'A.', 'G.', 'Barto', '.', 'Introduction', 'to', 'Reinforcement', 'Learning', '.', 'MIT', 'Press', ',', 'Cambridge', ',', 'MA', ',', 'USA', ',', '1st', 'edition', ',', '1998', '.', '[', '32', ']', 'C.', 'Szegedy', ',', 'W.', 'Liu', ',', 'Y.', 'Jia', ',', 'P.', 'Sermanet', ',', 'S.', 'Reed', ',', 'D.', 'Anguelov', ',', 'D.', 'Erhan', ',', 'V.', 'Vanhoucke', ',', 'and', 'A.', 'Rabinovich', '.', 'Going', 'deeper', 'with', 'convolutions', '.', 'CoRR', ',', 'abs/1409.4842', ',', '2014', '.', '[', '33', ']', 'W.', 'Wang', ',', 'G.', 'Chen', ',', 'H.', 'Chen', ',', 'T.', 'T.', 'A.', 'Dinh', ',', 'J.', 'Gao', ',', 'B.', 'C.', 'Ooi', ',', 'K.-L.', 'Tan', ',', 'and', 'S.', 'Wang', '.', 'Deep', 'learning', 'at', 'scale', 'and', 'at', 'ease', '.', 'Transactions', 'on', 'Multimedia', 'Computing', 'Communications', 'and', 'Applications', ',', '12', '(', '4s', ')', ',', '2016', '.', '[', '34', ']', 'W.', 'Wang', ',', 'G.', 'Chen', ',', 'T.', 'T.', 'A.', 'Dinh', ',', 'J.', 'Gao', ',', 'B.', 'C.', 'Ooi', ',', 'K.', 'Tan', ',', 'and', 'S.', 'Wang', '.', 'SINGA', ':', 'putting', 'deep', 'learning', 'in', 'the', 'hands', 'of', 'multimedia', 'users', '.', 'In', 'ACM', 'Multimedia', ',', 'pages', '25–34', ',', '2015', '.', '[', '35', ']', 'W.', 'Wang', ',', 'X.', 'Yang', ',', 'B.', 'C.', 'Ooi', ',', 'D.', 'Zhang', ',', 'and', 'Y.', 'Zhuang', '.', 'Effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', '.', 'The', 'VLDB', 'Journal', ',', 'pages', '1–23', ',', '2015', '.', '[', '36', ']', 'W.', 'Wang', ',', 'M.', 'Zhang', ',', 'G.', 'Chen', ',', 'H.', 'Jagadish', ',', 'B.', 'C.', 'Ooi', ',', 'and', 'K.-L.', 'Tan', '.', 'Database', 'meets', 'deep', 'learning', ':', 'Challenges', 'and', 'opportunities', '.', 'ACM', 'SIGMOD', 'Record', ',', '45', '(', '2', ')', ':17–22', ',', '2016', '.', '[', '37', ']', 'H.', 'Zhang', ',', 'L.', 'Zeng', ',', 'W.', 'Wu', ',', 'and', 'C.', 'Zhang', '.', 'How', 'good', 'are', 'machine', 'learning', 'clouds', 'for', 'binary', 'classification', 'with', 'good', 'features', '?', 'CoRR', ',', 'abs/1707.09562', ',', '2017', '.', '[', '38', ']', 'B.', 'Zoph', 'and', 'Q.', 'V.', 'Le', '.', 'Neural', 'architecture', 'search', 'with', 'reinforcement', 'learning', '.', 'CoRR', ',', 'abs/1611.01578', ',', '2016', '.', '13']
['Rafiki', ':', 'Machine', 'Learning', 'Analytics', 'Service', 'System', 'Wei', 'Wang†', ',', 'Sheng', 'Wang†', ',', 'Jinyang', 'Gao†', ',', 'Meihui', 'Zhang�', 'Gang', 'Chen‡', ',', 'Teck', 'Khim', 'Ng†', ',', 'Beng', 'Chin', 'Ooi†', '†National', 'University', 'Singapore', '�Beijing', 'Institute', 'Technology', '‡Zhejiang', 'University', '†', '{', 'wangwei', ',', 'jinyang.gao', ',', 'wangsh', ',', 'ngtk', ',', 'ooibc', '}', '@', 'comp.nus.edu.sg', '�meihui', 'zhang', '@', 'bit.edu.cn', ',', '‡', 'cg', '@', 'zju.edu.cn', 'ABSTRACT', 'Big', 'data', 'analytics', 'gaining', 'massive', 'momentum', 'last', 'years', '.', 'Applying', 'machine', 'learning', 'models', 'big', 'data', 'become', 'implicit', 'requirement', 'expectation', 'analysis', 'tasks', ',', 'especially', 'high-stakes', 'applications.Typical', 'applications', 'include', 'sentiment', 'analysis', 'reviews', 'analyzing', 'on-line', 'products', ',', 'image', 'classification', 'food', 'logging', 'applications', 'monitoring', 'user', '’', 'daily', 'intake', 'stock', 'movement', 'prediction', '.', 'Extending', 'tra-', 'ditional', 'database', 'systems', 'support', 'analysis', 'intriguing', 'challenging', '.', 'First', ',', 'almost', 'impossible', 'implement', 'ma-', 'chine', 'learning', 'models', 'database', 'engines', '.', 'Second', ',', 'expertise', 'knowledge', 'required', 'optimize', 'training', 'inference', 'proce-', 'dures', 'terms', 'efficiency', 'effectiveness', ',', 'imposes', 'heavy', 'burden', 'system', 'users', '.', 'In', 'paper', ',', 'develop', 'present', 'system', ',', 'called', 'Rafiki', ',', 'provide', 'training', 'inference', 'ser-', 'vice', 'machine', 'learning', 'models', ',', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', '.', 'Rafiki', 'provides', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', ',', 'online', 'ensem-', 'ble', 'modeling', 'inference', 'service', 'trades', 'latency', 'accuracy', '.', 'Experimental', 'results', 'confirm', 'efficiency', ',', 'effectiveness', ',', 'scalability', 'usability', 'Rafiki', '.', '1', '.', 'INTRODUCTION', 'Data', 'analysis', 'plays', 'important', 'role', 'extracting', 'valuable', 'in-', 'sights', 'huge', 'amount', 'data', '.', 'Database', 'systems', 'traditionally', 'used', 'storing', 'analyzing', 'structured', 'data', ',', 'spatial-', 'temporal', 'data', ',', 'graph', 'data', ',', 'etc', '.', 'Other', 'data', ',', 'multimedia', 'data', '(', 'e.g.', ',', 'images', 'free', 'text', ')', ',', 'domain', 'specific', 'data', '(', 'e.g', ',', 'medical', 'data', 'sensor', 'data', ')', ',', 'generated', 'fast', 'speed', 'con-', 'stitutes', 'significant', 'portion', 'Big', 'Data', '[', '35', ']', '.', 'It', 'beneficial', 'analyze', 'data', 'database', 'applications', '[', '36', ']', '.', 'For', 'instance', ',', 'inferring', 'quality', 'product', 'review', 'column', 'sales', 'database', 'would', 'help', 'explain', 'sales', 'numbers', ';', 'Analyz-', 'ing', 'food', 'images', 'food', 'logging', 'application', 'extract', 'food', 'preference', 'people', 'different', 'ages', '.', 'However', ',', 'analysis', 'requires', 'machine', 'learning', 'models', ',', 'especially', 'deep', 'learn-', 'ing', '[', '17', ']', 'models', ',', 'sentiment', 'analysis', '[', '4', ']', 'classify', 'review', 'positive', 'negative', ',', 'image', 'classification', '[', '15', ']', 'recognize', 'food', 'type', 'images', '.', 'Figure', '1', 'shows', 'pipeline', 'data', 'analysis', ',', 'database', 'systems', 'widely', 'used', 'first', '3', 'stages', 'machine', 'learning', 'good', '4th', 'stage', '.', 'Big', 'Data', '大数据', '•', '3Vs', ':', 'Volume', ',', 'Velocity', 'Variety', '高容量，速度快，多样性', '–', 'Variety', 'implies', 'integrating', 'analyzing', 'data', '–', 'It', 'necessary', 'develop', 'end-to-end', 'solutions', 'scale', ',', 'easy', 'use', ',', 'minimize', 'human', 'effort', 'Acquisition', 'Extraction/', 'Cleaning/', 'Annotation', 'Integration', 'Analysis/', 'Modeling', 'Interpretation/', 'Visualization', 'Figure', '1', ':', 'Data', 'analytic', 'pipeline', '.', 'One', 'approach', 'integrating', 'machine', 'learning', 'techniques', 'database', 'applications', 'preprocess', 'data', 'off-line', 'add', 'prediction', 'results', 'new', 'column', ',', 'e.g', '.', 'column', 'food', 'type', '.', 'However', ',', 'off-line', 'preprocessing', 'two-folds', 'restric-', 'tion', '.', 'First', ',', 'requires', 'developers', 'expertise', 'knowledge', 'experience', 'training', 'machine', 'learning', 'models', '.', 'Second', ',', 'queries', 'involve', 'attributes', 'object', ',', 'e.g', '.', 'ingredients', 'food', ',', 'predicted', 'preprocessing', 'step', '.', 'In', 'addi-', 'tion', ',', 'would', 'waste', 'lot', 'time', 'prediction', 'rows', 'queries', 'read', 'food', 'type', 'column', 'rows', ',', 'e.g', '.', 'due', 'filtering', 'columns', '.', 'Another', 'approach', 'carry', 'pre-', 'diction', 'on-line', 'user-defined', 'functions', '(', 'UDFs', ')', 'SQL', 'query', '.', 'However', ',', 'challenging', 'implement', 'machine', 'learning', 'mod-', 'els', 'UDFs', 'database', 'users', '[', '23', ']', ',', 'machine', 'learning', 'models', 'vary', 'lot', 'terms', 'theory', 'implementation', '.', 'It', 'also', 'difficult', 'optimize', 'prediction', 'accuracy', 'database', 'engine', '.', 'A', 'better', 'solution', 'call', 'corresponding', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', '.', 'APIs', ',', 'UDFs', 'prediction', '(', 'analysis', ')', 'task', '.', 'Cloud', 'service', 'economical', ',', 'elastic', 'easy', 'use', '.', 'With', 'resurgence', 'AI', ',', 'cloud', 'providers', 'like', 'Amazon', '(', 'AWS', ')', ',', 'Google', 'Microsoft', '(', 'Azure', ')', 'built', 'machine', 'learning', 'services', 'cloud', 'platforms', '.', 'There', 'two', 'types', 'cloud', 'services', '.', 'The', 'first', 'one', 'provide', 'API', 'specific', 'task', ',', 'e.g', '.', 'image', 'classifi-', 'cation', 'sentiment', 'analysis', '.', 'Such', 'APIs', 'available', 'Amazon', 'AWS1', 'Google', 'cloud', 'platform2', '.', 'The', 'disadvantage', 'accuracy', 'could', 'low', 'since', 'models', 'trained', 'Amazon', 'Google', 'data', ',', 'likely', 'different', 'users', '’', 'data', '.', 'The', 'second', 'type', 'service', 'overcomes', 'issue', 'providing', 'training', 'service', ',', 'users', 'upload', 'datasets', 'conduct', 'training', '.', 'This', 'service', 'available', 'Amazon', 'AWS', 'Microsoft', 'Azure', '.', 'However', ',', 'limited', 'number', 'ma-', 'chine', 'learning', 'models', 'supported', '[', '37', ']', '.', 'For', 'example', ',', 'sim-', '1https', ':', '//aws.amazon.com/machine-learning/', '2https', ':', '//cloud.google.com/products/machine-learning/', '1', 'ple', 'logistic', 'regression', 'linear', 'regression', 'models3', 'supported', 'Amazon', '.', 'Deep', 'learning', 'models', 'convolutional', 'neural', 'networks', '(', 'ConvNets', ')', 'recurrent', 'neural', 'networks', '(', 'RNN', ')', 'included', '.', 'As', 'machine', 'learning', 'cloud', 'service', ',', 'needs', 'cover', 'wide', 'range', 'models', ',', 'including', 'deep', 'learning', 'models', ',', 'also', 'provide', 'easy-to-use', ',', 'efficient', 'effective', 'service', 'users', 'with-', 'much', 'machine', 'learning', 'knowledge', 'experience', ',', 'e.g', '.', 'database', 'users', '.', 'Considering', 'different', 'models', 'may', 'result', 'different', 'performance', 'terms', 'efficiency', '(', 'e.g', '.', 'latency', ')', 'effectiveness', '(', 'e.g', '.', 'accuracy', ')', ',', 'cloud', 'service', 'select', 'proper', 'models', 'given', 'task', '.', 'Moreover', ',', 'machine', 'learning', 'models', 'training', 'algorithms', 'come', 'set', 'hyper-parameters', 'knobs', ',', 'e.g', '.', 'number', 'layers', 'size', 'layer', 'neural', 'network', '.', 'Some', 'hyper-parameters', 'vital', 'convergence', 'training', 'algorithm', 'final', 'model', 'performance', ',', 'e.g', '.', 'learning', 'rate', 'stochastic', 'gradient', 'descent', '(', 'SGD', ')', 'algorithm', '.', 'Manual', 'hyper-', 'parameter', 'tuning', 'requires', 'rich', 'experience', 'tedious', '.', 'Random', 'search', 'Bayesian', 'optimization', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approaches', '.', 'However', ',', 'costly', 'train', 'model', 'till', 'convergence', ',', 'may', 'take', 'hundreds', 'hours', '.', 'A', 'dis-', 'tributed', 'tuning', 'platform', 'desirable', '.', 'Besides', 'training', ',', 'inference4', 'also', 'matters', 'directly', 'affects', 'user', 'experience', '.', 'Machine', 'learning', 'products', 'often', 'ensemble', 'multiple', 'models', 'average', 'results', 'boost', 'prediction', 'performance', '.', 'However', ',', 'ensemble', 'modeling', 'incurs', 'larger', 'latency', '(', 'i.e', '.', 'response', 'time', ')', 'compared', 'using', 'single', 'prediction', 'model', '.', 'Therefore', ',', 'trade-off', 'be-', 'tween', 'accuracy', 'latency', '.', 'There', 'studies', 'challenges', 'providing', 'ma-', 'chine', 'learning', 'service', '.', 'mlbench', '[', '37', ']', 'compares', 'cloud', 'ser-', 'vice', 'Amazon', 'Azure', 'set', 'binary', 'classification', 'tasks', '.', 'Ease.ml', '[', '18', ']', 'builds', 'training', 'platform', 'model', 'selection', 'aim-', 'ing', 'optimizing', 'resource', 'utilization', '.', 'Google', 'Vizier', '[', '9', ']', 'distributed', 'hyper-parameter', 'tuning', 'platform', 'provides', 'tuning', 'service', 'systems', '.', 'Clipper', '[', '5', ']', 'focuses', 'inference', 'proposing', 'general', 'framework', 'specific', 'optimization', 'effi-', 'ciency', 'accuracy', '.', 'In', 'paper', ',', 'present', 'system', ',', 'called', 'Rafiki', ',', 'provide', 'training', 'inference', 'services', 'machine', 'learning', 'mod-', 'els', '.', 'With', 'Rafiki', ',', '(', 'database', ')', 'users', 'exempted', 'managing', 'hardware', 'resource', ',', 'constructing', '(', 'deep', 'learning', ')', 'models', ',', 'tun-', 'ing', 'hyper-parameters', ',', 'optimizing', 'prediction', 'accuracy', 'speed', '.', 'Instead', ',', 'simply', 'upload', 'datasets', 'configure', 'service', 'conduct', 'training', 'deploy', 'model', 'infer-', 'ence', '.', 'As', 'cloud', 'service', 'system', '[', '1', ',', '6', ']', ',', 'Rafiki', 'manages', 'hard-', 'ware', 'resources', ',', 'failure', 'recovery', ',', 'etc', '.', 'It', 'comes', 'set', 'built-in', '(', 'deep', 'learning', ')', 'models', 'popular', 'tasks', 'image', 'text', 'processing', '.', 'In', 'addition', ',', 'make', 'following', 'contributions', 'make', 'Rafiki', 'easy-to-use', ',', 'efficient', 'effective', '.', '1', '.', 'We', 'propose', 'unified', 'system', 'architecture', 'train-', 'ing', 'inference', 'services', '.', 'We', 'observe', 'two', 'ser-', 'vices', 'share', 'common', 'components', 'parameter', 'server', 'model', 'parameter', 'storage', ',', 'distributed', 'comput-', 'ing', 'environment', 'distributed', 'hyper-parameter', 'tuning', 'parallel', 'inference', '.', 'By', 'sharing', 'underlying', 'storage', ',', 'communication', 'protocols', 'computation', 'resource', ',', 'im-', 'plicitly', 'avoid', 'technical', 'debts', '[', '25', ']', '.', 'Moreover', ',', 'com-', '3https', ':', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4We', 'use', 'term', 'deployment', ',', 'inference', 'serving', 'interchange-', 'ably', '.', 'bining', 'two', 'services', 'together', ',', 'Rafiki', 'enables', 'instant', 'model', 'deployment', 'training', '.', '2', '.', 'For', 'training', 'service', ',', 'first', 'propose', 'general', 'frame-', 'work', 'distributed', 'hyper-parameter', 'tuning', ',', 'ex-', 'tensible', 'popular', 'hyper-parameter', 'tuning', 'algorithms', 'in-', 'cluding', 'random', 'search', 'Bayesian', 'optimization', '.', 'In', 'addi-', 'tion', ',', 'propose', 'collaborative', 'tuning', 'scheme', 'specifically', 'deep', 'learning', 'models', ',', 'uses', 'model', 'parameters', 'current', 'top', 'performing', 'training', 'trials', 'initialize', 'new', 'trials', '.', '3', '.', 'For', 'inference', 'service', ',', 'propose', 'scheduling', 'algorithm', 'based', 'reinforcement', 'learning', 'optimize', 'overall', 'ac-', 'curacy', 'reduce', 'latency', '.', 'Both', 'algorithms', 'adaptive', 'changes', 'request', 'arrival', 'rate', '.', '4', '.', 'We', 'conduct', 'micro-benchmark', 'experiments', 'evaluate', 'performance', 'proposed', 'algorithms', '.', 'In', 'reminder', 'paper', ',', 'give', 'system', 'architecture', 'Section', '3', '.', 'Section', '4', 'describes', 'training', 'service', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'algorithm', '.', 'The', 'deployment', 'ser-', 'vice', 'optimization', 'techniques', 'introduced', 'Section', '5', '.', 'Sec-', 'tion', '6', 'describes', 'system', 'implementation', '.', 'We', 'explain', 'ex-', 'perimental', 'study', 'Section', '7', 'introduce', 'related', 'works', 'Section', '2', '.', '2', '.', 'RELATED', 'WORK', 'Rafiki', 'SaaS', 'provides', 'analytics', 'services', 'based', 'ma-', 'chine', 'learning', '.', 'Optimization', 'techniques', 'proposed', 'training', '(', 'i.e', '.', 'distributed', 'hyper-parameter', 'tuning', ')', 'inference', 'stage', '(', 'i.e', '.', 'accuracy', 'latency', 'optimization', ')', '.', 'In', 'section', ',', 'review', 'related', 'work', 'SaaS', ',', 'hyper-parameter', 'tuning', ',', 'inference', 'op-', 'timization', ',', 'reinforcement', 'learning', 'adopted', 'Rafiki', 'inference', 'optimization', '.', '2.1', 'Software', 'Service', 'Cloud', 'computing', 'changed', 'way', 'IT', 'operation', 'many', 'companies', 'providing', 'infrastructure', 'service', '(', 'IaaS', ')', ',', 'platform', 'service', '(', 'PaaS', ')', 'software', 'service', '(', 'SaaS', ')', '.', 'With', 'IaaS', ',', 'users', 'companies', 'use', 'remote', 'physical', 'virtual', 'machines', 'instead', 'establishing', 'data', 'center', '.', 'Based', 'user', 'require-', 'ments', ',', 'IaaS', 'scale', 'compute', 'resources', 'quickly', '.', 'PaaS', ',', 'e.g.', ',', 'Microsoft', 'Azure', ',', 'provides', 'development', 'toolkit', 'running', 'envi-', 'ronment', ',', 'adjusted', 'automatically', 'based', 'business', 'demand', '.', 'SaaS', ',', 'including', 'database', 'service', '[', '1', ',', '6', ']', ',', 'installs', 'soft-', 'ware', 'cloud', 'computing', 'platforms', 'provides', 'application', 'ser-', 'vices', ',', 'simplifies', 'software', 'maintenance', '.', 'The', '‘', 'pay', 'go', '’', 'pricing', 'model', 'convenient', 'economic', '(', 'small', ')', 'companies', 'research', 'labs', '.', 'Recently', ',', 'machine', 'learning', '(', 'especially', 'deep', 'learning', ')', 'gain', 'lot', 'interest', 'due', 'outstanding', 'performance', 'analytic', 'predictive', 'tasks', '.', 'There', 'two', 'primary', 'steps', 'apply', 'machine', 'learning', 'application', ',', 'namely', 'training', 'inference', '.', 'Cloud', 'providers', ',', 'like', 'Amazon', 'AWS', ',', 'Microsoft', 'Azure', 'Google', 'Cloud', ',', 'already', 'included', 'services', 'two', 'steps', '.', 'However', ',', 'training', 'services', 'limited', 'support', 'deep', 'learning', 'mod-', 'els', ',', 'inference', 'services', 'customized', 'customers', '’', 'data', '(', 'see', 'explanation', 'Section', '1', ')', '.', 'There', 'also', 'research', 'papers', 'towards', 'efficient', 'resource', 'allocation', 'training', '[', '18', ']', 'efficient', 'inference', '[', '5', ']', 'cloud', '.', 'Rafiki', 'differs', 'exist-', 'ing', 'cloud', 'services', 'service', 'types', 'optimization', 'techniques', '.', 'Firstly', ',', 'Rafiki', 'allows', 'users', 'train', 'machine', 'learning', '2', '(', 'including', 'deep', 'learning', ')', 'models', 'data', ',', 'de-', 'ploy', 'inference', '.', 'Secondly', ',', 'Rafiki', 'special', 'optimization', 'training', 'inference', 'service', ',', 'compared', 'existing', 'approaches', 'explained', 'following', 'two', 'subsections', '.', '2.2', 'Hyper-parameter', 'Tuning', 'To', 'train', 'machine', 'learning', 'model', 'application', ',', 'need', 'decide', 'many', 'hyper-parameters', 'related', 'model', 'structure', ',', 'opti-', 'mization', 'algorithm', 'data', 'preprocessing', 'operations', '.', 'All', 'hyper-', 'parameter', 'tuning', 'algorithms', 'work', 'empirical', 'trials', '.', 'Random', 'search', '[', '3', ']', 'randomly', 'selects', 'value', 'hyper-parameter', 'try', '.', 'It', 'shown', 'efficient', 'grid', 'search', 'enumerates', 'possible', 'hyper-parameter', 'combinations', '.', 'Bayesian', 'optimization', '[', '28', ']', 'assumes', 'optimization', 'function', '(', 'hyper-parameters', 'input', 'inference', 'performance', 'output', ')', 'follows', 'Gaussian', 'process', '.', 'It', 'samples', 'next', 'point', 'hyper-parameter', 'space', 'based', 'existing', 'trials', '(', 'according', 'acquisition', 'function', ')', '.', 'Reinforcement', 'learning', 'recently', 'applied', 'tune', 'archi-', 'tecture', 'related', 'hyper-parameters', '[', '38', ']', '.', 'Google', 'Vizier', '[', '9', ']', 'provides', 'hyper-parameter', 'tuning', 'service', 'cloud', '.', 'Rafiki', 'provides', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'service', ',', 'compatible', 'mentioned', 'hyper-parameter', 'tuning', 'algorithms', '.', 'In', 'ad-', 'dition', ',', 'supports', 'collaborative', 'tuning', 'shares', 'model', 'parame-', 'ters', 'across', 'trials', '.', 'Our', 'experiments', 'confirm', 'effectiveness', 'collaborative', 'tuning', 'scheme', '.', '2.3', 'Inference', 'Optimization', 'To', 'improve', 'inference', 'accuracy', ',', 'ensemble', 'modeling', 'trains', 'deploys', 'multiple', 'models', 'widely', 'applied', '.', 'For', 'real-time', 'in-', 'ference', ',', 'latency', 'another', 'critical', 'metric', 'inference', 'service', '.', 'NoScope', '[', '14', ']', 'proposes', 'specific', 'inference', 'optimization', 'video', 'querying', '.', 'Clipper', '[', '5', ']', 'studies', 'multiple', 'optimization', 'techniques', 'improve', 'throughput', '(', 'via', 'batch', 'size', ')', 'reduce', 'latency', '(', 'via', 'caching', ')', '.', 'It', 'also', 'proposes', 'model', 'selection', 'ensemble', 'mod-', 'eling', 'using', 'multi-armed', 'bandit', 'algorithms', '.', 'Compared', 'Clip-', 'per', ',', 'Rafiki', 'provides', 'training', 'inference', 'services', ',', 'whereas', 'Clipper', 'focuses', 'inference', 'service', '.', 'Also', ',', 'Clipper', 'op-', 'timizes', 'throughput', ',', 'latency', 'accuracy', 'separately', ',', 'whereas', 'Rafiki', 'models', 'together', 'find', 'optimal', 'model', 'selection', 'batch', 'size', '.', 'TensorFlow', 'serving', '[', '2', ']', 'TFX', '[', '21', ']', 'provide', 'inference', 'service', 'models', 'trained', 'using', 'Tensorflow', '.', 'Rafiki', 'Clipper', 'implementation', 'agnostic', '.', 'They', 'communicate', 'training', 'inference', 'programs', 'Docker', 'containers', 'via', 'RPC', '.', '2.4', 'Reinforcement', 'Learning', 'In', 'reinforcement', 'learning', '(', 'RL', ')', '[', '31', ']', ',', 'time', 'agent', 'takes', 'one', 'action', ',', 'enters', 'next', 'state', '.', 'The', 'environment', 'returns', 'reward', 'based', 'action', 'states', '.', 'The', 'learning', 'objective', 'maximize', 'aggregated', 'rewards', '.', 'RL', 'algorithms', 'decide', 'ac-', 'tion', 'take', 'based', 'current', 'state', 'experience', 'gained', 'previous', 'trials', '(', 'exploration', ')', '.', 'Policy', 'gradient', 'based', 'RL', 'algorithms', 'maximize', 'expected', 'reward', 'taking', 'actions', 'following', 'policy', 'function', 'πθ', '(', 'at|st', ')', 'n', 'steps', '(', 'Equation', '1', ')', ',', 'ς', 'represents', 'trajectory', 'n', '(', 'action', ',', 'state', 'st', ',', 'reward', 'Rt', ')', 'tuples', ',', 'γ', 'decaying', 'factor', '.', 'The', 'expectation', 'taken', 'possible', 'trajec-', 'tories', '.', 'πθ', 'usually', 'implemented', 'using', 'multi-layer', 'perceptron', 'model', '(', 'θ', 'represents', 'parameters', ')', 'takes', 'state', 'vector', 'input', 'generates', 'action', '(', 'scalar', 'value', 'continuous', 'action', 'Softmax', 'output', 'discrete', 'actions', ')', '.', 'Equation', '1', 'optimized', 'using', 'stochastic', 'gradient', 'ascent', 'methods', '.', 'Equation', '3', 'used', '‘', 'surrogate', '’', 'function', 'objective', 'gradient', 'easy', 'com-', 'pute', 'via', 'automatic', 'differentiation', '.', 'J', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'n∑', 't=0', 'γtRt', ']', ',', '(', '1', ')', 'OθJ', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'n∑', 't=0', 'Oθ', 'log', 'πθ', '(', 'at|st', ')', 'T∑', 't=0', 'γtRt', ']', '(', '2', ')', 'Ĵ', '(', 'θ', ')', '=', 'Eς∼πθ', '(', 'ς', ')', '[', 'T∑', 't=0', 'log', 'πθ', '(', 'at|st', ')', 'n∑', 't=0', 'γtRt', ']', '(', '3', ')', 'Many', 'approaches', 'proposed', 'improve', 'policy', 'gra-', 'dient', 'reducing', 'variance', 'rewards', ',', 'including', 'actor-critic', 'model', '[', '20', ']', 'subtracts', 'reward', 'Rt', 'baseline', 'V', '(', 'st', ')', '.', 'V', '(', 'st', ')', 'estimation', 'reward', ',', 'also', 'approximated', 'using', 'neural', 'network', 'like', 'policy', 'function', '.', 'Then', 'Rt', 'equations', 'becomesRt−V', '(', 'st', ')', '.', 'Yuxi', '[', '19', ']', 'done', 'survey', 'deep', 'reinforcement', 'learning', ',', 'including', 'actor-critic', 'model', 'used', 'paper', '.', '3', '.', 'SYSTEM', 'OVERVIEW', 'In', 'section', ',', 'present', 'system', 'architecture', 'Rafiki', 'illustrate', 'usability', 'use', 'cases', '.', 'To', 'use', 'Rafiki', ',', 'users', 'simply', 'configure', 'training', 'inference', 'jobs', 'either', 'RESTFul', 'APIs', 'Python', 'SDK', '.', 'In', 'Figure', '2', '(', 'left', 'column', ')', ',', 'show', 'one', 'image', 'classification', 'example', 'using', 'Python', 'SDK', '.', 'The', 'training', 'code', 'consists', '4', 'lines', '.', 'The', 'first', 'line', 'loads', 'images', 'folder', 'Rafiki', '’', 'distributed', 'data', 'stor-', 'age', '(', 'HDFS', ')', ',', 'images', 'subfolder', 'labeled', 'subfolder', 'name', ',', 'i.e', '.', 'food', 'name', '.', 'The', 'second', 'line', 'creates', 'configuration', 'object', 'representing', 'hyper-parameter', 'tuning', 'options', '(', 'see', 'Section', '4.2', 'details', ')', '.', 'The', 'third', 'line', 'creates', 'training', 'job', 'passing', 'data', ',', 'options', 'input/output', 'shapes', '(', 'tuple', 'list', 'tuples', ')', '.', 'The', 'input-output', 'shapes', 'used', 'model', 'cus-', 'tomization', '.', 'For', 'example', ',', 'ConvNets', 'usually', 'accept', 'input', 'images', 'fixed', 'shape', ',', 'i.e', '.', 'input', 'shape', ',', 'adapt', 'final', 'output', 'layer', 'generate', 'number', 'outputs', 'output', 'shape', ',', 'could', 'total', 'number', 'classes', 'bounding-box', 'shape', '.', 'The', 'last', 'line', 'submits', 'job', 'RESTFul', 'APIs', 'Rafiki', 'exe-', 'cution', '.', 'It', 'returns', 'job', 'ID', 'handle', 'job', 'monitoring', '.', 'Once', 'training', 'finishes', ',', 'deploy', 'models', 'instantly', 'shown', 'infer.py', '.', 'It', 'gets', 'model', 'instances', ',', 'consists', 'model', 'name', 'parameter', 'names', 'retrieving', 'parameter', 'values', 'Rafiki', '’', 'parameter', 'server', '.', 'It', 'uses', 'second', 'line', 'create', 'inference', 'job', 'given', 'models', '.', 'After', 'model', 'deployed', 'line', '3', ',', 'application', 'users', 'submit', 'requests', 'job', 'prediction', 'shown', 'code', 'query.py', '.', 'Ap-', 'plications', 'like', 'mobile', 'App', 'send', 'RESTFul', 'requests', 'query', '.', 'For', 'training', 'job', ',', 'Rafiki', 'selects', 'corresponding', 'built-in', 'models', 'based', 'task', 'type', '.', 'The', 'table', 'Figure', '2', 'lists', 'built-in', 'tasks', 'models', '.', 'With', 'proliferation', 'machine', 'learning', ',', 'able', 'find', 'open', 'source', 'implementations', 'al-', 'every', 'model', '.', 'Figure', '3', 'compares', 'memory', 'footprint', ',', 'ac-', 'curacy', 'inference', 'speed', 'open', 'source', 'ConvNets5', '.', '5', 'Groups', 'ConvNets', 'compared', ',', 'including', 'Inception', 'ConvNets', '[', '32', ']', ',', 'MobileNet', '[', '12', ']', ',', 'NASNets', '[', '38', ']', ',', 'ResNets', '[', '10', ']', 'VGGs', '[', '27', ']', '.', 'The', 'accuracy', 'measured', 'based', 'top-1', 'prediction', 'images', 'validation', 'dataset', 'ImageNet', '.', 'The', 'inference', 'time', 'mem-', 'ory', 'footprint', 'averaged', '50', 'iterations', ',', '50', 'images', '(', 'i.e', '.', 'batch', 'size=50', ')', '.', '5https', ':', '//github.com/tensorflow/models/tree/master/research/slim/', '3', 'Data', 'Hyper-tune', 'Hyper-tune', 'Ensemble', 'modelling', 'ResNet', 'Parameter', 'Task', 'Models', 'Image', 'classification', 'VGG', ',', 'ResNet', ',', 'Squeezenet', ',', 'XceptionNet', ',', 'InceptionNet', 'Object', 'detection', 'YOLO', ',', 'SSD', ',', 'FasterRCNN', 'Sentiment', 'analysis', 'TemporalCNN', ',', 'FastText', ',', 'CharacterRNN', '…', '…', 'ResNet', 'ResNetVGG', 'VGG', 'VGG', 'Master', 'Worker', 'Rafiki', 'user', 'code', 'Rafiki', 'Application', 'user', 'code', '#', 'train.py', 'import', 'rafiki', 'data', '=', 'rafiki.import_images', '(', "'food/", "'", ')', 'hyper', '=', 'rafiki.HyperConf', '(', ')', 'job', '=', 'rafiki.Train', '(', "name='train", '’', ',', 'data=data', ',', 'task=', "''", 'ImageClassification', "''", ',', 'input_shape=', '(', '3,256,256', ')', ',', 'output_shape=', '(', '120', ',', ')', ',', 'hyper', '=', 'hyper', ')', 'job_id', '=', 'job.run', '(', ')', '#', 'infer.py', 'models', '=', 'rafiki.get_models', '(', 'job_id', ')', 'job', '=', 'rafiki.Inference', '(', 'models', ')', 'job_id', '=', 'job.run', '(', ')', 'img', '=', 'Image.load', '(', "'test.jpg", "'", ')', 'ret', '=', 'rafiki.query', '(', 'job=job_id', ',', 'data=', '{', "'img", "'", ':', 'img', '}', ')', 'print', '(', 'ret', '[', "'label", "'", ']', ')', 'ret', '[', '‘', 'label', '’', ']', 'Figure', '2', ':', 'Overview', 'Rafiki', '.', '0.2', '0.4', '0.6', '0.8', '1.0', 'Time', 'Each', 'Iteration', '(', ')', '0.70', '0.75', '0.80', 'Ac', 'cu', 'ra', 'cy', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'Figure', '3', ':', 'Accuracy', ',', 'inference', 'time', 'memory', 'footprint', 'popular', 'ConvNets', '.', 'Hyper-parameter', 'tuning', '(', 'See', 'Section', '4.2', ')', 'conducted', 'every', 'selected', 'model', '.', 'For', 'example', ',', 'two', 'sets', 'hyper-parameters', 'be-', 'ing', 'tested', 'ResNet', '[', '10', ']', '(', 'resp', '.', 'VGG', '[', '27', ']', ')', 'shown', 'Figure', '2', '.', 'The', 'trained', 'model', 'parameters', 'stored', 'global', 'parameter', 'server', '(', 'PS', ')', ',', 'persistent', 'distributed', 'in-memory', 'storage', '.', 'Once', 'training', 'done', ',', 'inference', 'workers', 'fetch', 'parame-', 'ters', 'PS', 'efficiently', '.', 'The', 'inference', 'job', 'launches', 'models', 'passed', 'user', 'configuration', '.', 'Ensemble', 'modeling', '(', 'See', 'section', '5', ')', 'applied', 'optimize', 'inference', 'accuracy', 'requests', 'application', '(', 'e.g', '.', 'database', ')', 'users', '.', 'Rafiki', 'compatible', 'machine', 'learning', 'framework', ',', 'in-', 'cluding', 'TensorFlow', '[', '2', ']', ',', 'Scikit-learn', ',', 'Kears', ',', 'etc.', ',', 'although', 'built', 'top', 'Apache', 'Singa', '[', '34', ',', '22', ',', '33', ']', 'due', 'efficiency', 'scalable', 'architecture', '.', 'More', 'details', 'Rafiki', 'implementation', 'described', 'Section', '6', '.', '4', '.', 'TRAINING', 'SERVICE', 'The', 'training', 'service', 'consists', 'two', 'steps', ',', 'namely', 'model', 'selec-', 'tion', 'hyper-parameter', 'tuning', '.', 'We', 'adopt', 'simple', 'model', 'selec-', 'tion', 'strategy', 'Rafiki', '.', 'For', 'hyper-parameter', 'tuning', ',', 'first', 'pro-', 'pose', 'general', 'programming', 'model', 'distributed', 'tuning', ',', 'propose', 'collaborative', 'tuning', 'scheme', '.', '4.1', 'Model', 'Selection', 'Every', 'built-in', 'model', 'Rafiki', 'registered', 'task', ',', 'e.g', '.', 'im-', 'age', 'classification', 'sentiment', 'analysis', '.', 'Each', 'model', 'associated', 'meta', 'data', 'including', 'training', 'cost', ',', 'e.g', '.', 'speed', 'memory', 'consumption', ',', 'performance', 'dataset', '(', 'e.g', '.', 'accuracy', 'area-under-curve', ')', '.', 'Ease.ml', '[', '18', ']', 'proposes', 'convert', 'model', 'selection', 'multi-armed', 'bandit', 'problem', ',', 'ev-', 'ery', 'model', '(', 'i.e', '.', 'arm', ')', 'gets', 'chance', 'training', '.', 'After', 'many', 'trials', ',', 'chance', 'under-performed', 'models', 'would', 'decreased', '.', 'We', 'observe', 'models', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', '.', 'For', 'example', ',', 'ResNet', '[', '10', ']', 'better', 'AlexNet', '[', '15', ']', 'SqueezeNet', '[', '13', ']', 'bunch', 'datasets', 'including', 'Ima-', 'geNet', '[', '7', ']', ',', 'CIFAR-106', ',', 'etc..', 'Therefore', ',', 'adopt', 'simple', 'model', 'selection', 'strategy', 'without', 'advanced', 'analysis', '.', 'We', 'select', 'models', 'similar', 'performance', 'different', 'architectures', '.', 'This', 'create', 'diverse', 'model', 'set', '[', '16', ']', 'whose', 'performance', 'would', 'boosted', 'applying', 'ensemble', 'modeling', '.', '4.2', 'Distributed', 'Hyper-parameter', 'Tuning', 'Hyper-parameter', 'tuning', 'usually', 'run', 'many', 'different', 'sets', 'hyper-parameters', '.', 'Distributed', 'tuning', 'running', 'instances', 'parallel', 'natural', 'solution', 'reducing', 'tuning', 'time', '.', 'There', '6https', ':', '//www.cs.toronto.edu/', 'kriz/cifar.html', '4', 'Table', '1', ':', 'Hyper-parameter', 'groups', '.', 'Group', 'Hyper-parameter', 'Example', 'Domain', '1', '.', 'Data', 'preprocessing', 'Image', 'rotation', '[', '0,30', ')', 'Image', 'cropping', '[', '0,32', ']', 'Whitening', '{', 'PCA', ',', 'ZCA', '}', '2', '.', 'Model', 'architecture', 'Number', 'layers', 'Z+', 'N', 'cluster', 'Z+', 'Kernel', '{', 'Linear', ',', 'RBF', ',', 'Poly', '}', '3', '.', 'Training', 'algorithm', 'Learning', 'rate', 'R+', 'Weight', 'decay', 'R+', 'Momentum', 'R+', 'three', 'popular', 'approaches', 'hyper-parameter', 'tuning', ',', 'namely', 'grid', 'search', ',', 'random', 'search', '[', '3', ']', 'Bayesian', 'optimization', '[', '26', ']', '.', 'To', 'support', 'algorithms', ',', 'need', 'general', 'extensible', 'pro-', 'gramming', 'model', '.', '4.2.1', 'Programming', 'Model', 'We', 'cluster', 'hyper-parameters', 'involved', 'training', 'machine', 'learning', 'model', 'three', 'groups', 'shown', 'Table', '1', '.', 'Data', 'prepro-', 'cessing', 'adopts', 'different', 'approaches', 'normalize', 'data', ',', 'augment', 'dataset', 'extract', 'features', 'raw', 'data', ',', 'i.e', '.', 'feature', 'en-', 'gineering', '.', 'Most', 'machine', 'learning', 'models', 'tuning', 'knobs', 'form', 'architecture', '’', 'hyper-parameters', ',', 'e.g', '.', 'number', 'trees', 'random', 'forest', ',', 'number', 'layers', 'ConvNets', 'kernel', 'function', 'SVM', '.', 'The', 'optimization', 'algorithms', ',', 'especially', 'gradient', 'based', 'optimization', 'algorithms', 'like', 'SGD', ',', 'many', 'hyper-parameters', ',', 'including', 'initial', 'learning', 'rate', ',', 'decaying', 'rate', 'decaying', 'method', '(', 'linear', 'exponential', ')', ',', 'etc', '.', 'From', 'Table', '1', 'see', 'hyper-parameters', 'could', 'come', 'range', 'list', 'numbers', 'categories', '.', 'All', 'possible', 'as-', 'signments', 'hyper-parameters', 'construct', 'hyper-parameter', 'space', ',', 'denoted', 'H.', 'Following', 'convention', '[', '9', ']', ',', 'call', 'one', 'point', 'space', 'trial', ',', 'denoted', 'h.', 'Rafiki', 'provides', 'Hyper-', 'Space', 'class', 'functions', 'shown', 'Figure', '4', 'developers', 'specify', 'hyper-parameter', 'space', '.', 'import', 'rafiki', 'data', '=', 'rafiki.import_images', '(', "'food/", "'", ')', 'hyper', '=', 'rafiki.HyperConf', '(', ')', 'job', '=', 'rafiki.Train', '(', "name='train", '’', ',', 'data=data', ',', 'task=', "''", 'ImageClassification', "''", ',', 'input_shape=', '(', '3,256,256', ')', ',', 'output_shape=', '(', '120', ',', ')', ',', 'hyper', '=', 'hyper', ')', 'job_id', '=', 'job.run', '(', ')', 'models', '=', 'rafiki.get_models', '(', 'job_id', ')', 'job', '=', 'rafiki.Inference', '(', 'models', ')', 'job_id', '=', 'job.run', '(', ')', 'img', '=', 'Image.load', '(', "'test.jpg", "'", ')', 'ret', '=', 'rafiki.query', '(', 'job=job_id', ',', 'data=', '{', "'img", "'", ':', 'img', '}', ')', 'print', '(', 'ret', '[', "'label", "'", ']', ')', 'class', 'HyperSpace', '(', ')', ':', 'def', 'add_range_knob', '(', 'name', ',', 'dtype', ',', 'min', ',', 'max', ',', 'depends=None', ',', 'pre_hook=None', ',', 'post_hook=None', ')', 'def', 'add_categorical_knob', '(', 'name', ',', 'dtype', ',', 'list', ',', 'depends=None', ',', 'pre_hook=None', ',', 'post_hook=None', ')', 'Figure', '4', ':', 'HyperSpace', 'APIs', '.', 'The', 'first', 'function', 'defines', 'domain', 'hyper-parameter', 'range', '[', 'min', ',', 'max', ')', ';', 'dtype', 'represents', 'data', 'type', 'could', 'float', ',', 'integer', 'string', '.', 'depends', 'list', 'hyper-parameters', 'whose', 'values', 'directly', 'affect', 'generation', 'hyper-parameter', '.', 'For', 'example', ',', 'initial', 'learning', 'rate', 'large', ',', 'would', 'prefer', 'larger', 'decay', 'rate', 'decease', 'learning', 'rate', 'quickly', '.', 'There-', 'fore', ',', 'decay', 'rate', 'generated', 'generating', 'learn-', 'ing', 'rate', '.', 'To', 'enforce', 'relation', ',', 'add', 'learning', 'rate', 'depends', 'list', 'add', 'post', 'hook', 'function', 'adjust', 'value', 'learning', 'rate', 'decay', '.', 'The', 'second', 'function', 'defines', 'categori-', 'cal', 'hyper-parameter', ',', 'list', 'represents', 'candidates', '.', 'depends', ',', 'pre', 'hook', ',', 'post', 'hook', 'analogous', 'range', 'knob', '.', 'The', 'whole', 'hyper-parameter', 'tuning', 'process', 'one', 'model', 'dataset', 'called', 'study', '.', 'The', 'performance', 'trial', 'h', 'de-', 'noted', 'ph', '.', 'A', 'larger', 'ph', 'indicates', 'better', 'performance', '(', 'e.g', '.', 'ac-', 'curacy', ')', '.', 'For', 'distributed', 'hyper-parameter', 'tuning', ',', 'master', 'multiple', 'workers', 'study', '.', 'The', 'master', 'generates', 'trials', 'workers', ',', 'workers', 'evaluate', 'trials', '.', 'At', 'one', 'time', ',', 'worker', 'trains', 'model', 'given', 'trial', '.', 'The', 'workflow', 'study', 'master', 'side', 'explained', 'Algorithm', '1', '.', 'The', 'master', 'iter-', 'ates', 'event', 'loop', 'collect', 'performance', 'trial', ',', 'i.e', '.', '<', 'h', ',', 'ph', ',', '>', ',', 'generates', 'next', 'trial', 'TrialAdvisor', 'im-', 'plements', 'hyper-parameter', 'search', 'algorithm', ',', 'e.g', '.', 'random', 'search', 'Bayesian', 'optimization', '.', 'It', 'stops', 'trials', 'test', 'user', 'configured', 'stop', 'criteria', 'satisfied', '(', 'e.g', '.', 'total', 'num-', 'ber', 'trials', ')', '.', 'Finally', ',', 'best', 'parameters', 'put', 'parameter', 'server', 'inference', 'service', '.', 'The', 'worker', 'side', 'keeps', 'requesting', 'trials', 'master', ',', 'conducting', 'training', 'reporting', 'results', 'master', '.', 'Algorithm', '1', 'Study', '(', 'HyperTune', 'conf', ',', 'TrialAdvisor', 'adv', ')', '1', ':', 'num', '=', '0', '2', ':', 'conf.stop', '(', 'num', ')', '3', ':', 'msg', '=', 'ReceiveMsg', '(', ')', '4', ':', 'msg.type', '==', 'kRequest', '5', ':', 'trial', '=', 'adv.next', '(', 'msg.worker', ')', '6', ':', 'trial', 'nil', '7', ':', 'break', '8', ':', 'else', '9', ':', 'send', '(', 'msg.worker', ',', 'trial', ')', '10', ':', 'end', '11', ':', 'else', 'msg.type', '==', 'kReport', '12', ':', 'adv.collect', '(', 'msg.worker', ',', 'msg.p', ',', 'msg.trial', ')', '13', ':', 'else', 'msg.type', '==', 'kFinish', '14', ':', 'num', '+=', '1', '15', ':', 'adv.is', 'best', '(', 'msg.worker', ')', '16', ':', 'send', '(', 'msg.worker', ',', 'kPut', ')', '17', ':', 'end', '18', ':', 'end', '19', ':', 'end', '20', ':', 'return', 'adv.best', 'trial', '(', ')', '4.2.2', 'Collaborative', 'Tuning', 'In', 'section', ',', 'introduced', 'distributed', 'hyper-', 'parameter', 'tuning', 'framework', '.', 'Next', ',', 'extend', 'framework', 'proposing', 'collaborative', 'tuning', 'scheme', '.', 'SGD', 'widely', 'used', 'training', 'machine', 'learning', 'models', '.', 'We', 'often', 'observe', 'training', 'loss', 'stays', 'plateau', ',', 'drops', 'suddenly', 'decrease', 'learning', 'rate', 'SGD', ',', 'e.g', '.', '0.1', '0.01', '0.01', '0.001', '[', '10', ']', '.', 'Based', 'observation', ',', 'see', 'hyper-parameters', 'changed', 'training', 'get', 'plateau', 'de-', 'rive', 'better', 'performance', '.', 'Therefore', ',', 'fix', 'model', 'architec-', 'ture', 'tune', 'hyper-parameters', 'group', '1', '3', 'Table', '1', ',', 'model', 'parameters', 'trained', 'using', 'one', 'hyper-parameter', 'trial', 'reused', 'initialize', 'model', 'another', 'trial', '.', 'By', 'selecting', 'parameters', 'top', 'performing', 'trials', 'continue', 'hyper-parameter', 'tuning', ',', 'old', 'trials', 'like', 'pre-', 'training', '[', '11', ']', '.', 'In', 'fact', ',', 'good', 'model', 'initialization', 'results', 'faster', 'convergence', 'better', 'performance', '[', '30', ']', '.', 'Users', 'typically', 'fine-tune', 'popular', 'ConvNet', 'architectures', 'datasets', '.', 'Conse-', 'quently', ',', 'collaborative', 'tuning', 'scheme', 'likely', 'converge', 'good', 'state', '.', 'It', 'straightforward', 'tune', 'hyper-parameters', 'related', 'model', 'architecture', '.', 'This', 'architecture', 'changes', ',', 'parameters', 'also', 'change', '.', 'For', 'example', ',', 'parameters', 'convolution', 'layer', 'filter', 'size', '3x3', 'used', 'initialize', '5', 'convolution', 'layer', 'another', 'ConvNet', 'whose', 'filter', 'size', '5x5', '.', 'However', ',', 'architecture', 'tuning', ',', 'many', 'architectures', 'available', '.', 'It', 'likely', 'architectures', 'share', 'config-', 'urations', 'one', 'convolution', 'layer', '.', 'For', 'instance', ',', 'ConvNet', '’', '3rd', 'convolution', 'layer', 'ConvNet', 'b', '’', '3rd', 'layer', 'convo-', 'lution', 'setting', ',', 'use', 'parametersW', 'ConvNet', '’', '3rd', 'layer', 'initialize', 'ConvNet', 'b', '’', '3rd', 'layer', '.', 'We', 'store', 'allW', 'parameter', 'server', 'fetch', 'shape', 'matched', 'W', 'initialize', 'layers', 'new', 'trials', '(', 'ConvNets', ')', '.', 'If', 'performance', 'new', 'trail', 'better', 'older', 'one', ',', 'overwrite', 'W', 'parameter', 'server', 'new', 'values', '.', 'A', 'B', 'C', '𝛼', '=', '1', '𝛼', '=', '0.1', '𝛼', '=', '0.01', '𝛼', '=', '0.1', '𝛼', '=', '0.01', '𝛼', '=', '0.1', 'Figure', '5', ':', 'A', 'collaborative', 'tuning', 'example', '.', 'The', 'whole', 'process', 'illustrated', 'Figure', '5', ',', '3', 'workers', 'running', 'trials', 'tune', 'hyper-parameters', '(', 'e.g', '.', 'learning', 'rate', ')', 'model', '.', 'After', ',', 'performance', 'worker', 'A', 'stops', 'increasing', '.', 'The', 'training', 'stops', 'automatically', 'according', 'early', 'stopping', 'criteria', ',', 'e.g', 'training', 'loss', 'decreasing', '5', 'consecutive', 'epochs', '.', 'Early', 'stopping', 'widely', 'used', 'training', 'machine', 'learning', 'models7', '.', 'The', 'new', 'trial', 'worker', 'A', 'uses', 'pa-', 'rameters', 'current', 'best', 'worker', ',', 'B', '.', 'The', 'work', 'done', 'B', 'serves', 'pre-training', 'new', 'trial', 'A', '.', 'Similarly', ',', 'C', 'enters', 'plateau', ',', 'master', 'instructs', 'start', 'new', 'trial', 'C', 'using', 'parameters', 'A', ',', 'whose', 'model', 'best', 'performance', 'point', 'time', '.', 'The', 'control', 'flow', 'collaborative', 'tuning', 'scheme', 'described', 'Algorithm', '2', '.', 'It', 'similar', 'Algorithm', '1', 'except', 'master', 'instructs', 'worker', 'save', 'model', 'parameters', 'global', 'pa-', 'rameter', 'server', '(', 'Line', '9', ')', 'model', '’', 'performance', 'significantly', 'larger', 'current', 'best', 'performance', '(', 'Line', '8', ')', '.', 'The', 'performance', 'difference', ',', 'i.e', '.', 'conf.delta', 'configuration', 'parameter', 'Hyper-', 'Conf', ',', 'set', 'according', 'user', '’', 'expectation', 'performance', 'model', '.', 'For', 'example', ',', 'MNIST', 'image', 'classi-', 'fication', ',', 'improvement', '0.1', '%', 'large', 'current', 'best', 'performance', '99', '%', '.', 'For', 'CIFAR-10', 'image', 'classification', ',', 'may', 'set', 'delta', '0.5', '%', 'best', 'accuracy', '97.4', '%', '[', '8', ']', ',', 'means', 'bigger', 'improvement', 'space', '.', 'We', 'notice', 'bad', 'parameter', 'initialization', 'degrades', 'perfor-', 'mance', 'experiments', '.', 'This', 'serious', 'random', 'search', '.', 'Because', 'checkpoint', 'one', 'trial', 'poor', 'accuracy', 'would', 'affect', 'next', 'trials', 'model', 'parameters', 'initialized', 'poor', 'state', '.', 'To', 'resolve', 'problem', ',', 'α-greedy', 'strategy', 'intro-', 'duced', 'implementation', ',', 'initializes', 'model', 'param-', 'eters', 'either', 'random', 'initialization', 'pre-trained', 'model', 'checkpoint', 'file', '.', 'A', 'threshold', 'α', 'represents', 'probability', 'choos-', 'ing', 'random', 'initialization', '(', '1-α', ')', 'represents', 'probability', 'us-', 'ing', 'pre-trained', 'checkpoint', 'files', '.', 'α', 'decreases', 'gradually', 'decrease', 'chance', 'random', 'initialization', ',', 'i.e', '.', 'increasing', 'chance', 'CoStudy', '.', 'This', 'α-greedy', 'strategy', 'widely', 'used', 'reinforcement', 'learning', 'balance', 'exploration', 'exploitation', '.', '5', '.', 'INFERENCE', 'SERVICE', '7https', ':', '//keras.io/callbacks/', '#', 'earlystopping', 'Algorithm', '2', 'CoStudy', '(', 'HyperTune', 'conf', ',', 'TrialAdvisor', 'adv', ')', '1', ':', 'num', '=', '0', ',', 'best', 'p', '=', '0', '2', ':', 'conf.stop', '(', 'num', ')', '3', ':', 'msg', '=', 'ReceiveMsg', '(', ')', '4', ':', 'msg.type', '==', 'kRequest', '5', ':', '...', '.', '//', 'Algorithm', '1', '6', ':', 'else', 'msg.type', '==', 'kReport', '7', ':', 'adv.collect', '(', 'msg.worker', ',', 'msg.p', ',', 'msg.trial', ')', '8', ':', 'msg.p', '-', 'best', 'p', '>', 'conf.delta', '9', ':', 'send', '(', 'msg.worker', ',', 'kPut', ')', '10', ':', 'best', 'p', '=', 'msg.p', '11', ':', 'else', 'adv.early', 'stopping', '(', 'msg.worker', ',', 'conf', ')', '12', ':', 'send', '(', 'msg.worker', ',', 'kStop', ')', '13', ':', 'end', '14', ':', 'else', 'msg.type', '==', 'kFinish', '15', ':', 'num', '+=', '1', '16', ':', 'end', '17', ':', 'end', '18', ':', 'return', 'adv.best', 'trial', '(', ')', 'Inference', 'service', 'provides', 'real-time', 'request', 'serving', 'deploy-', 'ing', 'trained', 'model', '.', 'Other', 'services', ',', 'like', 'database', 'services', ',', 'sim-', 'ply', 'optimize', 'throughput', 'constraint', 'latency', ',', 'set', 'manually', 'service', 'level', 'objective', '(', 'SLO', ')', ',', 'denoted', 'τ', ',', 'e.g', '.', 'τ', '=', '0.1', 'seconds', '.', 'For', 'machine', 'learning', 'services', ',', 'accuracy', 'becomes', 'important', 'optimization', 'objective', '.', 'The', 'accuracy', 'refers', 'wide', 'range', 'performance', 'measurements', ',', 'e.g', '.', 'negative', 'error', ',', 'precision', ',', 'recall', ',', 'F1', ',', 'area', 'curve', ',', 'etc', '.', 'A', 'larger', 'value', '(', 'accuracy', ')', 'indicates', 'better', 'performance', '.', 'If', 'set', 'latency', 'hard', 'constraint', 'shown', 'Equation', '4', ',', 'overdue', 'requests', 'would', 'get', '‘', 'time', '’', 'responses', '.', 'Typically', ',', 'delayed', 'response', 'better', 'error', '‘', 'time', '’', 'end-users', '.', 'Hence', ',', 'process', 'requests', 'queue', 'se-', 'quentially', 'following', 'FIFO', '(', 'first-in-first-out', ')', '.', 'The', 'objective', 'maximize', 'accuracy', 'minimize', 'exceeding', 'time', 'accord-', 'ing', 'τ', '.', 'However', ',', 'typically', ',', 'trade-off', 'accuracy', 'latency', '.', 'For', 'example', ',', 'ensemble', 'modeling', 'models', 'increases', 'accuracy', 'latency', '.', 'We', 'shall', 'optimize', 'model', 'selection', 'ensemble', 'modeling', 'Section', '5.2', '.', 'Before', ',', 'discuss', 'simpler', 'case', 'single', 'inference', 'model', '.', 'Table', '2', 'summarizes', 'notations', 'used', 'section', '.', 'maxAccuracy', '(', 'S', ')', '(', '4', ')', 'subject', '∀s', '∈', 'S', ',', 'l', '(', ')', '<', 'τ', '5.1', 'Single', 'Inference', 'Model', 'When', 'one', 'single', 'model', 'deployed', 'application', ',', 'accuracy', 'inference', 'service', 'fixed', 'system', '’', 'per-', 'spective', '.', 'Therefore', ',', 'optimization', 'objective', 'reduced', 'mini-', 'mizing', 'exceeding', 'time', ',', 'formalized', 'Equation', '5.', 'min', '∑', 's∈Smax', '(', '0', ',', 'l', '(', ')', '−', 'τ', ')', '|S|', '(', '5', ')', 'The', 'latency', 'l', '(', ')', 'request', 'includes', 'waiting', 'time', 'queue', 'w', '(', ')', ',', 'inference', 'time', 'depends', 'model', 'complexity', ',', 'hardware', 'efficiency', '(', 'i.e', '.', 'FLOPS', ')', 'batch', 'size', '.', 'The', 'batch', 'size', 'decides', 'number', 'requests', 'processed', 'to-', 'gether', '.', 'Modern', 'processing', 'units', ',', 'like', 'CPU', 'GPU', ',', 'exploit', 'data', 'parallelism', 'techniques', '(', 'e.g', '.', 'SIMD', ')', 'improve', 'throughput', 'reduce', 'computation', 'cost', '.', 'Hence', ',', 'large', 'batch', 'size', 'necessary', '6', 'Table', '2', ':', 'Notations', '.', 'Name', 'Definition', 'S', 'request', 'list', 'M', 'model', 'list', 'τ', 'latency', 'requirement', 'b', '∈', 'B', 'one', 'batch', 'size', 'candidate', 'list', 'qk', 'k−th', 'oldest', 'requests', 'queue', 'q', ':', 'k', 'oldest', 'k', 'requests', 'qk', ':', 'latest', '|Q|', '−', 'k', 'requests', 'c', '(', 'b', ')', 'inference', 'time', 'batch', 'size', 'b', 'c', '(', ',', 'b', ')', 'inference', 'time', 'model', 'batch', 'size', 'b', 'w', '(', ')', 'waiting', 'time', 'request', 'queue', 'l', '(', ')', 'latency', '(', 'waiting', '+', 'inference', 'time', ')', 'request', 'β', 'balancing', 'factor', 'accuracy', 'latency', 'v', 'binary', 'vector', 'model', 'selection', 'R', '(', ')', 'reward', 'function', 'set', 'requests', 'saturate', 'parallelism', 'capacity', '.', 'Once', 'model', 'deployed', 'cloud', 'platform', ',', 'model', 'complexity', 'hardware', 'efficiency', 'fixed', '.', 'Therefore', ',', 'Rafiki', 'tunes', 'batch', 'size', 'optimize', 'latency', '.', 'To', 'construct', 'large', 'batch', ',', 'e.g', '.', 'b', 'requests', ',', 'delay', 'processing', 'b', 'requests', 'arrive', ',', 'may', 'incur', 'large', 'latency', 'old', 'requests', 'request', 'arrival', 'rate', 'low', '.', 'The', 'op-', 'timal', 'batch', 'size', 'thus', 'influenced', 'SLO', 'τ', ',', 'queue', 'status', '(', 'e.g', '.', 'waiting', 'time', ')', ',', 'request', 'arrival', 'rate', 'varies', 'along', 'time', '.', 'Since', 'inference', 'time', 'two', 'similar', 'batch', 'sizes', 'varies', 'lit-', 'tle', ',', 'e.g', '.', 'b=8', 'b=9', ',', 'candidate', 'batch', 'size', 'list', 'include', 'values', 'significant', 'difference', 'w.r.t', 'in-', 'ference', 'time', ',', 'e.g', '.', 'B', '=', '{', '16', ',', '32', ',', '48', ',', '64', ',', '...', '}', '.', 'The', 'largest', 'batch', 'size', 'determined', 'system', '(', 'GPU', ')', 'memory', '.', 'c', '(', 'b', ')', ',', 'latency', 'processing', 'batch', 'b', 'requests', 'b', '∈', 'B', ',', 'determined', 'hard-', 'ware', 'resource', '(', 'e.g', '.', 'GPU', 'memory', ')', ',', 'model', '’', 'complexity', '.', 'Figure', '3', 'shows', 'inference', 'time', ',', 'memory', 'footprint', 'accuracy', 'popular', 'ConvNets', 'trained', 'ImageNet', '.', 'Algorithm', '3', 'shows', 'greedy', 'solution', 'problem', '.', 'It', 'al-', 'ways', 'applies', 'largest', 'batch', 'size', 'possible', '.', 'If', 'queue', 'length', '(', 'i.e', '.', 'number', 'requests', 'queue', ')', 'larger', 'largest', 'batch', 'size', 'b', '=', 'max', '(', 'B', ')', ',', 'oldest', 'b', 'requests', 'processed', 'one', 'batch', '.', 'Otherwise', ',', 'waits', 'oldest', 'request', '(', 'q0', ')', 'overdue', 'checked', 'Line', '8.', 'b', 'largest', 'batch', 'size', 'B', 'smaller', 'equal', 'queue', 'length', '(', 'Line', '8', ')', '.', 'δ', 'back-off', 'constant', ',', 'equivalent', 'reducing', 'batch', 'size', 'Additive-Increase-Multiplicative-Decrease', 'scheme', '(', 'AIMD', ')', '[', '5', ']', ',', 'e.g', '.', 'δ', '=', '0.1τ', '.', 'Algorithm', '3', 'Inference', '(', 'Queue', 'q', ',', 'Model', ')', '1', ':', 'True', '2', ':', 'b', '=', 'maxB', '3', ':', 'len', '(', 'q', ')', '>', '=', 'b', '4', ':', 'm.infer', '(', 'q0', ':', 'b', ')', '5', ':', 'deque', '(', 'q0', ':', 'b', ')', '6', ':', 'else', '7', ':', 'b', '=', 'max', '{', 'b', '∈', 'B', ',', 'b', '<', '=', 'len', '(', 'q', ')', '}', '8', ':', 'c', '(', 'b', ')', '+', 'w', '(', 'q0', ')', '+', 'δ', '>', '=', 'τ', '9', ':', 'm.infer', '(', 'q0', ':', 'b', ')', '10', ':', 'deque', '(', 'q0', ':', 'b', ')', '11', ':', 'end', '12', ':', 'end', '13', ':', 'end', '5.2', 'Multiple', 'Inference', 'Models', 'Single', 'Model', 'Two', 'Models', 'Three', 'Models', 'Four', 'Models', 'Ensemble', 'Method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'Ac', 'cu', 'ra', 'cy', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'Figure', '6', ':', 'Accuracy', 'ensemble', 'modeling', 'different', 'models', '.', 'Ensemble', 'modeling', 'effective', 'popular', 'approach', 'im-', 'prove', 'inference', 'accuracy', '.', 'To', 'give', 'example', ',', 'compare', 'performance', 'different', 'ensemble', '4', 'ConvNets', 'shown', 'Figure', '6', '.', 'Majority', 'voting', 'applied', 'aggregate', 'predictions', '.', 'The', 'accuracy', 'evaluated', 'validation', 'dataset', 'ImageNet', '.', 'Generally', 'models', ',', 'accuracy', 'better', '.', 'The', 'exception', 'ensemble', 'resnet', 'v2', '101', 'inception', 'v3', ',', 'good', 'single', 'best', 'model', ',', 'i.e', '.', 'inception', 'resnet', 'v2', '.', 'In', 'fact', ',', 'prediction', 'ensemble', 'modeling', 'incep-', 'tion', 'v3', 'tie', ',', 'prediction', 'model', 'best', 'accuracy', 'selected', 'final', 'prediction', '.', 'Parallel', 'ensemble', 'modeling', 'running', 'one', 'model', 'per', 'node', '(', 'GPU', ')', 'straight-forward', 'way', 'scale', 'system', 'improve', 'throughput', '.', 'However', ',', 'latency', 'could', 'high', 'due', 'stragglers', '.', 'For', 'example', ',', 'shown', 'Figure', '3', ',', 'node', 'running', 'nasnet', 'large', 'would', 'slow', 'although', 'accuracy', 'high', '.', 'In', 'addition', ',', 'en-', 'semble', 'modeling', 'also', 'costly', 'terms', 'throughput', 'com-', 'pared', 'serving', 'different', 'requests', 'different', 'nodes', '(', 'i.e', '.', 'ensemble', ')', '.', 'We', 'see', 'trade-off', 'latency', '(', 'throughput', ')', 'accuracy', ',', 'controlled', 'model', 'selec-', 'tion', '.', 'If', 'requests', 'arrive', 'slowly', ',', 'simply', 'run', 'models', 'batch', 'get', 'best', 'accuracy', '.', 'However', ',', 'request', 'arrival', 'rate', 'high', ',', 'like', 'Section', '5.1', ',', 'select', 'different', 'models', 'different', 'requests', 'increase', 'throughput', 'reduce', 'latency', '.', 'In', 'addition', ',', 'model', 'selection', 'current', 'batch', 'also', 'affects', 'next', 'batch', '.', 'For', 'example', ',', 'use', 'models', 'batch', ',', 'next', 'batch', 'wait', 'least', 'one', 'model', 'finishes', '.', 'To', 'solve', 'Equation', '4', ',', 'balance', 'accuracy', 'latency', 'get', 'single', 'optimization', 'objective', '.', 'We', 'move', 'latency', 'term', 'objective', 'shown', 'Equation', '6', '.', 'It', 'maximizes', 'reward', 'functionR', 'related', 'prediction', 'accuracy', 'penalizes', 'overdue', 'requests', '.', 'β', 'balances', 'accuracy', 'latency', 'objective', '.', 'If', 'ground', 'truth', 'request', 'available', 'evaluating', 'accuracy', ',', 'normal', 'case', ',', 'find', 'surrogate', 'accuracy', '.', 'maxR', '(', 'S', ')', '−', 'βR', '(', '{', '∈', 'S', ',', 'l', '(', ')', '>', 'τ', '}', ')', '(', '6', ')', 'Like', 'analysis', 'single', 'inference', 'model', ',', 'need', 'consider', 'batch', 'size', 'selection', 'well', '.', 'It', 'difficult', 'design', 'optimal', 'policy', 'complex', 'decision', 'making', 'problem', ',', 'decides', 'model', 'selection', 'batch', 'size', 'selection', '.', 'In', 'paper', ',', '7', 'propose', 'optimize', 'Equation', '6', 'using', 'reinforcement', 'learning', '(', 'RL', ')', '.', 'RL', 'optimizes', 'objective', 'long', 'term', 'trying', 'different', 'actions', 'entering', 'corresponding', 'states', 'collect', 'rewards', '.', 'By', 'setting', 'reward', 'Equation', '6', 'defining', 'actions', 'model', 'selection', 'batch', 'selection', ',', 'apply', 'RL', 'optimization', 'problem', '.', 'RL', 'three', 'core', 'concepts', ',', 'namely', ',', 'action', ',', 'reward', 'state', '.', 'Once', 'three', 'concepts', 'defined', ',', 'apply', 'existing', 'RL', 'al-', 'gorithms', 'optimization', '.', 'We', 'define', 'three', 'concepts', 'w.r.t', 'optimization', 'problem', 'follows', '.', 'First', ',', 'state', 'space', 'consists', ':', ')', 'queue', 'status', 'represented', 'waiting', 'time', 'request', 'queue', '.', 'The', 'waiting', 'time', 'requests', 'form', 'feature', 'vec-', 'tor', '.', 'To', 'generate', 'fixed', 'length', 'feature', 'vector', ',', 'pad', '0', 'shorter', 'queues', 'truncate', 'longer', 'queues', '.', 'b', ')', 'model', 'status', 'represented', 'vector', 'including', 'inference', 'time', 'different', 'models', 'different', 'batch', 'sizes', ',', 'i.e', '.', 'c', '(', ',', 'b', ')', ',', '∈M', ',', 'b', '∈', 'B', ',', 'left', 'time', 'finish', 'existing', 'requests', 'dispatched', '.', 'The', 'two', 'feature', 'vectors', 'concatenated', 'state', 'feature', 'vector', ',', 'input', 'RL', 'model', 'generating', 'action', '.', 'Second', ',', 'action', 'decides', 'batch', 'size', 'b', 'model', 'selection', 'represented', 'binary', 'vector', 'v', 'length', '|M', '|', '(', '1', 'selected', ';', '0', 'unselected', ')', '.', 'The', 'action', 'space', 'size', 'thus', '(', '2|M|−', '1', ')', '∗', '|B|', '.', 'We', 'exclude', 'case', 'v', '=', '0', ',', 'i.e', '.', 'none', 'models', 'selected', '.', 'Third', ',', 'following', 'Equation', '6', ',', 'reward', 'one', 'batch', 'requests', 'without', 'ground', 'truth', 'labels', 'defined', 'Equation', '7', ',', '(', 'M', '[', 'v', ']', ')', 'accuracy', 'selected', 'models', '(', 'ensemble', 'modeling', ')', '.', 'In', 'paper', ',', 'use', 'accuracy', 'evaluated', 'validation', 'dataset', 'surrogate', 'accu-', 'racy', '.', 'In', 'experiment', ',', 'use', 'ImageNet', '’', 'validation', 'dataset', 'evaluate', 'accuracy', 'different', 'ensemble', 'combinations', 'im-', 'age', 'classification', '.', 'The', 'results', 'shown', 'Figure', '6', '.', 'The', 'reward', 'shown', 'Equation', '7', 'considers', 'accuracy', ',', 'latency', '(', 'indirectly', 'represented', 'number', 'overdue', 'requests', ')', 'number', 'requests', '.', '(', 'M', '[', 'v', ']', ')', '∗', '(', 'b−', 'β|', '{', '∈', 'batch|l', '(', ')', '>', 'τ', '}', '|', ')', '(', '7', ')', 'With', 'state', ',', 'action', 'reward', 'well', 'defined', ',', 'apply', 'actor-critic', 'algorithm', '[', '24', ']', 'optimize', 'overall', 'reward', 'learn-', 'ing', 'good', 'policy', 'selecting', 'models', 'batch', 'size', '.', '6', '.', 'SYSTEM', 'IMPLEMENTATION', 'In', 'section', ',', 'introduce', 'implementation', 'details', 'Rafiki', ',', 'including', 'cluster', 'management', ',', 'data', 'parameter', 'storage', ',', 'failure', 'recovery', '.', '6.1', 'Cluster', 'Management', 'Manager', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Train', '(', ')', 'Inference', '(', ')', 'Node', 'A', 'Node', 'CNode', 'B', 'Figure', '7', ':', 'Rafiki', 'cluster', 'topology', '.', 'Rafiki', 'uses', 'Kubernetes', 'manage', 'Docker', 'containers', ',', 'run', 'masters', ',', 'workers', ',', 'data', 'servers', 'parameter', 'servers', 'shown', 'Figure', '7', '.', 'Docker', 'container', 'widely', 'used', 'applica-', 'tion', 'deployment', ',', 'bundles', 'application', 'code', '(', 'e.g', '.', 'training', 'inference', 'code', ')', 'libraries', '(', 'e.g', '.', 'Keras', ')', 'avoid', 'tedious', 'en-', 'vironment', 'setup', '.', 'New', 'models', ',', 'hyper-parameter', 'tuning', 'algorithms', ',', 'ensemble', 'modeling', 'approaches', 'deployed', 'new', 'Docker', 'containers', '.', 'On', 'physical', 'node', ',', 'could', 'multiple', 'masters', 'workers', 'different', 'jobs', ',', 'including', 'training', 'infer-', 'ence', 'jobs', '.', 'These', 'jobs', 'started', 'Rafiki', 'manager', ',', 'accepts', 'job', 'submissions', 'users', '(', 'See', 'Figure', '2', ')', '.', 'Once', 'job', 'launched', ',', 'users', 'communicate', 'master', 'directly', 'get', 'training', 'progress', 'submit', 'query', 'requests', '.', 'Rafiki', 'prefers', 'locate', 'master', 'workers', 'job', 'physical', 'node', 'avoid', 'network', 'communication', 'overhead', '.', '6.2', 'Data', 'Parameter', 'Storage', 'Deep', 'learning', 'models', 'typically', 'trained', 'large', 'datasets', 'would', 'consume', 'lot', 'space', 'stored', 'CPU', 'memory', '.', 'There-', 'fore', ',', 'Rafiki', 'uses', 'HDFS', 'data', 'storage', ',', '‘', 'data', 'nodes', '’', 'also', 'docker', 'containers', '.', 'Users', 'upload', 'datasets', 'HDFS', 'via', 'Rafiki', 'utility', 'functions', ',', 'e.g', '.', 'rafiki.import', 'images', '(', 'see', 'Fig-', 'ure', '2', ')', '.', 'The', 'training', 'dataset', 'downloaded', 'local', 'directory', 'be-', 'fore', 'training', ',', 'via', 'rafiki.download', '(', ')', 'passing', 'dataset', 'name', '.', 'For', 'model', 'parameters', ',', 'Rafiki', 'distributed', 'parameter', 'server', '.', 'The', 'parameter', 'server', 'designed', 'special', 'optimiza-', 'tion', 'hyper-parameter', 'training', 'inference', '.', 'In', 'particular', ',', 'hyper-parameters', 'cached', 'memory', 'accessed', 'frequently', ',', 'e.g', '.', 'Rafiki', 'hyper-parameter', 'training', '.', 'Otherwise', ',', 'stored', 'HDFS', '.', 'The', 'parameters', 'trained', 'model', 'different', 'datasets', 'shared', 'long', 'privacy', 'setting', 'public', '.', 'It', 'shown', 'training', 'warm-up', 'using', 'parameters', 'pre-trained', 'datasets', 'speeds', 'training', '[', '21', ']', '.', '6.3', 'Failure', 'Recovery', 'For', 'hyper-parameter', 'training', 'inference', 'services', ',', 'workers', 'stateless', '.', 'Hence', ',', 'Rafiki', 'manager', 'easily', 'recover', 'nodes', 'running', 'new', 'docker', 'container', 'registering', 'training', 'inference', 'master', '.', 'However', ',', 'masters', ',', 'state', 'information', '.', 'For', 'example', ',', 'master', 'training', 'ser-', 'vice', 'records', 'current', 'best', 'hyper-parameter', 'trial', '.', 'The', 'master', 'inference', 'service', 'state', ',', 'action', 'reward', 'reinforce-', 'ment', 'learning', '.', 'Rafiki', 'checkpoints', '(', 'small', ')', 'state', 'information', 'masters', 'fast', 'failure', 'recovery', '.', '7', '.', 'EXPERIMENTAL', 'STUDY', 'In', 'section', 'evaluate', 'scalability', ',', 'efficiency', 'effec-', 'tiveness', 'Rafiki', 'hyper-parameter', 'tuning', 'inference', 'ser-', 'vice', 'optimization', 'respectively', '.', 'The', 'experiments', 'conducted', 'three', 'machines', ',', '3', 'Nvidia', 'GTX', '1080Ti', 'GPUs', ',', '1', 'Intel', 'E5-1650v4', 'CPU', '64GB', 'memory', '.', '7.1', 'Evaluation', 'Hyper-parameter', 'Tuning', 'Task', 'Dataset', 'We', 'test', 'Rafiki', '’', 'distributed', 'hyper-parameter', 'tuning', 'service', 'running', 'tune', 'hyper-parameters', 'deep', 'ConvNets', 'CIFAR-10', 'image', 'classification', '.', 'CIFAR-10', 'popular', 'benchmark', 'dataset', 'RGB', 'images', '10', 'categories', '.', 'Each', 'category', '5000', 'training', 'images', '(', 'including', '1000', 'validation', 'images', ')', '1000', 'test', 'images', '.', 'All', 'images', 'size', '32x32', '.', 'There', 'standard', 'sequence', 'preprocessing', 'steps', 'CIFAR-10', ',', 'subtracts', 'mean', 'divides', 'standard', 'deviation', 'channel', 'computed', 'training', 'images', ',', 'pads', 'image', '4', 'pixels', 'zeros', 'side', 'obtain', '40x40', 'pixel', 'image', ',', 'ran-', 'domly', 'crops', '32x32', 'patch', ',', 'flips', '(', 'horizontal', 'direction', ')', 'image', 'randomly', 'probability', '0.5', '.', '8', '0', '100', '200', 'Trial', 'Index', '20', '40', '60', '80', 'Va', 'lid', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', '0', '100', '200', 'Trial', 'Index', 'With', 'CoStudy', '(', ')', '25', '50', '75', 'Validation', 'Accuracy', '0', '50', '100', 'Nu', 'r', 'f', 'T', 'ria', 'ls', 'Without', 'CoStudyWith', 'CoStudy', '(', 'b', ')', '0', '100', '200', 'Total', 'Training', 'Epochs', '20', '40', '60', '80', 'Va', 'lid', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Wihtout', 'CoStudy', 'With', 'CoStudy', '(', 'c', ')', 'Figure', '8', ':', 'Hyper-parameter', 'tuning', 'based', 'random', 'search', '.', '0', '50', '100', 'Trial', 'Index', '20', '40', '60', '80', 'Va', 'lid', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', '0', '50', '100', 'Trial', 'Index', 'With', 'CoStudy', '(', ')', '25', '50', '75', 'Validation', 'Accuracy', '0', '25', '50', '75', '100', 'Nu', 'r', 'f', 'T', 'ria', 'ls', 'Without', 'CoStudyWith', 'CoStudy', '(', 'b', ')', '0', '50', '100', 'Total', 'Training', 'Epochs', '40', '60', '80', 'Va', 'lid', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', 'Without', 'CoStudy', 'With', 'CoStudy', '(', 'c', ')', 'Figure', '9', ':', 'Hyper-parameter', 'tuning', 'based', 'Bayesian', 'optimization', '.', '7.1.1', 'Tuning', 'Optimization', 'Hyper-parameters', 'We', 'fix', 'ConvNet', 'architecture', 'shown', 'Table', '5', '[', '29', ']', ',', '8', 'convolution', 'layers', '.', 'The', 'hyper-parameters', 'tuned', 'optimization', 'algorithm', ',', 'including', 'momen-', 'tum', ',', 'learning', 'rate', ',', 'weight', 'decay', 'coefficients', ',', 'dropout', 'rates', ',', 'standard', 'deviations', 'Gaussian', 'distribution', 'weight', 'initial-', 'ization', '.', 'We', 'run', 'trial', 'early', 'stopping', ',', 'terminates', 'training', 'validation', 'loss', 'stops', 'decreasing', '.', 'We', 'compare', 'naı̈ve', 'distributed', 'tuning', 'algorithm', ',', 'i.e', '.', 'Study', '(', 'Algorithm', '1', ')', 'collaborative', 'tuning', 'algorithm', '.', 'i.e', '.', 'CoS-', 'tudy', '(', 'Algorithm', '2', ')', 'different', 'TrialAdvisor', 'algorithms', '.', 'Figure', '8', 'shows', 'comparison', 'using', 'random', 'search', '[', '3', ']', 'TrialAdvisor', '.', 'In', 'particular', ',', 'point', 'Figure', '8a', 'stands', 'one', 'trial', '.', 'We', 'see', 'top', 'area', 'CoStudy', 'denser', 'Study', '.', 'In', 'words', ',', 'CoStudy', 'likely', 'get', 'better', 'performance', '.', 'This', 'confirmed', 'Figure', '8b', ',', 'shows', 'CoStudy', 'trials', 'high', 'accuracy', '(', 'i.e', '.', 'accuracy', '>', '50', '%', ')', 'Study', ',', 'fewer', 'trials', 'low', 'accuracy', '(', 'i.e.', ',', 'accuracy≤50', '%', ')', '.', 'Figure', '8c', 'illustrates', 'tuning', 'progress', 'two', 'approaches', ',', 'point', 'line', 'represents', 'best', 'performance', 'among', 'trials', 'conducted', 'far', '.', 'The', 'x-axis', 'total', 'number', 'training', 'epochs8', ',', 'corre-', 'sponds', 'tuning', 'time', '(', '=total', 'number', 'epochs', 'times', 'time', 'per', 'epoch', ')', '.', 'We', 'observe', 'CoStudy', 'faster', 'Study', 'achieves', 'better', 'accuracy', 'Study', '.', 'Notice', 'validation', 'ac-', 'curacy', 'high', '(', '>', '91', '%', ')', '.', 'Therefore', ',', 'small', 'difference', '(', '1', '%', ')', 'indicates', 'significant', 'improvement', '.', 'Figure', '9', 'compares', 'Study', 'CoStudy', 'using', 'Gaussian', 'process', 'based', 'Bayesian', 'Optimization', '(', 'BO', ')', '9', 'TrialAdvisor', '.', 'Comparing', 'Figure', '9a', 'Figure', '8a', ',', 'see', 'points', 'top', 'area', 'BO', 'figures', '.', 'In', 'words', ',', 'BO', 'better', 'random', '8training', 'model', 'scanning', 'dataset', 'called', 'one', 'epoch', '.', '9https', ':', '//github.com/scikit-optimize', 'searchwhich', 'observed', 'papers', '[', '28', ']', '.', 'In', 'Figure', '9a', ',', 'CoStudy', 'points', 'right', 'bottom', 'area', 'CoS-', 'tudy', '.', 'After', 'in-depth', 'inspection', ',', 'found', 'points', 'trials', 'initialized', 'randomly', 'instead', 'pre-trained', 'models', '.', 'For', 'Study', ',', 'always', 'uses', 'random', 'initialization', ',', 'hence', 'BO', 'algo-', 'rithm', 'fixed', 'prior', 'initialization', 'method', '.', 'However', ',', 'CoStuy', ',', 'initialization', 'pre-trained', 'models', 'time', '.', 'These', 'random', 'initialization', 'trials', 'change', 'prior', 'thus', 'get', 'biased', 'estimation', 'Gaussian', 'process', ',', 'leads', 'poor', 'accuracy', '.', 'Since', 'decaying', 'α', 'reduce', 'chance', 'random', 'initialization', ',', 'fewer', 'fewer', 'points', 'right', 'bottom', 'area', '.', 'Overall', ',', 'CoStudy', 'achieves', 'better', 'accuracy', 'shown', 'Figure', '9b', 'Figure', '9c', '.', 'We', 'study', 'scalability', 'Rafiki', 'varying', 'number', 'work-', 'ers', '.', 'Figure', '11', 'compares', '3', 'jobs', 'running', '1', ',', '2', ',', '4', '8', 'GPUs', 'respectively', '.', 'Each', 'point', 'curves', 'figure', 'represents', 'best', 'validation', 'performance', 'among', 'trials', 'tested', 'far', '.', 'The', 'x-axis', 'wall', 'clock', 'time', '.', 'We', 'see', 'GPUs', ',', 'tuning', 'becomes', 'faster', '.', 'It', 'scales', 'almost', 'linearly', '.', '7.2', 'Evaluation', 'Inference', 'Optimization', 'We', 'use', 'image', 'classification', 'application', 'test', 'opti-', 'mization', 'techniques', 'introduced', 'Section', '5', '.', 'The', 'inference', 'models', 'ConvNets', 'trained', 'ImageNet', '[', '15', ']', 'benchmark', 'dataset', '.', 'ImageNet', 'popular', 'image', 'classification', 'benchmark', 'many', 'open-source', 'ConvNets', 'trained', '(', 'Figure', '3', ')', '.', 'It', '1.2', 'million', 'RGB', 'training', 'images', '50,000', 'validation', 'images', '.', 'Our', 'environment', 'simulator', 'randomly', 'samples', 'images', 'validation', 'dataset', 'requests', '.', 'The', 'number', 'requests', 'deter-', 'mined', 'follows', '.', 'First', ',', 'simulate', 'scenario', 'high', 'arriving', 'rate', 'low', 'arriving', 'rate', ',', 'set', 'arriving', 'rate', 'based', 'maximum', 'throughput', 'ru', 'minimum', 'throughput', 'rl', '.', 'Specifically', ',', 'maximum', 'throughput', 'sum', 'models', '’', 'throughput', ',', 'achieved', 'models', 'run', 'asynchronously', '9', '0', '250', '500', '750', '1000', '1250', '1500', 'Time', '(', 'seconds', ')', '0', '100', '200', '300', '400', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'RL', 'Greedy', 'Request', 'Rate', 'Figure', '10', ':', 'Single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', '.', '1', '2', '4', '8', 'Number', 'Workers', '0', '500', '1000', '1500', 'W', 'al', 'l', 'T', 'im', 'e', '(', 'M', 'ut', 'es', ')', '(', ')', '0', '250', '500', '750', '1000', 'Wall', 'Time', '(', 'Minutes', ')', '80', '85', '90', '95', 'Va', 'lid', 'io', 'n', 'Ac', 'cu', 'ra', 'cy', '1', 'Worker', '2', 'Workers', '4', 'Workers', '8', 'Workers', '(', 'b', ')', 'Figure', '11', ':', 'Scalability', 'test', 'distributed', 'hyper-parameter', 'tuning', '.', 'T/2T/4', 'rm', '0.1T', '0.1T', 'Figure', '12', ':', 'Sine', 'function', 'controlling', 'request', 'arriving', 'rate', '.', 'process', 'different', 'batches', 'requests', '.', 'In', 'contrast', ',', 'mod-', 'els', 'run', 'synchronously', ',', 'slowest', 'model', '’', 'throughput', 'minimum', 'throughput', '.', 'Second', ',', 'use', 'sine', 'function', 'extreme', 'throughput', 'values', 'define', 'request', 'arriving', 'rate', ',', 'i.e', '.', 'r', '=', 'γsin', '(', ')', '+', 'b', '.', 'The', 'slope', 'γ', 'intercept', 'b', 'derived', 'solving', 'Equation', '8', '9', ',', 'T', 'cycle', 'period', 'configured', '500', '×', 'τ', 'experiments', '.', 'The', 'first', 'equation', 'make', 'sure', 'requests', 'ru', '(', 'rl', ')', 'generated', '20', '%', 'cycle', 'period', '(', 'Figure', '12', ',', 'T', '×', '20', '%', '=', '0.2T', ')', '.', 'In', 'way', ',', 'simulating', 'real-life', 'environment', 'overwhelming', 'requests', 'coming', 'times', '.', 'The', 'second', 'equa-', 'tion', 'make', 'sure', 'highest', 'arriving', 'rate', 'large', ',', 'otherwise', 'request', 'queue', 'would', 'filled', 'quickly', 'new', 'requests', 'dropped', '.', 'Finally', ',', 'small', 'random', 'noise', 'applied', 'r', 'prevent', 'RL', 'algorithm', 'remembering', 'sine', 'function', '.', 'To', 'conclude', ',', 'number', 'new', 'requests', 'δ', '×', '(', 'γsin', '(', ')', '+', 'b', ')', '×', '(', '1', '+', 'φ', ')', ',', 'φ', '∼', 'N', '(', '0', ',', '0.1', ')', ')', ',', 'δ', 'time', 'span', 'last', 'invocation', 'simulator', 'current', 'time', '.', 'k', '×', 'sin', '(', 'T/2−', '0.2×', '2T/2', ')', '+', 'b', '=', 'ru', 'rl', '(', '8', ')', 'k', '×', 'sin', '(', 'T/2', ')', '+', 'b', '=', '1.1×', 'ru', 'rl', '(', '9', ')', '7.2.1', 'Single', 'Inference', 'Model', 'We', 'use', 'inception', 'v3', 'trained', 'ImageNet', 'single', 'infer-', 'ence', 'model', '.', 'Besides', 'greedy', 'algorithm', '(', 'Algorithm', '3', ')', ',', 'also', 'run', 'RL', 'algorithm', 'Section', '5.2', 'decide', 'batch', 'size', '.', 'The', 'state', 'Section', '5.2', 'except', 'model', 'related', 'status', 'removed', '.', 'The', 'batch', 'size', 'list', 'B', '=', '{', '16', ',', '32', ',', '48', ',', '64', '}', '.', 'The', 'maximum', 'throughput', 'max', 'b/c', '(', 'b', ')', '=', '64/0.23', '=', '272', 'images/second', 'minimum', 'throughput', 'min', 'b/c', '(', 'b', ')', '=', '16/0.07', '=', '228', '.', 'We', 'set', 'τ', '=', 'c', '(', '64', ')', '×', '2', '=', '0.56s', '.', 'Figure', '10', 'compares', 'RL', 'algorithm', 'greedy', 'algorithm', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'ru', '.', 'We', 'see', 'iterations', ',', 'RL', 'performs', 'similarly', 'greedy', 'algorithm', 'request', 'arriving', 'rate', 'r', 'high', '.', 'When', 'r', 'low', ',', 'RL', 'performs', 'better', 'greedy', 'algorithm', '.', 'This', 'requests', 'left', 'queue', 'length', 'equal', 'batch', 'size', 'Line', '7', 'Algorithm', '3', '.', 'These', 'left', 'requests', 'likely', 'overdue', 'new', 'requests', 'coming', 'slowly', 'form', 'new', 'batch', '.', 'Figure', '13', 'compares', 'RL', 'algorithm', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'defined', 'based', 'minimum', 'throughput', 'rl', '.', 'We', 'see', 'RL', 'performs', 'better', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'either', 'high', 'low', '.', 'Overall', ',', 'since', 'arriving', 'rate', 'smaller', 'Figure', '10', ',', 'fewer', 'overdue', 'requests', '.', '7.2.2', 'Multiple', 'Inference', 'Models', 'In', 'following', 'experiments', ',', 'select', 'inception', 'v3', ',', 'inception', 'v4', 'inception', 'resnet', 'v2', 'construct', 'model', 'list', 'M', '.', 'The', 'maxi-', 'mum', 'throughput', 'minimum', 'throughput', '572', 'requests/second', '128', 'requests/second', 'respectively', '.', 'The', 'experimental', 'results', 'plotted', 'Figure', '14', ',', 'Figure', '15', 'Figure', '16', '.', 'The', 'legend', 'text', '‘', 'Overdue', '’', 'represents', 'number', 'overdue', 'requests', 'per', 'sec-', 'ond', ',', '‘', 'Arriving', '’', 'stands', 'request', 'arriving', 'rate', '.', 'We', 'compare', 'RL', 'algorithm', 'two', 'baseline', 'algorithms', 're-', 'spectively', '.', 'For', 'baseline', ',', 'use', 'greedy', 'algorithm', 'find', 'batch', 'size', '.', 'They', 'differ', 'model', 'selection', 'strategy', '.', 'The', 'first', 'baseline', 'runs', 'models', 'synchronously', 'batch', 'requests', '.', 'Correspondingly', ',', 'requests', 'generated', 'using', 'rate', 'based', 'rl', '.', 'From', 'Figure', '14a', 'Figure', '14b', ',', 'see', 'greedy', 'algorithm', 'fixed', 'accuracy', ',', 'whereas', 'RL', 'algorithm', '’', 'ac-', 'curacy', 'high', '(', 'resp', '.', 'low', ')', 'rate', 'low', '(', 'resp', '.', 'high', ')', '.', 'In', '10', '0', '250', '500', '750', '1000', '1250', '1500', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', '250', '300', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'RL', 'Greedy', 'Request', 'Rate', 'Figure', '13', ':', 'Single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', ')', 'Greedy', 'algorithm', '.', '23000', '23500', '24000', 'Time', '(', 'seconds', ')', '0.802', '0.804', '0.806', '0.808', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', 'b', ')', 'RL', 'algorithm', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', 'c', ')', 'Greedy', 'algorithm', '.', '23000', '23500', '24000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', ')', 'RL', 'algorithm', '.', 'Figure', '14', ':', 'Multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0.76', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '100', '200', '300', '400', '500', '600', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', ')', 'Greedy', 'algorithm', '.', '13500', '14000', '14500', 'Time', '(', 'seconds', ')', '0.76', '0.78', '0.80', '0.82', '0.84', 'Ac', 'cu', 'ra', 'cy', '100', '200', '300', '400', '500', '600', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', 'b', ')', 'RL', 'algorithm', '.', '0', '500', '1000', 'Time', '(', 'seconds', ')', '0', '200', '400', '600', '800', '1000', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', 'c', ')', 'Greedy', 'algorithm', '.', '13500', '14000', '14500', 'Time', '(', 'seconds', ')', '0', '200', '400', '600', '800', '1000', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', ')', 'RL', 'algorithm', '.', 'Figure', '15', ':', 'Multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0.800', '0.805', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', ')', 'β', '=', '0', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0.795', '0.800', '0.805', '0.810', 'Ac', 'cu', 'ra', 'cy', '25', '50', '75', '100', '125', '150', 'Re', 'qu', 'es', 'ts', '/s', 'ec', '(', 'b', ')', 'β', '=', '1', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', 'c', ')', 'β', '=', '0', '.', '0', '2000', '4000', '6000', 'Time', '(', 'seconds', ')', '0', '50', '100', '150', '200', 'Re', 'qu', 'es', 'ts', '/s', 'ec', 'Overdue', 'Arriving', '(', ')', 'β', '=', '1', '.', 'Figure', '16', ':', 'Comparison', 'effect', 'different', 'β', 'RL', 'algorithm', '.', 'fact', ',', 'synchronous', 'algorithm', 'always', 'uses', 'models', 'en-', 'semble', 'modelling', ',', 'whereas', 'RL', 'algorithm', 'uses', 'fewer', 'models', 'ensemble', 'modeling', 'arriving', 'rate', 'high', '.', 'Since', 'request', 'arriving', 'rate', 'low', ',', 'baseline', 'able', 'handle', 'al-', 'requests', '.', 'Similar', 'Figure', '13', ',', 'overdue', 'requests', 'Figure', '14c', 'due', 'mismatch', 'queue', 'size', 'batch', 'size', 'Algorithm', '3', '.', 'The', 'second', 'baseline', 'runs', 'models', 'asynchronously', ',', 'one', 'model', 'per', 'batch', 'requests', '.', 'In', 'words', ',', 'ensemble', 'mod-', 'eling', '.', 'Correspondingly', ',', 'requests', 'generated', 'using', 'rate', 'based', 'ru', '.', 'We', 'see', 'RL', 'better', 'accuracy', '(', 'Figure', '15a', '15b', ')', 'fewer', 'overdue', 'requests', '(', 'Figure', '15c', '15d', ')', '11', 'baseline', '.', 'Moreover', ',', 'adaptive', 'request', 'arriving', 'rate', '.', 'When', 'rate', 'high', ',', 'uses', 'fewer', 'models', 'serve', 'batch', 'im-', 'prove', 'throughput', 'reduce', 'overdue', 'requests', '.', 'When', 'rate', 'low', ',', 'uses', 'models', 'serve', 'batch', 'improve', 'accuracy', '.', 'We', 'also', 'compare', 'effect', 'different', 'β', ',', 'namely', 'β', '=', '0', 'β', '=', '1', 'reward', 'function', ',', 'i.e', '.', 'Equation', '7', '.', 'Figure', '16', 'shows', 'results', 'requests', 'generated', 'based', 'rl', '.', 'We', 'see', 'β', 'smaller', ',', 'accuracy', '(', 'Figure', '16a', ')', 'higher', '.', 'This', 'reward', 'function', 'focus', 'accuracy', 'part', '.', 'Con-', 'sequently', ',', 'many', 'overdue', 'requests', 'shown', 'Figure', '16c', '.', 'In', 'contrast', ',', 'β', '=', '1', ',', 'reward', 'function', 'tries', 'avoid', 'overdue', 'requests', 'reducing', 'number', 'models', 'ensemble', '.', 'There-', 'fore', ',', 'accuracy', 'number', 'overdue', 'requests', 'smaller', '(', 'Figure', '16b', 'Figure', '16d', ')', '.', '8', '.', 'CASE', 'STUDY', 'ON', 'USABILITY', 'curl', '-i', '-F=', '@', 'image.jpg', 'http', ':', '//', '<', 'ip', 'rafiki', '>', ':', '<', 'app', 'port', '>', '/api', 'CREATE', 'TABLE', 'foodlog', '(', 'user_id', 'integer', ',', 'age', 'integer', 'NOT', 'NULL', ',', 'location', 'text', 'NOT', 'NULL', ',', 'time', 'text', 'NOT', 'NULL', ',', 'image_path', 'text', 'NOT', 'NULL', ',', 'PRIMARY', 'KEY', '(', 'user_id', ',', 'time', ')', ')', ';', 'SELECT', 'UDF_FOOD_NAME', '(', 'image_path', ')', 'food_name', ',', 'count', '(', '*', ')', 'FROM', 'foodlog', 'WHERE', 'age', '>', '30', 'GROUP', 'BY', 'food_name', ';', 'Figure', '17', ':', 'SQL', 'table', 'creation', '.', 'In', 'section', ',', 'detail', 'Rafiki', 'help', 'database', 'expert', 'use', 'deep', 'learning', 'services', 'easily', 'existing', 'application', '.', 'We', 'present', 'scenario', 'analyzing', 'food', 'preference', 'users', 'food', 'logging', 'application', 'shown', 'Figure', '2', '.', 'This', 'application', 'keeps', 'log', 'food', 'user', 'eats', 'storing', 'time', ',', 'loca-', 'tion', 'photo', 'meal', '.', 'For', 'simplicity', ',', 'assume', 'data', 'stored', 'one', 'table', 'created', 'Figure', '17', '.', 'Each', 'row', 'table', 'contains', 'information', 'meal', '.', 'The', 'image', 'path', 'file', 'path', 'image', '.', 'This', 'image', 'contains', 'picture', 'food', ',', 'however', 'direct', 'way', 'query', 'information', '(', 'e.g.', ',', 'name', ')', 'food', 'image', '.', 'Using', 'Rafiki', ',', 'database', 'developer', 'collaborates', 'deep', 'learning', 'expert', 'develops', 'trains', 'image', 'recog-', 'nition', 'model', 'food', 'images', '.', 'This', 'trained', 'model', 'shared', 'Rafiki', 'provides', 'recognition', 'services', 'database', 'users', 'black', 'box', 'via', 'Web', 'APIs', '.', 'Figure', '18', 'displays', 'web', 'interface', 'Rafiki', '.', 'Figure', '18', ':', 'Rafiki', 'web', 'interface', '.', 'Deep', 'Learning', 'Expert', 'The', 'deep', 'learning', 'expert', 'prepares', 'training', '(', 'train.py', ')', 'serving', '(', 'serve.py', ')', 'scripts', 'deep', 'learning', 'model', '[', '10', ']', 'using', 'Apache', 'SINGA', '10', '.', '10http', ':', '//singa.apache.org/', 'Database', 'User', 'After', 'uploading', 'training', 'dataset', ',', 'i.e', '.', 'set', 'food', 'image', 'label', 'pairs', ',', 'Rafiki', ',', 'database', 'user', 'starts', 'training', 'job', '.', 'Once', 'training', 'finished', ',', 'user', 'deploys', 'trained', 'model', 'serving', 'job', '.', 'Afterwards', ',', 'exploits', 'deep', 'learning', 'service', 'get', 'food', 'name', 'sending', 'request', 'Rafiki', 'via', 'user-defined', 'function', '(', 'UDF', ')', '.', 'The', 'food', 'name', '(', ')', 'function', 'calls', 'Web', 'API', 'serving', 'application', 'Rafiki', '.', 'In', 'particular', ',', 'function', 'executed', 'images', 'rows', 'sat-', 'isfy', 'condition', '(', 'age', 'greater', '30', ')', '.', 'Consequently', ',', 'saves', 'much', 'time', '.', 'Batch', 'processing', 'supported', 'Rafiki', 'side', 'im-', 'prove', 'efficiency', '.', 'Furthermore', ',', 'model', 'modified', 're-trained', 'Rafiki', ',', 'change', 'SQL', 'query', 'database', 'user', '’', 'side', '.', 'curl', '-i', '-F=', '@', 'image.jpg', 'http', ':', '//', '<', 'ip', 'rafiki', '>', ':', '<', 'app', 'port', '>', '/api', 'CREATE', 'TABLE', 'foodlog', '(', 'user_id', 'integer', ',', 'age', 'integer', 'NOT', 'NULL', ',', 'location', 'text', 'NOT', 'NULL', ',', 'time', 'text', 'NOT', 'NULL', ',', 'image_path', 'text', 'NOT', 'NULL', ',', 'PRIMARY', 'KEY', '(', 'user_id', ',', 'time', ')', ')', ';', 'SELECT', 'UDF_FOOD_NAME', '(', 'image_path', ')', 'food_name', ',', 'count', '(', '*', ')', 'FROM', 'foodlog', 'WHERE', 'age', '>', '30', 'GROUP', 'BY', 'food_name', ';', 'select', 'food_name', '(', 'image_path', ')', 'name', ',', 'count', '(', '*', ')', 'foodlog', 'age', '>', '52', 'group', 'name', ';', 'This', 'service', 'also', 'serve', 'requests', 'mobile', 'Apps', 'demon-', 'strated', 'Figure', '2', '.', 'We', 'created', 'food', 'logging', 'App', 'sends', 'requests', 'Rafiki', 'food', 'image', 'prediction', '.', '9', '.', 'CONCLUSIONS', 'Complex', 'analytics', 'become', 'inherent', 'expected', 'func-', 'tionality', 'supported', 'big', 'data', 'systems', '.', 'However', ',', 'widely', 'recognized', 'machine', 'learning', 'models', 'easy', 'build', 'train', ',', 'sensitive', 'data', 'distributions', 'characteris-', 'tics', '.', 'It', 'therefore', 'important', 'reduce', 'pain', 'points', 'imple-', 'menting', 'tuning', 'dataset', 'specific', 'models', ',', 'step', 'towards', 'making', 'AI', 'usable', '.', 'In', 'paper', ',', 'present', 'Rafiki', 'provide', 'training', 'inference', 'service', 'machine', 'learning', 'models', ',', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', '.', 'Rafiki', 'supports', 'effective', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', ',', 'online', 'ensemble', 'modeling', 'inference', 'service', 'amenable', 'trade', 'latency', 'accu-', 'racy', '.', 'The', 'system', 'evaluated', 'various', 'benchmarks', 'illustrate', 'efficiency', ',', 'effectiveness', 'scalability', '.', 'We', 'also', 'conducted', 'case', 'study', 'demonstrates', 'system', 'enables', 'database', 'developer', 'use', 'deep', 'learning', 'services', 'easily', '.', '10', '.', 'REFERENCES', '[', '1', ']', 'Providing', 'database', 'service', '.', 'In', 'Proceedings', '18th', 'International', 'Conference', 'Data', 'Engineering', ',', 'ICDE', '’', '02', ',', 'pages', '29–', ',', 'Washington', ',', 'DC', ',', 'USA', ',', '2002', '.', 'IEEE', 'Computer', 'Society', '.', '[', '2', ']', 'M.', 'Abadi', ',', 'P.', 'Barham', ',', 'J.', 'Chen', ',', 'Z.', 'Chen', ',', 'A.', 'Davis', ',', 'J', '.', 'Dean', ',', 'M.', 'Devin', ',', 'S.', 'Ghemawat', ',', 'G.', 'Irving', ',', 'M.', 'Isard', ',', 'M.', 'Kudlur', ',', 'J.', 'Levenberg', ',', 'R.', 'Monga', ',', 'S.', 'Moore', ',', 'D.', 'G.', 'Murray', ',', 'B.', 'Steiner', ',', 'P.', 'Tucker', ',', 'V.', 'Vasudevan', ',', 'P.', 'Warden', ',', 'M.', 'Wicke', ',', 'Y.', 'Yu', ',', 'X.', 'Zheng', '.', 'Tensorflow', ':', 'A', 'system', 'large-scale', 'machine', 'learning', '.', 'In', '12th', 'USENIX', 'Symposium', 'Operating', 'Systems', 'Design', 'Implementation', '(', 'OSDI', '16', ')', ',', 'pages', '265–283', ',', 'GA', ',', '2016', '.', 'USENIX', 'Association', '.', '[', '3', ']', 'J.', 'Bergstra', 'Y.', 'Bengio', '.', 'Random', 'search', 'hyper-parameter', 'optimization', '.', 'J.', 'Mach', '.', 'Learn', '.', 'Res.', ',', '13:281–305', ',', 'Feb.', '2012', '.', '[', '4', ']', 'R.', 'Collobert', ',', 'J.', 'Weston', ',', 'L.', 'Bottou', ',', 'M.', 'Karlen', ',', 'K.', 'Kavukcuoglu', ',', 'P.', 'P.', 'Kuksa', '.', 'Natural', 'language', 'processing', '(', 'almost', ')', 'scratch', '.', 'CoRR', ',', 'abs/1103.0398', ',', '2011', '.', '12', '[', '5', ']', 'D.', 'Crankshaw', ',', 'X.', 'Wang', ',', 'G.', 'Zhou', ',', 'M.', 'J.', 'Franklin', ',', 'J.', 'E.', 'Gonzalez', ',', 'I.', 'Stoica', '.', 'Clipper', ':', 'A', 'low-latency', 'online', 'prediction', 'serving', 'system', '.', 'In', '14th', 'USENIX', 'Symposium', 'Networked', 'Systems', 'Design', 'Implementation', '(', 'NSDI', '17', ')', ',', 'pages', '613–627', ',', 'Boston', ',', 'MA', ',', '2017', '.', 'USENIX', 'Association', '.', '[', '6', ']', 'C.', 'Curino', ',', 'E.', 'Philip', 'Charles', 'Jones', ',', 'R.', 'Popa', ',', 'N.', 'Malviya', ',', 'E.', 'Wu', ',', 'S.', 'Madden', ',', 'H.', 'Balakrishnan', ',', 'N.', 'Zeldovich', '.', 'Relational', 'cloud', ':', 'A', 'database-as-a-service', 'cloud', ',', '04', '2011', '.', '[', '7', ']', 'J.', 'Deng', ',', 'W.', 'Dong', ',', 'R.', 'Socher', ',', 'L.-J', '.', 'Li', ',', 'K.', 'Li', ',', 'L.', 'Fei-Fei', '.', 'ImageNet', ':', 'A', 'Large-Scale', 'Hierarchical', 'Image', 'Database', '.', 'In', 'CVPR09', ',', '2009', '.', '[', '8', ']', 'T.', 'Devries', 'G.', 'W.', 'Taylor', '.', 'Improved', 'regularization', 'convolutional', 'neural', 'networks', 'cutout', '.', 'CoRR', ',', 'abs/1708.04552', ',', '2017', '.', '[', '9', ']', 'D.', 'Golovin', ',', 'B.', 'Solnik', ',', 'S.', 'Moitra', ',', 'G.', 'Kochanski', ',', 'J.', 'E.', 'Karro', ',', 'D.', 'Sculley', ',', 'editors', '.', 'Google', 'Vizier', ':', 'A', 'Service', 'Black-Box', 'Optimization', ',', '2017', '.', '[', '10', ']', 'K.', 'He', ',', 'X.', 'Zhang', ',', 'S.', 'Ren', ',', 'J', '.', 'Sun', '.', 'Deep', 'residual', 'learning', 'image', 'recognition', '.', 'CoRR', ',', 'abs/1512.03385', ',', '2015', '.', '[', '11', ']', 'G.', 'E.', 'Hinton', ',', 'S.', 'Osindero', ',', 'Y.-W.', 'Teh', '.', 'A', 'fast', 'learning', 'algorithm', 'deep', 'belief', 'nets', '.', 'Neural', 'Comput.', ',', '18', '(', '7', ')', ':1527–1554', ',', 'July', '2006', '.', '[', '12', ']', 'A.', 'G.', 'Howard', ',', 'M.', 'Zhu', ',', 'B.', 'Chen', ',', 'D.', 'Kalenichenko', ',', 'W.', 'Wang', ',', 'T.', 'Weyand', ',', 'M.', 'Andreetto', ',', 'H.', 'Adam', '.', 'Mobilenets', ':', 'Efficient', 'convolutional', 'neural', 'networks', 'mobile', 'vision', 'applications', '.', 'CoRR', ',', 'abs/1704.04861', ',', '2017', '.', '[', '13', ']', 'F.', 'N.', 'Iandola', ',', 'M.', 'W.', 'Moskewicz', ',', 'K.', 'Ashraf', ',', 'S.', 'Han', ',', 'W.', 'J.', 'Dally', ',', 'K.', 'Keutzer', '.', 'Squeezenet', ':', 'Alexnet-level', 'accuracy', '50x', 'fewer', 'parameters', '<', '1mb', 'model', 'size', '.', 'CoRR', ',', 'abs/1602.07360', ',', '2016', '.', '[', '14', ']', 'D.', 'Kang', ',', 'J.', 'Emmons', ',', 'F.', 'Abuzaid', ',', 'P.', 'Bailis', ',', 'M.', 'Zaharia', '.', 'Noscope', ':', 'Optimizing', 'neural', 'network', 'queries', 'video', 'scale', '.', 'Proc', '.', 'VLDB', 'Endow.', ',', '10', '(', '11', ')', ':1586–1597', ',', 'Aug.', '2017', '.', '[', '15', ']', 'A.', 'Krizhevsky', ',', 'I.', 'Sutskever', ',', 'G.', 'E.', 'Hinton', '.', 'Imagenet', 'classification', 'deep', 'convolutional', 'neural', 'networks', '.', 'In', 'NIPS', ',', 'pages', '1106–1114', ',', '2012', '.', '[', '16', ']', 'L.', 'I.', 'Kuncheva', 'C.', 'J.', 'Whitaker', '.', 'Measures', 'diversity', 'classifier', 'ensembles', 'relationship', 'ensemble', 'accuracy', '.', 'Mach', '.', 'Learn.', ',', '51', '(', '2', ')', ':181–207', ',', 'May', '2003', '.', '[', '17', ']', 'Y.', 'LeCun', ',', 'Y.', 'Bengio', ',', 'G.', 'Hinton', '.', 'Deep', 'learning', '.', 'Nature', ',', '521', '(', '7553', ')', ':436–444', ',', '2015', '.', '[', '18', ']', 'T.', 'Li', ',', 'J.', 'Zhong', ',', 'J.', 'Liu', ',', 'W.', 'Wu', ',', 'C.', 'Zhang', '.', 'Ease.ml', ':', 'Towards', 'multi-tenant', 'resource', 'sharing', 'machine', 'learning', 'workloads', '.', 'arXiv:1708.07308', ',', '2017', '.', '[', '19', ']', 'Y.', 'Li', '.', 'Deep', 'reinforcement', 'learning', ':', 'An', 'overview', '.', 'CoRR', ',', 'abs/1701.07274', ',', '2017', '.', '[', '20', ']', 'V.', 'Mnih', ',', 'A.', 'Puigdomènech', 'Badia', ',', 'M.', 'Mirza', ',', 'A.', 'Graves', ',', 'T.', 'P.', 'Lillicrap', ',', 'T.', 'Harley', ',', 'D.', 'Silver', ',', 'K.', 'Kavukcuoglu', '.', 'Asynchronous', 'Methods', 'Deep', 'Reinforcement', 'Learning', '.', 'ArXiv', 'e-prints', ',', 'Feb.', '2016', '.', '[', '21', ']', 'A.', 'N.', 'Modi', ',', 'C.', 'Y.', 'Koo', ',', 'C.', 'Y.', 'Foo', ',', 'C.', 'Mewald', ',', 'D.', 'M.', 'Baylor', ',', 'E.', 'Breck', ',', 'H.-T.', 'Cheng', ',', 'J.', 'Wilkiewicz', ',', 'L.', 'Koc', ',', 'L.', 'Lew', ',', 'M.', 'A.', 'Zinkevich', ',', 'M.', 'Wicke', ',', 'M.', 'Ispir', ',', 'N.', 'Polyzotis', ',', 'N.', 'Fiedel', ',', 'S.', 'E.', 'Haykal', ',', 'S.', 'Whang', ',', 'S.', 'Roy', ',', 'S.', 'Ramesh', ',', 'V.', 'Jain', ',', 'X.', 'Zhang', ',', 'Z.', 'Haque', '.', 'Tfx', ':', 'A', 'tensorflow-based', 'production-scale', 'machine', 'learning', 'platform', '.', 'In', 'KDD', '2017', ',', '2017', '.', '[', '22', ']', 'B.', 'C.', 'Ooi', ',', 'K.', 'Tan', ',', 'S.', 'Wang', ',', 'W.', 'Wang', ',', 'Q.', 'Cai', ',', 'G.', 'Chen', ',', 'J.', 'Gao', ',', 'Z.', 'Luo', ',', 'A.', 'K.', 'H.', 'Tung', ',', 'Y.', 'Wang', ',', 'Z.', 'Xie', ',', 'M.', 'Zhang', ',', 'K.', 'Zheng', '.', 'SINGA', ':', 'A', 'distributed', 'deep', 'learning', 'platform', '.', 'In', 'ACM', 'Multimedia', ',', 'pages', '685–688', ',', '2015', '.', '[', '23', ']', 'C.', 'Ré', ',', 'D.', 'Agrawal', ',', 'M.', 'Balazinska', ',', 'M.', 'I.', 'Cafarella', ',', 'M.', 'I.', 'Jordan', ',', 'T.', 'Kraska', ',', 'R.', 'Ramakrishnan', '.', 'Machine', 'learning', 'databases', ':', 'The', 'sound', 'things', 'come', 'cacophony', 'hype', '?', 'In', 'SIGMOD', ',', 'pages', '283–284', ',', '2015', '.', '[', '24', ']', 'J.', 'Schulman', ',', 'F.', 'Wolski', ',', 'P.', 'Dhariwal', ',', 'A.', 'Radford', ',', 'O.', 'Klimov', '.', 'Proximal', 'policy', 'optimization', 'algorithms', '.', 'CoRR', ',', 'abs/1707.06347', ',', '2017', '.', '[', '25', ']', 'D.', 'Sculley', ',', 'G.', 'Holt', ',', 'D.', 'Golovin', ',', 'E.', 'Davydov', ',', 'T.', 'Phillips', ',', 'D.', 'Ebner', ',', 'V.', 'Chaudhary', ',', 'M.', 'Young', '.', 'Machine', 'learning', ':', 'The', 'high', 'interest', 'credit', 'card', 'technical', 'debt', '.', 'In', 'SE4ML', ':', 'Software', 'Engineering', 'Machine', 'Learning', '(', 'NIPS', '2014', 'Workshop', ')', ',', '2014', '.', '[', '26', ']', 'B.', 'Shahriari', ',', 'K.', 'Swersky', ',', 'Z.', 'Wang', ',', 'R.', 'P.', 'Adams', ',', 'N.', 'de', 'Freitas', '.', 'Taking', 'human', 'loop', ':', 'A', 'review', 'bayesian', 'optimization', '.', 'Proceedings', 'IEEE', ',', '104', '(', '1', ')', ':148–175', ',', 'Jan', '2016', '.', '[', '27', ']', 'K.', 'Simonyan', 'A.', 'Zisserman', '.', 'Very', 'deep', 'convolutional', 'networks', 'large-scale', 'image', 'recognition', '.', 'CoRR', ',', 'abs/1409.1556', ',', '2014', '.', '[', '28', ']', 'J.', 'Snoek', ',', 'H.', 'Larochelle', ',', 'R.', 'P.', 'Adams', '.', 'Practical', 'Bayesian', 'Optimization', 'Machine', 'Learning', 'Algorithms', '.', 'ArXiv', 'e-prints', ',', 'June', '2012', '.', '[', '29', ']', 'J.', 'Snoek', ',', 'O.', 'Rippel', ',', 'K.', 'Swersky', ',', 'R.', 'Kiros', ',', 'N.', 'Satish', ',', 'N.', 'Sundaram', ',', 'M.', 'M.', 'A.', 'Patwary', ',', 'Prabhat', ',', 'R.', 'P.', 'Adams', '.', 'Scalable', 'Bayesian', 'Optimization', 'Using', 'Deep', 'Neural', 'Networks', '.', 'ArXiv', 'e-prints', ',', 'Feb.', '2015', '.', '[', '30', ']', 'I.', 'Sutskever', ',', 'J.', 'Martens', ',', 'G.', 'Dahl', ',', 'G.', 'Hinton', '.', 'On', 'importance', 'initialization', 'momentum', 'deep', 'learning', '.', 'In', 'Proceedings', '30th', 'International', 'Conference', 'International', 'Conference', 'Machine', 'Learning', '-', 'Volume', '28', ',', 'ICML', '’', '13', ',', 'pages', 'III–1139–III–1147', '.', 'JMLR.org', ',', '2013', '.', '[', '31', ']', 'R.', 'S.', 'Sutton', 'A.', 'G.', 'Barto', '.', 'Introduction', 'Reinforcement', 'Learning', '.', 'MIT', 'Press', ',', 'Cambridge', ',', 'MA', ',', 'USA', ',', '1st', 'edition', ',', '1998', '.', '[', '32', ']', 'C.', 'Szegedy', ',', 'W.', 'Liu', ',', 'Y.', 'Jia', ',', 'P.', 'Sermanet', ',', 'S.', 'Reed', ',', 'D.', 'Anguelov', ',', 'D.', 'Erhan', ',', 'V.', 'Vanhoucke', ',', 'A.', 'Rabinovich', '.', 'Going', 'deeper', 'convolutions', '.', 'CoRR', ',', 'abs/1409.4842', ',', '2014', '.', '[', '33', ']', 'W.', 'Wang', ',', 'G.', 'Chen', ',', 'H.', 'Chen', ',', 'T.', 'T.', 'A.', 'Dinh', ',', 'J.', 'Gao', ',', 'B.', 'C.', 'Ooi', ',', 'K.-L.', 'Tan', ',', 'S.', 'Wang', '.', 'Deep', 'learning', 'scale', 'ease', '.', 'Transactions', 'Multimedia', 'Computing', 'Communications', 'Applications', ',', '12', '(', '4s', ')', ',', '2016', '.', '[', '34', ']', 'W.', 'Wang', ',', 'G.', 'Chen', ',', 'T.', 'T.', 'A.', 'Dinh', ',', 'J.', 'Gao', ',', 'B.', 'C.', 'Ooi', ',', 'K.', 'Tan', ',', 'S.', 'Wang', '.', 'SINGA', ':', 'putting', 'deep', 'learning', 'hands', 'multimedia', 'users', '.', 'In', 'ACM', 'Multimedia', ',', 'pages', '25–34', ',', '2015', '.', '[', '35', ']', 'W.', 'Wang', ',', 'X.', 'Yang', ',', 'B.', 'C.', 'Ooi', ',', 'D.', 'Zhang', ',', 'Y.', 'Zhuang', '.', 'Effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', '.', 'The', 'VLDB', 'Journal', ',', 'pages', '1–23', ',', '2015', '.', '[', '36', ']', 'W.', 'Wang', ',', 'M.', 'Zhang', ',', 'G.', 'Chen', ',', 'H.', 'Jagadish', ',', 'B.', 'C.', 'Ooi', ',', 'K.-L.', 'Tan', '.', 'Database', 'meets', 'deep', 'learning', ':', 'Challenges', 'opportunities', '.', 'ACM', 'SIGMOD', 'Record', ',', '45', '(', '2', ')', ':17–22', ',', '2016', '.', '[', '37', ']', 'H.', 'Zhang', ',', 'L.', 'Zeng', ',', 'W.', 'Wu', ',', 'C.', 'Zhang', '.', 'How', 'good', 'machine', 'learning', 'clouds', 'binary', 'classification', 'good', 'features', '?', 'CoRR', ',', 'abs/1707.09562', ',', '2017', '.', '[', '38', ']', 'B.', 'Zoph', 'Q.', 'V.', 'Le', '.', 'Neural', 'architecture', 'search', 'reinforcement', 'learning', '.', 'CoRR', ',', 'abs/1611.01578', ',', '2016', '.', '13']
['Rafiki', 'Machine', 'Learning', 'Analytics', 'Service', 'System', 'Wei', 'Wang†', 'Sheng', 'Wang†', 'Jinyang', 'Gao†', 'Meihui', 'Zhang�', 'Gang', 'Chen‡', 'Teck', 'Khim', 'Ng†', 'Beng', 'Chin', 'Ooi†', '†National', 'University', 'Singapore', '�Beijing', 'Institute', 'Technology', '‡Zhejiang', 'University', 'wangwei', 'jinyang.gao', 'wangsh', 'ngtk', 'ooibc', 'comp.nus.edu.sg', '�meihui', 'zhang', 'bit.edu.cn', 'zju.edu.cn', 'ABSTRACT', 'Big', 'data', 'analytics', 'gaining', 'massive', 'momentum', 'last', 'years', 'Applying', 'machine', 'learning', 'models', 'big', 'data', 'become', 'implicit', 'requirement', 'expectation', 'analysis', 'tasks', 'especially', 'high-stakes', 'applications.Typical', 'applications', 'include', 'sentiment', 'analysis', 'reviews', 'analyzing', 'on-line', 'products', 'image', 'classification', 'food', 'logging', 'applications', 'monitoring', 'user', 'daily', 'intake', 'stock', 'movement', 'prediction', 'Extending', 'tra-', 'ditional', 'database', 'systems', 'support', 'analysis', 'intriguing', 'challenging', 'First', 'almost', 'impossible', 'implement', 'ma-', 'chine', 'learning', 'models', 'database', 'engines', 'Second', 'expertise', 'knowledge', 'required', 'optimize', 'training', 'inference', 'proce-', 'dures', 'terms', 'efficiency', 'effectiveness', 'imposes', 'heavy', 'burden', 'system', 'users', 'paper', 'develop', 'present', 'system', 'called', 'Rafiki', 'provide', 'training', 'inference', 'ser-', 'vice', 'machine', 'learning', 'models', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', 'Rafiki', 'provides', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensem-', 'ble', 'modeling', 'inference', 'service', 'trades', 'latency', 'accuracy', 'Experimental', 'results', 'confirm', 'efficiency', 'effectiveness', 'scalability', 'usability', 'Rafiki', 'INTRODUCTION', 'Data', 'analysis', 'plays', 'important', 'role', 'extracting', 'valuable', 'in-', 'sights', 'huge', 'amount', 'data', 'Database', 'systems', 'traditionally', 'used', 'storing', 'analyzing', 'structured', 'data', 'spatial-', 'temporal', 'data', 'graph', 'data', 'etc', 'Other', 'data', 'multimedia', 'data', 'e.g.', 'images', 'free', 'text', 'domain', 'specific', 'data', 'e.g', 'medical', 'data', 'sensor', 'data', 'generated', 'fast', 'speed', 'con-', 'stitutes', 'significant', 'portion', 'Big', 'Data', 'beneficial', 'analyze', 'data', 'database', 'applications', 'For', 'instance', 'inferring', 'quality', 'product', 'review', 'column', 'sales', 'database', 'would', 'help', 'explain', 'sales', 'numbers', 'Analyz-', 'ing', 'food', 'images', 'food', 'logging', 'application', 'extract', 'food', 'preference', 'people', 'different', 'ages', 'However', 'analysis', 'requires', 'machine', 'learning', 'models', 'especially', 'deep', 'learn-', 'ing', 'models', 'sentiment', 'analysis', 'classify', 'review', 'positive', 'negative', 'image', 'classification', 'recognize', 'food', 'type', 'images', 'Figure', 'shows', 'pipeline', 'data', 'analysis', 'database', 'systems', 'widely', 'used', 'first', 'stages', 'machine', 'learning', 'good', '4th', 'stage', 'Big', 'Data', '大数据', '3Vs', 'Volume', 'Velocity', 'Variety', '高容量，速度快，多样性', 'Variety', 'implies', 'integrating', 'analyzing', 'data', 'necessary', 'develop', 'end-to-end', 'solutions', 'scale', 'easy', 'use', 'minimize', 'human', 'effort', 'Acquisition', 'Extraction/', 'Cleaning/', 'Annotation', 'Integration', 'Analysis/', 'Modeling', 'Interpretation/', 'Visualization', 'Figure', 'Data', 'analytic', 'pipeline', 'One', 'approach', 'integrating', 'machine', 'learning', 'techniques', 'database', 'applications', 'preprocess', 'data', 'off-line', 'add', 'prediction', 'results', 'new', 'column', 'e.g', 'column', 'food', 'type', 'However', 'off-line', 'preprocessing', 'two-folds', 'restric-', 'tion', 'First', 'requires', 'developers', 'expertise', 'knowledge', 'experience', 'training', 'machine', 'learning', 'models', 'Second', 'queries', 'involve', 'attributes', 'object', 'e.g', 'ingredients', 'food', 'predicted', 'preprocessing', 'step', 'addi-', 'tion', 'would', 'waste', 'lot', 'time', 'prediction', 'rows', 'queries', 'read', 'food', 'type', 'column', 'rows', 'e.g', 'due', 'filtering', 'columns', 'Another', 'approach', 'carry', 'pre-', 'diction', 'on-line', 'user-defined', 'functions', 'UDFs', 'SQL', 'query', 'However', 'challenging', 'implement', 'machine', 'learning', 'mod-', 'els', 'UDFs', 'database', 'users', 'machine', 'learning', 'models', 'vary', 'lot', 'terms', 'theory', 'implementation', 'also', 'difficult', 'optimize', 'prediction', 'accuracy', 'database', 'engine', 'better', 'solution', 'call', 'corresponding', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', 'APIs', 'UDFs', 'prediction', 'analysis', 'task', 'Cloud', 'service', 'economical', 'elastic', 'easy', 'use', 'With', 'resurgence', 'cloud', 'providers', 'like', 'Amazon', 'AWS', 'Google', 'Microsoft', 'Azure', 'built', 'machine', 'learning', 'services', 'cloud', 'platforms', 'There', 'two', 'types', 'cloud', 'services', 'The', 'first', 'one', 'provide', 'API', 'specific', 'task', 'e.g', 'image', 'classifi-', 'cation', 'sentiment', 'analysis', 'Such', 'APIs', 'available', 'Amazon', 'AWS1', 'Google', 'cloud', 'platform2', 'The', 'disadvantage', 'accuracy', 'could', 'low', 'since', 'models', 'trained', 'Amazon', 'Google', 'data', 'likely', 'different', 'users', 'data', 'The', 'second', 'type', 'service', 'overcomes', 'issue', 'providing', 'training', 'service', 'users', 'upload', 'datasets', 'conduct', 'training', 'This', 'service', 'available', 'Amazon', 'AWS', 'Microsoft', 'Azure', 'However', 'limited', 'number', 'ma-', 'chine', 'learning', 'models', 'supported', 'For', 'example', 'sim-', '1https', '//aws.amazon.com/machine-learning/', '2https', '//cloud.google.com/products/machine-learning/', 'ple', 'logistic', 'regression', 'linear', 'regression', 'models3', 'supported', 'Amazon', 'Deep', 'learning', 'models', 'convolutional', 'neural', 'networks', 'ConvNets', 'recurrent', 'neural', 'networks', 'RNN', 'included', 'machine', 'learning', 'cloud', 'service', 'needs', 'cover', 'wide', 'range', 'models', 'including', 'deep', 'learning', 'models', 'also', 'provide', 'easy-to-use', 'efficient', 'effective', 'service', 'users', 'with-', 'much', 'machine', 'learning', 'knowledge', 'experience', 'e.g', 'database', 'users', 'Considering', 'different', 'models', 'may', 'result', 'different', 'performance', 'terms', 'efficiency', 'e.g', 'latency', 'effectiveness', 'e.g', 'accuracy', 'cloud', 'service', 'select', 'proper', 'models', 'given', 'task', 'Moreover', 'machine', 'learning', 'models', 'training', 'algorithms', 'come', 'set', 'hyper-parameters', 'knobs', 'e.g', 'number', 'layers', 'size', 'layer', 'neural', 'network', 'Some', 'hyper-parameters', 'vital', 'convergence', 'training', 'algorithm', 'final', 'model', 'performance', 'e.g', 'learning', 'rate', 'stochastic', 'gradient', 'descent', 'SGD', 'algorithm', 'Manual', 'hyper-', 'parameter', 'tuning', 'requires', 'rich', 'experience', 'tedious', 'Random', 'search', 'Bayesian', 'optimization', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approaches', 'However', 'costly', 'train', 'model', 'till', 'convergence', 'may', 'take', 'hundreds', 'hours', 'dis-', 'tributed', 'tuning', 'platform', 'desirable', 'Besides', 'training', 'inference4', 'also', 'matters', 'directly', 'affects', 'user', 'experience', 'Machine', 'learning', 'products', 'often', 'ensemble', 'multiple', 'models', 'average', 'results', 'boost', 'prediction', 'performance', 'However', 'ensemble', 'modeling', 'incurs', 'larger', 'latency', 'i.e', 'response', 'time', 'compared', 'using', 'single', 'prediction', 'model', 'Therefore', 'trade-off', 'be-', 'tween', 'accuracy', 'latency', 'There', 'studies', 'challenges', 'providing', 'ma-', 'chine', 'learning', 'service', 'mlbench', 'compares', 'cloud', 'ser-', 'vice', 'Amazon', 'Azure', 'set', 'binary', 'classification', 'tasks', 'Ease.ml', 'builds', 'training', 'platform', 'model', 'selection', 'aim-', 'ing', 'optimizing', 'resource', 'utilization', 'Google', 'Vizier', 'distributed', 'hyper-parameter', 'tuning', 'platform', 'provides', 'tuning', 'service', 'systems', 'Clipper', 'focuses', 'inference', 'proposing', 'general', 'framework', 'specific', 'optimization', 'effi-', 'ciency', 'accuracy', 'paper', 'present', 'system', 'called', 'Rafiki', 'provide', 'training', 'inference', 'services', 'machine', 'learning', 'mod-', 'els', 'With', 'Rafiki', 'database', 'users', 'exempted', 'managing', 'hardware', 'resource', 'constructing', 'deep', 'learning', 'models', 'tun-', 'ing', 'hyper-parameters', 'optimizing', 'prediction', 'accuracy', 'speed', 'Instead', 'simply', 'upload', 'datasets', 'configure', 'service', 'conduct', 'training', 'deploy', 'model', 'infer-', 'ence', 'cloud', 'service', 'system', 'Rafiki', 'manages', 'hard-', 'ware', 'resources', 'failure', 'recovery', 'etc', 'comes', 'set', 'built-in', 'deep', 'learning', 'models', 'popular', 'tasks', 'image', 'text', 'processing', 'addition', 'make', 'following', 'contributions', 'make', 'Rafiki', 'easy-to-use', 'efficient', 'effective', 'propose', 'unified', 'system', 'architecture', 'train-', 'ing', 'inference', 'services', 'observe', 'two', 'ser-', 'vices', 'share', 'common', 'components', 'parameter', 'server', 'model', 'parameter', 'storage', 'distributed', 'comput-', 'ing', 'environment', 'distributed', 'hyper-parameter', 'tuning', 'parallel', 'inference', 'sharing', 'underlying', 'storage', 'communication', 'protocols', 'computation', 'resource', 'im-', 'plicitly', 'avoid', 'technical', 'debts', 'Moreover', 'com-', '3https', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4We', 'use', 'term', 'deployment', 'inference', 'serving', 'interchange-', 'ably', 'bining', 'two', 'services', 'together', 'Rafiki', 'enables', 'instant', 'model', 'deployment', 'training', 'For', 'training', 'service', 'first', 'propose', 'general', 'frame-', 'work', 'distributed', 'hyper-parameter', 'tuning', 'ex-', 'tensible', 'popular', 'hyper-parameter', 'tuning', 'algorithms', 'in-', 'cluding', 'random', 'search', 'Bayesian', 'optimization', 'addi-', 'tion', 'propose', 'collaborative', 'tuning', 'scheme', 'specifically', 'deep', 'learning', 'models', 'uses', 'model', 'parameters', 'current', 'top', 'performing', 'training', 'trials', 'initialize', 'new', 'trials', 'For', 'inference', 'service', 'propose', 'scheduling', 'algorithm', 'based', 'reinforcement', 'learning', 'optimize', 'overall', 'ac-', 'curacy', 'reduce', 'latency', 'Both', 'algorithms', 'adaptive', 'changes', 'request', 'arrival', 'rate', 'conduct', 'micro-benchmark', 'experiments', 'evaluate', 'performance', 'proposed', 'algorithms', 'reminder', 'paper', 'give', 'system', 'architecture', 'Section', 'Section', 'describes', 'training', 'service', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'algorithm', 'The', 'deployment', 'ser-', 'vice', 'optimization', 'techniques', 'introduced', 'Section', 'Sec-', 'tion', 'describes', 'system', 'implementation', 'explain', 'ex-', 'perimental', 'study', 'Section', 'introduce', 'related', 'works', 'Section', 'RELATED', 'WORK', 'Rafiki', 'SaaS', 'provides', 'analytics', 'services', 'based', 'ma-', 'chine', 'learning', 'Optimization', 'techniques', 'proposed', 'training', 'i.e', 'distributed', 'hyper-parameter', 'tuning', 'inference', 'stage', 'i.e', 'accuracy', 'latency', 'optimization', 'section', 'review', 'related', 'work', 'SaaS', 'hyper-parameter', 'tuning', 'inference', 'op-', 'timization', 'reinforcement', 'learning', 'adopted', 'Rafiki', 'inference', 'optimization', '2.1', 'Software', 'Service', 'Cloud', 'computing', 'changed', 'way', 'operation', 'many', 'companies', 'providing', 'infrastructure', 'service', 'IaaS', 'platform', 'service', 'PaaS', 'software', 'service', 'SaaS', 'With', 'IaaS', 'users', 'companies', 'use', 'remote', 'physical', 'virtual', 'machines', 'instead', 'establishing', 'data', 'center', 'Based', 'user', 'require-', 'ments', 'IaaS', 'scale', 'compute', 'resources', 'quickly', 'PaaS', 'e.g.', 'Microsoft', 'Azure', 'provides', 'development', 'toolkit', 'running', 'envi-', 'ronment', 'adjusted', 'automatically', 'based', 'business', 'demand', 'SaaS', 'including', 'database', 'service', 'installs', 'soft-', 'ware', 'cloud', 'computing', 'platforms', 'provides', 'application', 'ser-', 'vices', 'simplifies', 'software', 'maintenance', 'The', 'pay', 'pricing', 'model', 'convenient', 'economic', 'small', 'companies', 'research', 'labs', 'Recently', 'machine', 'learning', 'especially', 'deep', 'learning', 'gain', 'lot', 'interest', 'due', 'outstanding', 'performance', 'analytic', 'predictive', 'tasks', 'There', 'two', 'primary', 'steps', 'apply', 'machine', 'learning', 'application', 'namely', 'training', 'inference', 'Cloud', 'providers', 'like', 'Amazon', 'AWS', 'Microsoft', 'Azure', 'Google', 'Cloud', 'already', 'included', 'services', 'two', 'steps', 'However', 'training', 'services', 'limited', 'support', 'deep', 'learning', 'mod-', 'els', 'inference', 'services', 'customized', 'customers', 'data', 'see', 'explanation', 'Section', 'There', 'also', 'research', 'papers', 'towards', 'efficient', 'resource', 'allocation', 'training', 'efficient', 'inference', 'cloud', 'Rafiki', 'differs', 'exist-', 'ing', 'cloud', 'services', 'service', 'types', 'optimization', 'techniques', 'Firstly', 'Rafiki', 'allows', 'users', 'train', 'machine', 'learning', 'including', 'deep', 'learning', 'models', 'data', 'de-', 'ploy', 'inference', 'Secondly', 'Rafiki', 'special', 'optimization', 'training', 'inference', 'service', 'compared', 'existing', 'approaches', 'explained', 'following', 'two', 'subsections', '2.2', 'Hyper-parameter', 'Tuning', 'train', 'machine', 'learning', 'model', 'application', 'need', 'decide', 'many', 'hyper-parameters', 'related', 'model', 'structure', 'opti-', 'mization', 'algorithm', 'data', 'preprocessing', 'operations', 'All', 'hyper-', 'parameter', 'tuning', 'algorithms', 'work', 'empirical', 'trials', 'Random', 'search', 'randomly', 'selects', 'value', 'hyper-parameter', 'try', 'shown', 'efficient', 'grid', 'search', 'enumerates', 'possible', 'hyper-parameter', 'combinations', 'Bayesian', 'optimization', 'assumes', 'optimization', 'function', 'hyper-parameters', 'input', 'inference', 'performance', 'output', 'follows', 'Gaussian', 'process', 'samples', 'next', 'point', 'hyper-parameter', 'space', 'based', 'existing', 'trials', 'according', 'acquisition', 'function', 'Reinforcement', 'learning', 'recently', 'applied', 'tune', 'archi-', 'tecture', 'related', 'hyper-parameters', 'Google', 'Vizier', 'provides', 'hyper-parameter', 'tuning', 'service', 'cloud', 'Rafiki', 'provides', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'service', 'compatible', 'mentioned', 'hyper-parameter', 'tuning', 'algorithms', 'ad-', 'dition', 'supports', 'collaborative', 'tuning', 'shares', 'model', 'parame-', 'ters', 'across', 'trials', 'Our', 'experiments', 'confirm', 'effectiveness', 'collaborative', 'tuning', 'scheme', '2.3', 'Inference', 'Optimization', 'improve', 'inference', 'accuracy', 'ensemble', 'modeling', 'trains', 'deploys', 'multiple', 'models', 'widely', 'applied', 'For', 'real-time', 'in-', 'ference', 'latency', 'another', 'critical', 'metric', 'inference', 'service', 'NoScope', 'proposes', 'specific', 'inference', 'optimization', 'video', 'querying', 'Clipper', 'studies', 'multiple', 'optimization', 'techniques', 'improve', 'throughput', 'via', 'batch', 'size', 'reduce', 'latency', 'via', 'caching', 'also', 'proposes', 'model', 'selection', 'ensemble', 'mod-', 'eling', 'using', 'multi-armed', 'bandit', 'algorithms', 'Compared', 'Clip-', 'per', 'Rafiki', 'provides', 'training', 'inference', 'services', 'whereas', 'Clipper', 'focuses', 'inference', 'service', 'Also', 'Clipper', 'op-', 'timizes', 'throughput', 'latency', 'accuracy', 'separately', 'whereas', 'Rafiki', 'models', 'together', 'find', 'optimal', 'model', 'selection', 'batch', 'size', 'TensorFlow', 'serving', 'TFX', 'provide', 'inference', 'service', 'models', 'trained', 'using', 'Tensorflow', 'Rafiki', 'Clipper', 'implementation', 'agnostic', 'They', 'communicate', 'training', 'inference', 'programs', 'Docker', 'containers', 'via', 'RPC', '2.4', 'Reinforcement', 'Learning', 'reinforcement', 'learning', 'time', 'agent', 'takes', 'one', 'action', 'enters', 'next', 'state', 'The', 'environment', 'returns', 'reward', 'based', 'action', 'states', 'The', 'learning', 'objective', 'maximize', 'aggregated', 'rewards', 'algorithms', 'decide', 'ac-', 'tion', 'take', 'based', 'current', 'state', 'experience', 'gained', 'previous', 'trials', 'exploration', 'Policy', 'gradient', 'based', 'algorithms', 'maximize', 'expected', 'reward', 'taking', 'actions', 'following', 'policy', 'function', 'at|st', 'steps', 'Equation', 'represents', 'trajectory', 'action', 'state', 'reward', 'tuples', 'decaying', 'factor', 'The', 'expectation', 'taken', 'possible', 'trajec-', 'tories', 'usually', 'implemented', 'using', 'multi-layer', 'perceptron', 'model', 'represents', 'parameters', 'takes', 'state', 'vector', 'input', 'generates', 'action', 'scalar', 'value', 'continuous', 'action', 'Softmax', 'output', 'discrete', 'actions', 'Equation', 'optimized', 'using', 'stochastic', 'gradient', 'ascent', 'methods', 'Equation', 'used', 'surrogate', 'function', 'objective', 'gradient', 'easy', 'com-', 'pute', 'via', 'automatic', 'differentiation', 'Eς∼πθ', 't=0', 'γtRt', 'OθJ', 'Eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtRt', 'Eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtRt', 'Many', 'approaches', 'proposed', 'improve', 'policy', 'gra-', 'dient', 'reducing', 'variance', 'rewards', 'including', 'actor-critic', 'model', 'subtracts', 'reward', 'baseline', 'estimation', 'reward', 'also', 'approximated', 'using', 'neural', 'network', 'like', 'policy', 'function', 'Then', 'equations', 'becomesRt−V', 'Yuxi', 'done', 'survey', 'deep', 'reinforcement', 'learning', 'including', 'actor-critic', 'model', 'used', 'paper', 'SYSTEM', 'OVERVIEW', 'section', 'present', 'system', 'architecture', 'Rafiki', 'illustrate', 'usability', 'use', 'cases', 'use', 'Rafiki', 'users', 'simply', 'configure', 'training', 'inference', 'jobs', 'either', 'RESTFul', 'APIs', 'Python', 'SDK', 'Figure', 'left', 'column', 'show', 'one', 'image', 'classification', 'example', 'using', 'Python', 'SDK', 'The', 'training', 'code', 'consists', 'lines', 'The', 'first', 'line', 'loads', 'images', 'folder', 'Rafiki', 'distributed', 'data', 'stor-', 'age', 'HDFS', 'images', 'subfolder', 'labeled', 'subfolder', 'name', 'i.e', 'food', 'name', 'The', 'second', 'line', 'creates', 'configuration', 'object', 'representing', 'hyper-parameter', 'tuning', 'options', 'see', 'Section', '4.2', 'details', 'The', 'third', 'line', 'creates', 'training', 'job', 'passing', 'data', 'options', 'input/output', 'shapes', 'tuple', 'list', 'tuples', 'The', 'input-output', 'shapes', 'used', 'model', 'cus-', 'tomization', 'For', 'example', 'ConvNets', 'usually', 'accept', 'input', 'images', 'fixed', 'shape', 'i.e', 'input', 'shape', 'adapt', 'final', 'output', 'layer', 'generate', 'number', 'outputs', 'output', 'shape', 'could', 'total', 'number', 'classes', 'bounding-box', 'shape', 'The', 'last', 'line', 'submits', 'job', 'RESTFul', 'APIs', 'Rafiki', 'exe-', 'cution', 'returns', 'job', 'handle', 'job', 'monitoring', 'Once', 'training', 'finishes', 'deploy', 'models', 'instantly', 'shown', 'infer.py', 'gets', 'model', 'instances', 'consists', 'model', 'name', 'parameter', 'names', 'retrieving', 'parameter', 'values', 'Rafiki', 'parameter', 'server', 'uses', 'second', 'line', 'create', 'inference', 'job', 'given', 'models', 'After', 'model', 'deployed', 'line', 'application', 'users', 'submit', 'requests', 'job', 'prediction', 'shown', 'code', 'query.py', 'Ap-', 'plications', 'like', 'mobile', 'App', 'send', 'RESTFul', 'requests', 'query', 'For', 'training', 'job', 'Rafiki', 'selects', 'corresponding', 'built-in', 'models', 'based', 'task', 'type', 'The', 'table', 'Figure', 'lists', 'built-in', 'tasks', 'models', 'With', 'proliferation', 'machine', 'learning', 'able', 'find', 'open', 'source', 'implementations', 'al-', 'every', 'model', 'Figure', 'compares', 'memory', 'footprint', 'ac-', 'curacy', 'inference', 'speed', 'open', 'source', 'ConvNets5', 'Groups', 'ConvNets', 'compared', 'including', 'Inception', 'ConvNets', 'MobileNet', 'NASNets', 'ResNets', 'VGGs', 'The', 'accuracy', 'measured', 'based', 'top-1', 'prediction', 'images', 'validation', 'dataset', 'ImageNet', 'The', 'inference', 'time', 'mem-', 'ory', 'footprint', 'averaged', 'iterations', 'images', 'i.e', 'batch', 'size=50', '5https', '//github.com/tensorflow/models/tree/master/research/slim/', 'Data', 'Hyper-tune', 'Hyper-tune', 'Ensemble', 'modelling', 'ResNet', 'Parameter', 'Task', 'Models', 'Image', 'classification', 'VGG', 'ResNet', 'Squeezenet', 'XceptionNet', 'InceptionNet', 'Object', 'detection', 'YOLO', 'SSD', 'FasterRCNN', 'Sentiment', 'analysis', 'TemporalCNN', 'FastText', 'CharacterRNN', 'ResNet', 'ResNetVGG', 'VGG', 'VGG', 'Master', 'Worker', 'Rafiki', 'user', 'code', 'Rafiki', 'Application', 'user', 'code', 'train.py', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.HyperConf', 'job', 'rafiki.Train', "name='train", 'data=data', 'task=', 'ImageClassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'infer.py', 'models', 'rafiki.get_models', 'job_id', 'job', 'rafiki.Inference', 'models', 'job_id', 'job.run', 'img', 'Image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'ret', 'label', 'Figure', 'Overview', 'Rafiki', '0.2', '0.4', '0.6', '0.8', '1.0', 'Time', 'Each', 'Iteration', '0.70', '0.75', '0.80', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'Figure', 'Accuracy', 'inference', 'time', 'memory', 'footprint', 'popular', 'ConvNets', 'Hyper-parameter', 'tuning', 'See', 'Section', '4.2', 'conducted', 'every', 'selected', 'model', 'For', 'example', 'two', 'sets', 'hyper-parameters', 'be-', 'ing', 'tested', 'ResNet', 'resp', 'VGG', 'shown', 'Figure', 'The', 'trained', 'model', 'parameters', 'stored', 'global', 'parameter', 'server', 'persistent', 'distributed', 'in-memory', 'storage', 'Once', 'training', 'done', 'inference', 'workers', 'fetch', 'parame-', 'ters', 'efficiently', 'The', 'inference', 'job', 'launches', 'models', 'passed', 'user', 'configuration', 'Ensemble', 'modeling', 'See', 'section', 'applied', 'optimize', 'inference', 'accuracy', 'requests', 'application', 'e.g', 'database', 'users', 'Rafiki', 'compatible', 'machine', 'learning', 'framework', 'in-', 'cluding', 'TensorFlow', 'Scikit-learn', 'Kears', 'etc.', 'although', 'built', 'top', 'Apache', 'Singa', 'due', 'efficiency', 'scalable', 'architecture', 'More', 'details', 'Rafiki', 'implementation', 'described', 'Section', 'TRAINING', 'SERVICE', 'The', 'training', 'service', 'consists', 'two', 'steps', 'namely', 'model', 'selec-', 'tion', 'hyper-parameter', 'tuning', 'adopt', 'simple', 'model', 'selec-', 'tion', 'strategy', 'Rafiki', 'For', 'hyper-parameter', 'tuning', 'first', 'pro-', 'pose', 'general', 'programming', 'model', 'distributed', 'tuning', 'propose', 'collaborative', 'tuning', 'scheme', '4.1', 'Model', 'Selection', 'Every', 'built-in', 'model', 'Rafiki', 'registered', 'task', 'e.g', 'im-', 'age', 'classification', 'sentiment', 'analysis', 'Each', 'model', 'associated', 'meta', 'data', 'including', 'training', 'cost', 'e.g', 'speed', 'memory', 'consumption', 'performance', 'dataset', 'e.g', 'accuracy', 'area-under-curve', 'Ease.ml', 'proposes', 'convert', 'model', 'selection', 'multi-armed', 'bandit', 'problem', 'ev-', 'ery', 'model', 'i.e', 'arm', 'gets', 'chance', 'training', 'After', 'many', 'trials', 'chance', 'under-performed', 'models', 'would', 'decreased', 'observe', 'models', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', 'For', 'example', 'ResNet', 'better', 'AlexNet', 'SqueezeNet', 'bunch', 'datasets', 'including', 'Ima-', 'geNet', 'CIFAR-106', 'etc..', 'Therefore', 'adopt', 'simple', 'model', 'selection', 'strategy', 'without', 'advanced', 'analysis', 'select', 'models', 'similar', 'performance', 'different', 'architectures', 'This', 'create', 'diverse', 'model', 'set', 'whose', 'performance', 'would', 'boosted', 'applying', 'ensemble', 'modeling', '4.2', 'Distributed', 'Hyper-parameter', 'Tuning', 'Hyper-parameter', 'tuning', 'usually', 'run', 'many', 'different', 'sets', 'hyper-parameters', 'Distributed', 'tuning', 'running', 'instances', 'parallel', 'natural', 'solution', 'reducing', 'tuning', 'time', 'There', '6https', '//www.cs.toronto.edu/', 'kriz/cifar.html', 'Table', 'Hyper-parameter', 'groups', 'Group', 'Hyper-parameter', 'Example', 'Domain', 'Data', 'preprocessing', 'Image', 'rotation', '0,30', 'Image', 'cropping', '0,32', 'Whitening', 'PCA', 'ZCA', 'Model', 'architecture', 'Number', 'layers', 'cluster', 'Kernel', 'Linear', 'RBF', 'Poly', 'Training', 'algorithm', 'Learning', 'rate', 'Weight', 'decay', 'Momentum', 'three', 'popular', 'approaches', 'hyper-parameter', 'tuning', 'namely', 'grid', 'search', 'random', 'search', 'Bayesian', 'optimization', 'support', 'algorithms', 'need', 'general', 'extensible', 'pro-', 'gramming', 'model', '4.2.1', 'Programming', 'Model', 'cluster', 'hyper-parameters', 'involved', 'training', 'machine', 'learning', 'model', 'three', 'groups', 'shown', 'Table', 'Data', 'prepro-', 'cessing', 'adopts', 'different', 'approaches', 'normalize', 'data', 'augment', 'dataset', 'extract', 'features', 'raw', 'data', 'i.e', 'feature', 'en-', 'gineering', 'Most', 'machine', 'learning', 'models', 'tuning', 'knobs', 'form', 'architecture', 'hyper-parameters', 'e.g', 'number', 'trees', 'random', 'forest', 'number', 'layers', 'ConvNets', 'kernel', 'function', 'SVM', 'The', 'optimization', 'algorithms', 'especially', 'gradient', 'based', 'optimization', 'algorithms', 'like', 'SGD', 'many', 'hyper-parameters', 'including', 'initial', 'learning', 'rate', 'decaying', 'rate', 'decaying', 'method', 'linear', 'exponential', 'etc', 'From', 'Table', 'see', 'hyper-parameters', 'could', 'come', 'range', 'list', 'numbers', 'categories', 'All', 'possible', 'as-', 'signments', 'hyper-parameters', 'construct', 'hyper-parameter', 'space', 'denoted', 'Following', 'convention', 'call', 'one', 'point', 'space', 'trial', 'denoted', 'Rafiki', 'provides', 'Hyper-', 'Space', 'class', 'functions', 'shown', 'Figure', 'developers', 'specify', 'hyper-parameter', 'space', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.HyperConf', 'job', 'rafiki.Train', "name='train", 'data=data', 'task=', 'ImageClassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'models', 'rafiki.get_models', 'job_id', 'job', 'rafiki.Inference', 'models', 'job_id', 'job.run', 'img', 'Image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'class', 'HyperSpace', 'def', 'add_range_knob', 'name', 'dtype', 'min', 'max', 'depends=None', 'pre_hook=None', 'post_hook=None', 'def', 'add_categorical_knob', 'name', 'dtype', 'list', 'depends=None', 'pre_hook=None', 'post_hook=None', 'Figure', 'HyperSpace', 'APIs', 'The', 'first', 'function', 'defines', 'domain', 'hyper-parameter', 'range', 'min', 'max', 'dtype', 'represents', 'data', 'type', 'could', 'float', 'integer', 'string', 'depends', 'list', 'hyper-parameters', 'whose', 'values', 'directly', 'affect', 'generation', 'hyper-parameter', 'For', 'example', 'initial', 'learning', 'rate', 'large', 'would', 'prefer', 'larger', 'decay', 'rate', 'decease', 'learning', 'rate', 'quickly', 'There-', 'fore', 'decay', 'rate', 'generated', 'generating', 'learn-', 'ing', 'rate', 'enforce', 'relation', 'add', 'learning', 'rate', 'depends', 'list', 'add', 'post', 'hook', 'function', 'adjust', 'value', 'learning', 'rate', 'decay', 'The', 'second', 'function', 'defines', 'categori-', 'cal', 'hyper-parameter', 'list', 'represents', 'candidates', 'depends', 'pre', 'hook', 'post', 'hook', 'analogous', 'range', 'knob', 'The', 'whole', 'hyper-parameter', 'tuning', 'process', 'one', 'model', 'dataset', 'called', 'study', 'The', 'performance', 'trial', 'de-', 'noted', 'larger', 'indicates', 'better', 'performance', 'e.g', 'ac-', 'curacy', 'For', 'distributed', 'hyper-parameter', 'tuning', 'master', 'multiple', 'workers', 'study', 'The', 'master', 'generates', 'trials', 'workers', 'workers', 'evaluate', 'trials', 'one', 'time', 'worker', 'trains', 'model', 'given', 'trial', 'The', 'workflow', 'study', 'master', 'side', 'explained', 'Algorithm', 'The', 'master', 'iter-', 'ates', 'event', 'loop', 'collect', 'performance', 'trial', 'i.e', 'generates', 'next', 'trial', 'TrialAdvisor', 'im-', 'plements', 'hyper-parameter', 'search', 'algorithm', 'e.g', 'random', 'search', 'Bayesian', 'optimization', 'stops', 'trials', 'test', 'user', 'configured', 'stop', 'criteria', 'satisfied', 'e.g', 'total', 'num-', 'ber', 'trials', 'Finally', 'best', 'parameters', 'put', 'parameter', 'server', 'inference', 'service', 'The', 'worker', 'side', 'keeps', 'requesting', 'trials', 'master', 'conducting', 'training', 'reporting', 'results', 'master', 'Algorithm', 'Study', 'HyperTune', 'conf', 'TrialAdvisor', 'adv', 'num', 'conf.stop', 'num', 'msg', 'ReceiveMsg', 'msg.type', 'kRequest', 'trial', 'adv.next', 'msg.worker', 'trial', 'nil', 'break', 'else', 'send', 'msg.worker', 'trial', 'end', 'else', 'msg.type', 'kReport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'else', 'msg.type', 'kFinish', 'num', 'adv.is', 'best', 'msg.worker', 'send', 'msg.worker', 'kPut', 'end', 'end', 'end', 'return', 'adv.best', 'trial', '4.2.2', 'Collaborative', 'Tuning', 'section', 'introduced', 'distributed', 'hyper-', 'parameter', 'tuning', 'framework', 'Next', 'extend', 'framework', 'proposing', 'collaborative', 'tuning', 'scheme', 'SGD', 'widely', 'used', 'training', 'machine', 'learning', 'models', 'often', 'observe', 'training', 'loss', 'stays', 'plateau', 'drops', 'suddenly', 'decrease', 'learning', 'rate', 'SGD', 'e.g', '0.1', '0.01', '0.01', '0.001', 'Based', 'observation', 'see', 'hyper-parameters', 'changed', 'training', 'get', 'plateau', 'de-', 'rive', 'better', 'performance', 'Therefore', 'fix', 'model', 'architec-', 'ture', 'tune', 'hyper-parameters', 'group', 'Table', 'model', 'parameters', 'trained', 'using', 'one', 'hyper-parameter', 'trial', 'reused', 'initialize', 'model', 'another', 'trial', 'selecting', 'parameters', 'top', 'performing', 'trials', 'continue', 'hyper-parameter', 'tuning', 'old', 'trials', 'like', 'pre-', 'training', 'fact', 'good', 'model', 'initialization', 'results', 'faster', 'convergence', 'better', 'performance', 'Users', 'typically', 'fine-tune', 'popular', 'ConvNet', 'architectures', 'datasets', 'Conse-', 'quently', 'collaborative', 'tuning', 'scheme', 'likely', 'converge', 'good', 'state', 'straightforward', 'tune', 'hyper-parameters', 'related', 'model', 'architecture', 'This', 'architecture', 'changes', 'parameters', 'also', 'change', 'For', 'example', 'parameters', 'convolution', 'layer', 'filter', 'size', '3x3', 'used', 'initialize', 'convolution', 'layer', 'another', 'ConvNet', 'whose', 'filter', 'size', '5x5', 'However', 'architecture', 'tuning', 'many', 'architectures', 'available', 'likely', 'architectures', 'share', 'config-', 'urations', 'one', 'convolution', 'layer', 'For', 'instance', 'ConvNet', '3rd', 'convolution', 'layer', 'ConvNet', '3rd', 'layer', 'convo-', 'lution', 'setting', 'use', 'parametersW', 'ConvNet', '3rd', 'layer', 'initialize', 'ConvNet', '3rd', 'layer', 'store', 'allW', 'parameter', 'server', 'fetch', 'shape', 'matched', 'initialize', 'layers', 'new', 'trials', 'ConvNets', 'performance', 'new', 'trail', 'better', 'older', 'one', 'overwrite', 'parameter', 'server', 'new', 'values', '0.1', '0.01', '0.1', '0.01', '0.1', 'Figure', 'collaborative', 'tuning', 'example', 'The', 'whole', 'process', 'illustrated', 'Figure', 'workers', 'running', 'trials', 'tune', 'hyper-parameters', 'e.g', 'learning', 'rate', 'model', 'After', 'performance', 'worker', 'stops', 'increasing', 'The', 'training', 'stops', 'automatically', 'according', 'early', 'stopping', 'criteria', 'e.g', 'training', 'loss', 'decreasing', 'consecutive', 'epochs', 'Early', 'stopping', 'widely', 'used', 'training', 'machine', 'learning', 'models7', 'The', 'new', 'trial', 'worker', 'uses', 'pa-', 'rameters', 'current', 'best', 'worker', 'The', 'work', 'done', 'serves', 'pre-training', 'new', 'trial', 'Similarly', 'enters', 'plateau', 'master', 'instructs', 'start', 'new', 'trial', 'using', 'parameters', 'whose', 'model', 'best', 'performance', 'point', 'time', 'The', 'control', 'flow', 'collaborative', 'tuning', 'scheme', 'described', 'Algorithm', 'similar', 'Algorithm', 'except', 'master', 'instructs', 'worker', 'save', 'model', 'parameters', 'global', 'pa-', 'rameter', 'server', 'Line', 'model', 'performance', 'significantly', 'larger', 'current', 'best', 'performance', 'Line', 'The', 'performance', 'difference', 'i.e', 'conf.delta', 'configuration', 'parameter', 'Hyper-', 'Conf', 'set', 'according', 'user', 'expectation', 'performance', 'model', 'For', 'example', 'MNIST', 'image', 'classi-', 'fication', 'improvement', '0.1', 'large', 'current', 'best', 'performance', 'For', 'CIFAR-10', 'image', 'classification', 'may', 'set', 'delta', '0.5', 'best', 'accuracy', '97.4', 'means', 'bigger', 'improvement', 'space', 'notice', 'bad', 'parameter', 'initialization', 'degrades', 'perfor-', 'mance', 'experiments', 'This', 'serious', 'random', 'search', 'Because', 'checkpoint', 'one', 'trial', 'poor', 'accuracy', 'would', 'affect', 'next', 'trials', 'model', 'parameters', 'initialized', 'poor', 'state', 'resolve', 'problem', 'α-greedy', 'strategy', 'intro-', 'duced', 'implementation', 'initializes', 'model', 'param-', 'eters', 'either', 'random', 'initialization', 'pre-trained', 'model', 'checkpoint', 'file', 'threshold', 'represents', 'probability', 'choos-', 'ing', 'random', 'initialization', '1-α', 'represents', 'probability', 'us-', 'ing', 'pre-trained', 'checkpoint', 'files', 'decreases', 'gradually', 'decrease', 'chance', 'random', 'initialization', 'i.e', 'increasing', 'chance', 'CoStudy', 'This', 'α-greedy', 'strategy', 'widely', 'used', 'reinforcement', 'learning', 'balance', 'exploration', 'exploitation', 'INFERENCE', 'SERVICE', '7https', '//keras.io/callbacks/', 'earlystopping', 'Algorithm', 'CoStudy', 'HyperTune', 'conf', 'TrialAdvisor', 'adv', 'num', 'best', 'conf.stop', 'num', 'msg', 'ReceiveMsg', 'msg.type', 'kRequest', '...', 'Algorithm', 'else', 'msg.type', 'kReport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'msg.p', 'best', 'conf.delta', 'send', 'msg.worker', 'kPut', 'best', 'msg.p', 'else', 'adv.early', 'stopping', 'msg.worker', 'conf', 'send', 'msg.worker', 'kStop', 'end', 'else', 'msg.type', 'kFinish', 'num', 'end', 'end', 'return', 'adv.best', 'trial', 'Inference', 'service', 'provides', 'real-time', 'request', 'serving', 'deploy-', 'ing', 'trained', 'model', 'Other', 'services', 'like', 'database', 'services', 'sim-', 'ply', 'optimize', 'throughput', 'constraint', 'latency', 'set', 'manually', 'service', 'level', 'objective', 'SLO', 'denoted', 'e.g', '0.1', 'seconds', 'For', 'machine', 'learning', 'services', 'accuracy', 'becomes', 'important', 'optimization', 'objective', 'The', 'accuracy', 'refers', 'wide', 'range', 'performance', 'measurements', 'e.g', 'negative', 'error', 'precision', 'recall', 'area', 'curve', 'etc', 'larger', 'value', 'accuracy', 'indicates', 'better', 'performance', 'set', 'latency', 'hard', 'constraint', 'shown', 'Equation', 'overdue', 'requests', 'would', 'get', 'time', 'responses', 'Typically', 'delayed', 'response', 'better', 'error', 'time', 'end-users', 'Hence', 'process', 'requests', 'queue', 'se-', 'quentially', 'following', 'FIFO', 'first-in-first-out', 'The', 'objective', 'maximize', 'accuracy', 'minimize', 'exceeding', 'time', 'accord-', 'ing', 'However', 'typically', 'trade-off', 'accuracy', 'latency', 'For', 'example', 'ensemble', 'modeling', 'models', 'increases', 'accuracy', 'latency', 'shall', 'optimize', 'model', 'selection', 'ensemble', 'modeling', 'Section', '5.2', 'Before', 'discuss', 'simpler', 'case', 'single', 'inference', 'model', 'Table', 'summarizes', 'notations', 'used', 'section', 'maxAccuracy', 'subject', '5.1', 'Single', 'Inference', 'Model', 'When', 'one', 'single', 'model', 'deployed', 'application', 'accuracy', 'inference', 'service', 'fixed', 'system', 'per-', 'spective', 'Therefore', 'optimization', 'objective', 'reduced', 'mini-', 'mizing', 'exceeding', 'time', 'formalized', 'Equation', 'min', 's∈Smax', '|S|', 'The', 'latency', 'request', 'includes', 'waiting', 'time', 'queue', 'inference', 'time', 'depends', 'model', 'complexity', 'hardware', 'efficiency', 'i.e', 'FLOPS', 'batch', 'size', 'The', 'batch', 'size', 'decides', 'number', 'requests', 'processed', 'to-', 'gether', 'Modern', 'processing', 'units', 'like', 'CPU', 'GPU', 'exploit', 'data', 'parallelism', 'techniques', 'e.g', 'SIMD', 'improve', 'throughput', 'reduce', 'computation', 'cost', 'Hence', 'large', 'batch', 'size', 'necessary', 'Table', 'Notations', 'Name', 'Definition', 'request', 'list', 'model', 'list', 'latency', 'requirement', 'one', 'batch', 'size', 'candidate', 'list', 'k−th', 'oldest', 'requests', 'queue', 'oldest', 'requests', 'latest', '|Q|', 'requests', 'inference', 'time', 'batch', 'size', 'inference', 'time', 'model', 'batch', 'size', 'waiting', 'time', 'request', 'queue', 'latency', 'waiting', 'inference', 'time', 'request', 'balancing', 'factor', 'accuracy', 'latency', 'binary', 'vector', 'model', 'selection', 'reward', 'function', 'set', 'requests', 'saturate', 'parallelism', 'capacity', 'Once', 'model', 'deployed', 'cloud', 'platform', 'model', 'complexity', 'hardware', 'efficiency', 'fixed', 'Therefore', 'Rafiki', 'tunes', 'batch', 'size', 'optimize', 'latency', 'construct', 'large', 'batch', 'e.g', 'requests', 'delay', 'processing', 'requests', 'arrive', 'may', 'incur', 'large', 'latency', 'old', 'requests', 'request', 'arrival', 'rate', 'low', 'The', 'op-', 'timal', 'batch', 'size', 'thus', 'influenced', 'SLO', 'queue', 'status', 'e.g', 'waiting', 'time', 'request', 'arrival', 'rate', 'varies', 'along', 'time', 'Since', 'inference', 'time', 'two', 'similar', 'batch', 'sizes', 'varies', 'lit-', 'tle', 'e.g', 'b=8', 'b=9', 'candidate', 'batch', 'size', 'list', 'include', 'values', 'significant', 'difference', 'w.r.t', 'in-', 'ference', 'time', 'e.g', '...', 'The', 'largest', 'batch', 'size', 'determined', 'system', 'GPU', 'memory', 'latency', 'processing', 'batch', 'requests', 'determined', 'hard-', 'ware', 'resource', 'e.g', 'GPU', 'memory', 'model', 'complexity', 'Figure', 'shows', 'inference', 'time', 'memory', 'footprint', 'accuracy', 'popular', 'ConvNets', 'trained', 'ImageNet', 'Algorithm', 'shows', 'greedy', 'solution', 'problem', 'al-', 'ways', 'applies', 'largest', 'batch', 'size', 'possible', 'queue', 'length', 'i.e', 'number', 'requests', 'queue', 'larger', 'largest', 'batch', 'size', 'max', 'oldest', 'requests', 'processed', 'one', 'batch', 'Otherwise', 'waits', 'oldest', 'request', 'overdue', 'checked', 'Line', 'largest', 'batch', 'size', 'smaller', 'equal', 'queue', 'length', 'Line', 'back-off', 'constant', 'equivalent', 'reducing', 'batch', 'size', 'Additive-Increase-Multiplicative-Decrease', 'scheme', 'AIMD', 'e.g', '0.1τ', 'Algorithm', 'Inference', 'Queue', 'Model', 'True', 'maxB', 'len', 'm.infer', 'deque', 'else', 'max', 'len', 'm.infer', 'deque', 'end', 'end', 'end', '5.2', 'Multiple', 'Inference', 'Models', 'Single', 'Model', 'Two', 'Models', 'Three', 'Models', 'Four', 'Models', 'Ensemble', 'Method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'Figure', 'Accuracy', 'ensemble', 'modeling', 'different', 'models', 'Ensemble', 'modeling', 'effective', 'popular', 'approach', 'im-', 'prove', 'inference', 'accuracy', 'give', 'example', 'compare', 'performance', 'different', 'ensemble', 'ConvNets', 'shown', 'Figure', 'Majority', 'voting', 'applied', 'aggregate', 'predictions', 'The', 'accuracy', 'evaluated', 'validation', 'dataset', 'ImageNet', 'Generally', 'models', 'accuracy', 'better', 'The', 'exception', 'ensemble', 'resnet', '101', 'inception', 'good', 'single', 'best', 'model', 'i.e', 'inception', 'resnet', 'fact', 'prediction', 'ensemble', 'modeling', 'incep-', 'tion', 'tie', 'prediction', 'model', 'best', 'accuracy', 'selected', 'final', 'prediction', 'Parallel', 'ensemble', 'modeling', 'running', 'one', 'model', 'per', 'node', 'GPU', 'straight-forward', 'way', 'scale', 'system', 'improve', 'throughput', 'However', 'latency', 'could', 'high', 'due', 'stragglers', 'For', 'example', 'shown', 'Figure', 'node', 'running', 'nasnet', 'large', 'would', 'slow', 'although', 'accuracy', 'high', 'addition', 'en-', 'semble', 'modeling', 'also', 'costly', 'terms', 'throughput', 'com-', 'pared', 'serving', 'different', 'requests', 'different', 'nodes', 'i.e', 'ensemble', 'see', 'trade-off', 'latency', 'throughput', 'accuracy', 'controlled', 'model', 'selec-', 'tion', 'requests', 'arrive', 'slowly', 'simply', 'run', 'models', 'batch', 'get', 'best', 'accuracy', 'However', 'request', 'arrival', 'rate', 'high', 'like', 'Section', '5.1', 'select', 'different', 'models', 'different', 'requests', 'increase', 'throughput', 'reduce', 'latency', 'addition', 'model', 'selection', 'current', 'batch', 'also', 'affects', 'next', 'batch', 'For', 'example', 'use', 'models', 'batch', 'next', 'batch', 'wait', 'least', 'one', 'model', 'finishes', 'solve', 'Equation', 'balance', 'accuracy', 'latency', 'get', 'single', 'optimization', 'objective', 'move', 'latency', 'term', 'objective', 'shown', 'Equation', 'maximizes', 'reward', 'functionR', 'related', 'prediction', 'accuracy', 'penalizes', 'overdue', 'requests', 'balances', 'accuracy', 'latency', 'objective', 'ground', 'truth', 'request', 'available', 'evaluating', 'accuracy', 'normal', 'case', 'find', 'surrogate', 'accuracy', 'maxR', 'Like', 'analysis', 'single', 'inference', 'model', 'need', 'consider', 'batch', 'size', 'selection', 'well', 'difficult', 'design', 'optimal', 'policy', 'complex', 'decision', 'making', 'problem', 'decides', 'model', 'selection', 'batch', 'size', 'selection', 'paper', 'propose', 'optimize', 'Equation', 'using', 'reinforcement', 'learning', 'optimizes', 'objective', 'long', 'term', 'trying', 'different', 'actions', 'entering', 'corresponding', 'states', 'collect', 'rewards', 'setting', 'reward', 'Equation', 'defining', 'actions', 'model', 'selection', 'batch', 'selection', 'apply', 'optimization', 'problem', 'three', 'core', 'concepts', 'namely', 'action', 'reward', 'state', 'Once', 'three', 'concepts', 'defined', 'apply', 'existing', 'al-', 'gorithms', 'optimization', 'define', 'three', 'concepts', 'w.r.t', 'optimization', 'problem', 'follows', 'First', 'state', 'space', 'consists', 'queue', 'status', 'represented', 'waiting', 'time', 'request', 'queue', 'The', 'waiting', 'time', 'requests', 'form', 'feature', 'vec-', 'tor', 'generate', 'fixed', 'length', 'feature', 'vector', 'pad', 'shorter', 'queues', 'truncate', 'longer', 'queues', 'model', 'status', 'represented', 'vector', 'including', 'inference', 'time', 'different', 'models', 'different', 'batch', 'sizes', 'i.e', 'left', 'time', 'finish', 'existing', 'requests', 'dispatched', 'The', 'two', 'feature', 'vectors', 'concatenated', 'state', 'feature', 'vector', 'input', 'model', 'generating', 'action', 'Second', 'action', 'decides', 'batch', 'size', 'model', 'selection', 'represented', 'binary', 'vector', 'length', 'selected', 'unselected', 'The', 'action', 'space', 'size', 'thus', '2|M|−', '|B|', 'exclude', 'case', 'i.e', 'none', 'models', 'selected', 'Third', 'following', 'Equation', 'reward', 'one', 'batch', 'requests', 'without', 'ground', 'truth', 'labels', 'defined', 'Equation', 'accuracy', 'selected', 'models', 'ensemble', 'modeling', 'paper', 'use', 'accuracy', 'evaluated', 'validation', 'dataset', 'surrogate', 'accu-', 'racy', 'experiment', 'use', 'ImageNet', 'validation', 'dataset', 'evaluate', 'accuracy', 'different', 'ensemble', 'combinations', 'im-', 'age', 'classification', 'The', 'results', 'shown', 'Figure', 'The', 'reward', 'shown', 'Equation', 'considers', 'accuracy', 'latency', 'indirectly', 'represented', 'number', 'overdue', 'requests', 'number', 'requests', 'batch|l', 'With', 'state', 'action', 'reward', 'well', 'defined', 'apply', 'actor-critic', 'algorithm', 'optimize', 'overall', 'reward', 'learn-', 'ing', 'good', 'policy', 'selecting', 'models', 'batch', 'size', 'SYSTEM', 'IMPLEMENTATION', 'section', 'introduce', 'implementation', 'details', 'Rafiki', 'including', 'cluster', 'management', 'data', 'parameter', 'storage', 'failure', 'recovery', '6.1', 'Cluster', 'Management', 'Manager', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Master', 'Data', 'Worker', 'Worker', 'Parameter', 'Train', 'Inference', 'Node', 'Node', 'CNode', 'Figure', 'Rafiki', 'cluster', 'topology', 'Rafiki', 'uses', 'Kubernetes', 'manage', 'Docker', 'containers', 'run', 'masters', 'workers', 'data', 'servers', 'parameter', 'servers', 'shown', 'Figure', 'Docker', 'container', 'widely', 'used', 'applica-', 'tion', 'deployment', 'bundles', 'application', 'code', 'e.g', 'training', 'inference', 'code', 'libraries', 'e.g', 'Keras', 'avoid', 'tedious', 'en-', 'vironment', 'setup', 'New', 'models', 'hyper-parameter', 'tuning', 'algorithms', 'ensemble', 'modeling', 'approaches', 'deployed', 'new', 'Docker', 'containers', 'physical', 'node', 'could', 'multiple', 'masters', 'workers', 'different', 'jobs', 'including', 'training', 'infer-', 'ence', 'jobs', 'These', 'jobs', 'started', 'Rafiki', 'manager', 'accepts', 'job', 'submissions', 'users', 'See', 'Figure', 'Once', 'job', 'launched', 'users', 'communicate', 'master', 'directly', 'get', 'training', 'progress', 'submit', 'query', 'requests', 'Rafiki', 'prefers', 'locate', 'master', 'workers', 'job', 'physical', 'node', 'avoid', 'network', 'communication', 'overhead', '6.2', 'Data', 'Parameter', 'Storage', 'Deep', 'learning', 'models', 'typically', 'trained', 'large', 'datasets', 'would', 'consume', 'lot', 'space', 'stored', 'CPU', 'memory', 'There-', 'fore', 'Rafiki', 'uses', 'HDFS', 'data', 'storage', 'data', 'nodes', 'also', 'docker', 'containers', 'Users', 'upload', 'datasets', 'HDFS', 'via', 'Rafiki', 'utility', 'functions', 'e.g', 'rafiki.import', 'images', 'see', 'Fig-', 'ure', 'The', 'training', 'dataset', 'downloaded', 'local', 'directory', 'be-', 'fore', 'training', 'via', 'rafiki.download', 'passing', 'dataset', 'name', 'For', 'model', 'parameters', 'Rafiki', 'distributed', 'parameter', 'server', 'The', 'parameter', 'server', 'designed', 'special', 'optimiza-', 'tion', 'hyper-parameter', 'training', 'inference', 'particular', 'hyper-parameters', 'cached', 'memory', 'accessed', 'frequently', 'e.g', 'Rafiki', 'hyper-parameter', 'training', 'Otherwise', 'stored', 'HDFS', 'The', 'parameters', 'trained', 'model', 'different', 'datasets', 'shared', 'long', 'privacy', 'setting', 'public', 'shown', 'training', 'warm-up', 'using', 'parameters', 'pre-trained', 'datasets', 'speeds', 'training', '6.3', 'Failure', 'Recovery', 'For', 'hyper-parameter', 'training', 'inference', 'services', 'workers', 'stateless', 'Hence', 'Rafiki', 'manager', 'easily', 'recover', 'nodes', 'running', 'new', 'docker', 'container', 'registering', 'training', 'inference', 'master', 'However', 'masters', 'state', 'information', 'For', 'example', 'master', 'training', 'ser-', 'vice', 'records', 'current', 'best', 'hyper-parameter', 'trial', 'The', 'master', 'inference', 'service', 'state', 'action', 'reward', 'reinforce-', 'ment', 'learning', 'Rafiki', 'checkpoints', 'small', 'state', 'information', 'masters', 'fast', 'failure', 'recovery', 'EXPERIMENTAL', 'STUDY', 'section', 'evaluate', 'scalability', 'efficiency', 'effec-', 'tiveness', 'Rafiki', 'hyper-parameter', 'tuning', 'inference', 'ser-', 'vice', 'optimization', 'respectively', 'The', 'experiments', 'conducted', 'three', 'machines', 'Nvidia', 'GTX', '1080Ti', 'GPUs', 'Intel', 'E5-1650v4', 'CPU', '64GB', 'memory', '7.1', 'Evaluation', 'Hyper-parameter', 'Tuning', 'Task', 'Dataset', 'test', 'Rafiki', 'distributed', 'hyper-parameter', 'tuning', 'service', 'running', 'tune', 'hyper-parameters', 'deep', 'ConvNets', 'CIFAR-10', 'image', 'classification', 'CIFAR-10', 'popular', 'benchmark', 'dataset', 'RGB', 'images', 'categories', 'Each', 'category', '5000', 'training', 'images', 'including', '1000', 'validation', 'images', '1000', 'test', 'images', 'All', 'images', 'size', '32x32', 'There', 'standard', 'sequence', 'preprocessing', 'steps', 'CIFAR-10', 'subtracts', 'mean', 'divides', 'standard', 'deviation', 'channel', 'computed', 'training', 'images', 'pads', 'image', 'pixels', 'zeros', 'side', 'obtain', '40x40', 'pixel', 'image', 'ran-', 'domly', 'crops', '32x32', 'patch', 'flips', 'horizontal', 'direction', 'image', 'randomly', 'probability', '0.5', '100', '200', 'Trial', 'Index', 'lid', 'Without', 'CoStudy', '100', '200', 'Trial', 'Index', 'With', 'CoStudy', 'Validation', 'Accuracy', '100', 'ria', 'Without', 'CoStudyWith', 'CoStudy', '100', '200', 'Total', 'Training', 'Epochs', 'lid', 'Wihtout', 'CoStudy', 'With', 'CoStudy', 'Figure', 'Hyper-parameter', 'tuning', 'based', 'random', 'search', '100', 'Trial', 'Index', 'lid', 'Without', 'CoStudy', '100', 'Trial', 'Index', 'With', 'CoStudy', 'Validation', 'Accuracy', '100', 'ria', 'Without', 'CoStudyWith', 'CoStudy', '100', 'Total', 'Training', 'Epochs', 'lid', 'Without', 'CoStudy', 'With', 'CoStudy', 'Figure', 'Hyper-parameter', 'tuning', 'based', 'Bayesian', 'optimization', '7.1.1', 'Tuning', 'Optimization', 'Hyper-parameters', 'fix', 'ConvNet', 'architecture', 'shown', 'Table', 'convolution', 'layers', 'The', 'hyper-parameters', 'tuned', 'optimization', 'algorithm', 'including', 'momen-', 'tum', 'learning', 'rate', 'weight', 'decay', 'coefficients', 'dropout', 'rates', 'standard', 'deviations', 'Gaussian', 'distribution', 'weight', 'initial-', 'ization', 'run', 'trial', 'early', 'stopping', 'terminates', 'training', 'validation', 'loss', 'stops', 'decreasing', 'compare', 'naı̈ve', 'distributed', 'tuning', 'algorithm', 'i.e', 'Study', 'Algorithm', 'collaborative', 'tuning', 'algorithm', 'i.e', 'CoS-', 'tudy', 'Algorithm', 'different', 'TrialAdvisor', 'algorithms', 'Figure', 'shows', 'comparison', 'using', 'random', 'search', 'TrialAdvisor', 'particular', 'point', 'Figure', 'stands', 'one', 'trial', 'see', 'top', 'area', 'CoStudy', 'denser', 'Study', 'words', 'CoStudy', 'likely', 'get', 'better', 'performance', 'This', 'confirmed', 'Figure', 'shows', 'CoStudy', 'trials', 'high', 'accuracy', 'i.e', 'accuracy', 'Study', 'fewer', 'trials', 'low', 'accuracy', 'i.e.', 'accuracy≤50', 'Figure', 'illustrates', 'tuning', 'progress', 'two', 'approaches', 'point', 'line', 'represents', 'best', 'performance', 'among', 'trials', 'conducted', 'far', 'The', 'x-axis', 'total', 'number', 'training', 'epochs8', 'corre-', 'sponds', 'tuning', 'time', '=total', 'number', 'epochs', 'times', 'time', 'per', 'epoch', 'observe', 'CoStudy', 'faster', 'Study', 'achieves', 'better', 'accuracy', 'Study', 'Notice', 'validation', 'ac-', 'curacy', 'high', 'Therefore', 'small', 'difference', 'indicates', 'significant', 'improvement', 'Figure', 'compares', 'Study', 'CoStudy', 'using', 'Gaussian', 'process', 'based', 'Bayesian', 'Optimization', 'TrialAdvisor', 'Comparing', 'Figure', 'Figure', 'see', 'points', 'top', 'area', 'figures', 'words', 'better', 'random', '8training', 'model', 'scanning', 'dataset', 'called', 'one', 'epoch', '9https', '//github.com/scikit-optimize', 'searchwhich', 'observed', 'papers', 'Figure', 'CoStudy', 'points', 'right', 'bottom', 'area', 'CoS-', 'tudy', 'After', 'in-depth', 'inspection', 'found', 'points', 'trials', 'initialized', 'randomly', 'instead', 'pre-trained', 'models', 'For', 'Study', 'always', 'uses', 'random', 'initialization', 'hence', 'algo-', 'rithm', 'fixed', 'prior', 'initialization', 'method', 'However', 'CoStuy', 'initialization', 'pre-trained', 'models', 'time', 'These', 'random', 'initialization', 'trials', 'change', 'prior', 'thus', 'get', 'biased', 'estimation', 'Gaussian', 'process', 'leads', 'poor', 'accuracy', 'Since', 'decaying', 'reduce', 'chance', 'random', 'initialization', 'fewer', 'fewer', 'points', 'right', 'bottom', 'area', 'Overall', 'CoStudy', 'achieves', 'better', 'accuracy', 'shown', 'Figure', 'Figure', 'study', 'scalability', 'Rafiki', 'varying', 'number', 'work-', 'ers', 'Figure', 'compares', 'jobs', 'running', 'GPUs', 'respectively', 'Each', 'point', 'curves', 'figure', 'represents', 'best', 'validation', 'performance', 'among', 'trials', 'tested', 'far', 'The', 'x-axis', 'wall', 'clock', 'time', 'see', 'GPUs', 'tuning', 'becomes', 'faster', 'scales', 'almost', 'linearly', '7.2', 'Evaluation', 'Inference', 'Optimization', 'use', 'image', 'classification', 'application', 'test', 'opti-', 'mization', 'techniques', 'introduced', 'Section', 'The', 'inference', 'models', 'ConvNets', 'trained', 'ImageNet', 'benchmark', 'dataset', 'ImageNet', 'popular', 'image', 'classification', 'benchmark', 'many', 'open-source', 'ConvNets', 'trained', 'Figure', '1.2', 'million', 'RGB', 'training', 'images', '50,000', 'validation', 'images', 'Our', 'environment', 'simulator', 'randomly', 'samples', 'images', 'validation', 'dataset', 'requests', 'The', 'number', 'requests', 'deter-', 'mined', 'follows', 'First', 'simulate', 'scenario', 'high', 'arriving', 'rate', 'low', 'arriving', 'rate', 'set', 'arriving', 'rate', 'based', 'maximum', 'throughput', 'minimum', 'throughput', 'Specifically', 'maximum', 'throughput', 'sum', 'models', 'throughput', 'achieved', 'models', 'run', 'asynchronously', '250', '500', '750', '1000', '1250', '1500', 'Time', 'seconds', '100', '200', '300', '400', 'Greedy', 'Request', 'Rate', 'Figure', 'Single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'Number', 'Workers', '500', '1000', '1500', '250', '500', '750', '1000', 'Wall', 'Time', 'Minutes', 'lid', 'Worker', 'Workers', 'Workers', 'Workers', 'Figure', 'Scalability', 'test', 'distributed', 'hyper-parameter', 'tuning', 'T/2T/4', '0.1T', '0.1T', 'Figure', 'Sine', 'function', 'controlling', 'request', 'arriving', 'rate', 'process', 'different', 'batches', 'requests', 'contrast', 'mod-', 'els', 'run', 'synchronously', 'slowest', 'model', 'throughput', 'minimum', 'throughput', 'Second', 'use', 'sine', 'function', 'extreme', 'throughput', 'values', 'define', 'request', 'arriving', 'rate', 'i.e', 'γsin', 'The', 'slope', 'intercept', 'derived', 'solving', 'Equation', 'cycle', 'period', 'configured', '500', 'experiments', 'The', 'first', 'equation', 'make', 'sure', 'requests', 'generated', 'cycle', 'period', 'Figure', '0.2T', 'way', 'simulating', 'real-life', 'environment', 'overwhelming', 'requests', 'coming', 'times', 'The', 'second', 'equa-', 'tion', 'make', 'sure', 'highest', 'arriving', 'rate', 'large', 'otherwise', 'request', 'queue', 'would', 'filled', 'quickly', 'new', 'requests', 'dropped', 'Finally', 'small', 'random', 'noise', 'applied', 'prevent', 'algorithm', 'remembering', 'sine', 'function', 'conclude', 'number', 'new', 'requests', 'γsin', '0.1', 'time', 'span', 'last', 'invocation', 'simulator', 'current', 'time', 'sin', 'T/2−', '0.2×', '2T/2', 'sin', 'T/2', '1.1×', '7.2.1', 'Single', 'Inference', 'Model', 'use', 'inception', 'trained', 'ImageNet', 'single', 'infer-', 'ence', 'model', 'Besides', 'greedy', 'algorithm', 'Algorithm', 'also', 'run', 'algorithm', 'Section', '5.2', 'decide', 'batch', 'size', 'The', 'state', 'Section', '5.2', 'except', 'model', 'related', 'status', 'removed', 'The', 'batch', 'size', 'list', 'The', 'maximum', 'throughput', 'max', 'b/c', '64/0.23', '272', 'images/second', 'minimum', 'throughput', 'min', 'b/c', '16/0.07', '228', 'set', '0.56s', 'Figure', 'compares', 'algorithm', 'greedy', 'algorithm', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'see', 'iterations', 'performs', 'similarly', 'greedy', 'algorithm', 'request', 'arriving', 'rate', 'high', 'When', 'low', 'performs', 'better', 'greedy', 'algorithm', 'This', 'requests', 'left', 'queue', 'length', 'equal', 'batch', 'size', 'Line', 'Algorithm', 'These', 'left', 'requests', 'likely', 'overdue', 'new', 'requests', 'coming', 'slowly', 'form', 'new', 'batch', 'Figure', 'compares', 'algorithm', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'defined', 'based', 'minimum', 'throughput', 'see', 'performs', 'better', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'either', 'high', 'low', 'Overall', 'since', 'arriving', 'rate', 'smaller', 'Figure', 'fewer', 'overdue', 'requests', '7.2.2', 'Multiple', 'Inference', 'Models', 'following', 'experiments', 'select', 'inception', 'inception', 'inception', 'resnet', 'construct', 'model', 'list', 'The', 'maxi-', 'mum', 'throughput', 'minimum', 'throughput', '572', 'requests/second', '128', 'requests/second', 'respectively', 'The', 'experimental', 'results', 'plotted', 'Figure', 'Figure', 'Figure', 'The', 'legend', 'text', 'Overdue', 'represents', 'number', 'overdue', 'requests', 'per', 'sec-', 'ond', 'Arriving', 'stands', 'request', 'arriving', 'rate', 'compare', 'algorithm', 'two', 'baseline', 'algorithms', 're-', 'spectively', 'For', 'baseline', 'use', 'greedy', 'algorithm', 'find', 'batch', 'size', 'They', 'differ', 'model', 'selection', 'strategy', 'The', 'first', 'baseline', 'runs', 'models', 'synchronously', 'batch', 'requests', 'Correspondingly', 'requests', 'generated', 'using', 'rate', 'based', 'From', 'Figure', '14a', 'Figure', '14b', 'see', 'greedy', 'algorithm', 'fixed', 'accuracy', 'whereas', 'algorithm', 'ac-', 'curacy', 'high', 'resp', 'low', 'rate', 'low', 'resp', 'high', '250', '500', '750', '1000', '1250', '1500', 'Time', 'seconds', '100', '150', '200', '250', '300', 'Greedy', 'Request', 'Rate', 'Figure', 'Single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'Time', 'seconds', '0.78', '0.80', '0.82', '0.84', '100', '125', '150', 'Greedy', 'algorithm', '23000', '23500', '24000', 'Time', 'seconds', '0.802', '0.804', '0.806', '0.808', '0.810', '100', '125', '150', 'algorithm', '500', '1000', 'Time', 'seconds', '100', '150', '200', 'Overdue', 'Arriving', 'Greedy', 'algorithm', '23000', '23500', '24000', 'Time', 'seconds', '100', '150', '200', 'Overdue', 'Arriving', 'algorithm', 'Figure', 'Multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'Time', 'seconds', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'Greedy', 'algorithm', '13500', '14000', '14500', 'Time', 'seconds', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'algorithm', '500', '1000', 'Time', 'seconds', '200', '400', '600', '800', '1000', 'Overdue', 'Arriving', 'Greedy', 'algorithm', '13500', '14000', '14500', 'Time', 'seconds', '200', '400', '600', '800', '1000', 'Overdue', 'Arriving', 'algorithm', 'Figure', 'Multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', '2000', '4000', '6000', 'Time', 'seconds', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'Time', 'seconds', '0.795', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'Time', 'seconds', '100', '150', '200', 'Overdue', 'Arriving', '2000', '4000', '6000', 'Time', 'seconds', '100', '150', '200', 'Overdue', 'Arriving', 'Figure', 'Comparison', 'effect', 'different', 'algorithm', 'fact', 'synchronous', 'algorithm', 'always', 'uses', 'models', 'en-', 'semble', 'modelling', 'whereas', 'algorithm', 'uses', 'fewer', 'models', 'ensemble', 'modeling', 'arriving', 'rate', 'high', 'Since', 'request', 'arriving', 'rate', 'low', 'baseline', 'able', 'handle', 'al-', 'requests', 'Similar', 'Figure', 'overdue', 'requests', 'Figure', '14c', 'due', 'mismatch', 'queue', 'size', 'batch', 'size', 'Algorithm', 'The', 'second', 'baseline', 'runs', 'models', 'asynchronously', 'one', 'model', 'per', 'batch', 'requests', 'words', 'ensemble', 'mod-', 'eling', 'Correspondingly', 'requests', 'generated', 'using', 'rate', 'based', 'see', 'better', 'accuracy', 'Figure', '15a', '15b', 'fewer', 'overdue', 'requests', 'Figure', '15c', '15d', 'baseline', 'Moreover', 'adaptive', 'request', 'arriving', 'rate', 'When', 'rate', 'high', 'uses', 'fewer', 'models', 'serve', 'batch', 'im-', 'prove', 'throughput', 'reduce', 'overdue', 'requests', 'When', 'rate', 'low', 'uses', 'models', 'serve', 'batch', 'improve', 'accuracy', 'also', 'compare', 'effect', 'different', 'namely', 'reward', 'function', 'i.e', 'Equation', 'Figure', 'shows', 'results', 'requests', 'generated', 'based', 'see', 'smaller', 'accuracy', 'Figure', '16a', 'higher', 'This', 'reward', 'function', 'focus', 'accuracy', 'part', 'Con-', 'sequently', 'many', 'overdue', 'requests', 'shown', 'Figure', '16c', 'contrast', 'reward', 'function', 'tries', 'avoid', 'overdue', 'requests', 'reducing', 'number', 'models', 'ensemble', 'There-', 'fore', 'accuracy', 'number', 'overdue', 'requests', 'smaller', 'Figure', '16b', 'Figure', '16d', 'CASE', 'STUDY', 'USABILITY', 'curl', '-F=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'CREATE', 'TABLE', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'NOT', 'NULL', 'location', 'text', 'NOT', 'NULL', 'time', 'text', 'NOT', 'NULL', 'image_path', 'text', 'NOT', 'NULL', 'PRIMARY', 'KEY', 'user_id', 'time', 'SELECT', 'UDF_FOOD_NAME', 'image_path', 'food_name', 'count', 'FROM', 'foodlog', 'WHERE', 'age', 'GROUP', 'food_name', 'Figure', 'SQL', 'table', 'creation', 'section', 'detail', 'Rafiki', 'help', 'database', 'expert', 'use', 'deep', 'learning', 'services', 'easily', 'existing', 'application', 'present', 'scenario', 'analyzing', 'food', 'preference', 'users', 'food', 'logging', 'application', 'shown', 'Figure', 'This', 'application', 'keeps', 'log', 'food', 'user', 'eats', 'storing', 'time', 'loca-', 'tion', 'photo', 'meal', 'For', 'simplicity', 'assume', 'data', 'stored', 'one', 'table', 'created', 'Figure', 'Each', 'row', 'table', 'contains', 'information', 'meal', 'The', 'image', 'path', 'file', 'path', 'image', 'This', 'image', 'contains', 'picture', 'food', 'however', 'direct', 'way', 'query', 'information', 'e.g.', 'name', 'food', 'image', 'Using', 'Rafiki', 'database', 'developer', 'collaborates', 'deep', 'learning', 'expert', 'develops', 'trains', 'image', 'recog-', 'nition', 'model', 'food', 'images', 'This', 'trained', 'model', 'shared', 'Rafiki', 'provides', 'recognition', 'services', 'database', 'users', 'black', 'box', 'via', 'Web', 'APIs', 'Figure', 'displays', 'web', 'interface', 'Rafiki', 'Figure', 'Rafiki', 'web', 'interface', 'Deep', 'Learning', 'Expert', 'The', 'deep', 'learning', 'expert', 'prepares', 'training', 'train.py', 'serving', 'serve.py', 'scripts', 'deep', 'learning', 'model', 'using', 'Apache', 'SINGA', '10http', '//singa.apache.org/', 'Database', 'User', 'After', 'uploading', 'training', 'dataset', 'i.e', 'set', 'food', 'image', 'label', 'pairs', 'Rafiki', 'database', 'user', 'starts', 'training', 'job', 'Once', 'training', 'finished', 'user', 'deploys', 'trained', 'model', 'serving', 'job', 'Afterwards', 'exploits', 'deep', 'learning', 'service', 'get', 'food', 'name', 'sending', 'request', 'Rafiki', 'via', 'user-defined', 'function', 'UDF', 'The', 'food', 'name', 'function', 'calls', 'Web', 'API', 'serving', 'application', 'Rafiki', 'particular', 'function', 'executed', 'images', 'rows', 'sat-', 'isfy', 'condition', 'age', 'greater', 'Consequently', 'saves', 'much', 'time', 'Batch', 'processing', 'supported', 'Rafiki', 'side', 'im-', 'prove', 'efficiency', 'Furthermore', 'model', 'modified', 're-trained', 'Rafiki', 'change', 'SQL', 'query', 'database', 'user', 'side', 'curl', '-F=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'CREATE', 'TABLE', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'NOT', 'NULL', 'location', 'text', 'NOT', 'NULL', 'time', 'text', 'NOT', 'NULL', 'image_path', 'text', 'NOT', 'NULL', 'PRIMARY', 'KEY', 'user_id', 'time', 'SELECT', 'UDF_FOOD_NAME', 'image_path', 'food_name', 'count', 'FROM', 'foodlog', 'WHERE', 'age', 'GROUP', 'food_name', 'select', 'food_name', 'image_path', 'name', 'count', 'foodlog', 'age', 'group', 'name', 'This', 'service', 'also', 'serve', 'requests', 'mobile', 'Apps', 'demon-', 'strated', 'Figure', 'created', 'food', 'logging', 'App', 'sends', 'requests', 'Rafiki', 'food', 'image', 'prediction', 'CONCLUSIONS', 'Complex', 'analytics', 'become', 'inherent', 'expected', 'func-', 'tionality', 'supported', 'big', 'data', 'systems', 'However', 'widely', 'recognized', 'machine', 'learning', 'models', 'easy', 'build', 'train', 'sensitive', 'data', 'distributions', 'characteris-', 'tics', 'therefore', 'important', 'reduce', 'pain', 'points', 'imple-', 'menting', 'tuning', 'dataset', 'specific', 'models', 'step', 'towards', 'making', 'usable', 'paper', 'present', 'Rafiki', 'provide', 'training', 'inference', 'service', 'machine', 'learning', 'models', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', 'Rafiki', 'supports', 'effective', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensemble', 'modeling', 'inference', 'service', 'amenable', 'trade', 'latency', 'accu-', 'racy', 'The', 'system', 'evaluated', 'various', 'benchmarks', 'illustrate', 'efficiency', 'effectiveness', 'scalability', 'also', 'conducted', 'case', 'study', 'demonstrates', 'system', 'enables', 'database', 'developer', 'use', 'deep', 'learning', 'services', 'easily', 'REFERENCES', 'Providing', 'database', 'service', 'Proceedings', '18th', 'International', 'Conference', 'Data', 'Engineering', 'ICDE', 'pages', '29–', 'Washington', 'USA', '2002', 'IEEE', 'Computer', 'Society', 'Abadi', 'Barham', 'Chen', 'Chen', 'Davis', 'Dean', 'Devin', 'Ghemawat', 'Irving', 'Isard', 'Kudlur', 'Levenberg', 'Monga', 'Moore', 'Murray', 'Steiner', 'Tucker', 'Vasudevan', 'Warden', 'Wicke', 'Zheng', 'Tensorflow', 'system', 'large-scale', 'machine', 'learning', '12th', 'USENIX', 'Symposium', 'Operating', 'Systems', 'Design', 'Implementation', 'OSDI', 'pages', '265–283', '2016', 'USENIX', 'Association', 'Bergstra', 'Bengio', 'Random', 'search', 'hyper-parameter', 'optimization', 'Mach', 'Learn', 'Res.', '13:281–305', 'Feb.', '2012', 'Collobert', 'Weston', 'Bottou', 'Karlen', 'Kavukcuoglu', 'Kuksa', 'Natural', 'language', 'processing', 'almost', 'scratch', 'CoRR', 'abs/1103.0398', '2011', 'Crankshaw', 'Wang', 'Zhou', 'Franklin', 'Gonzalez', 'Stoica', 'Clipper', 'low-latency', 'online', 'prediction', 'serving', 'system', '14th', 'USENIX', 'Symposium', 'Networked', 'Systems', 'Design', 'Implementation', 'NSDI', 'pages', '613–627', 'Boston', '2017', 'USENIX', 'Association', 'Curino', 'Philip', 'Charles', 'Jones', 'Popa', 'Malviya', 'Madden', 'Balakrishnan', 'Zeldovich', 'Relational', 'cloud', 'database-as-a-service', 'cloud', '2011', 'Deng', 'Dong', 'Socher', 'L.-J', 'Fei-Fei', 'ImageNet', 'Large-Scale', 'Hierarchical', 'Image', 'Database', 'CVPR09', '2009', 'Devries', 'Taylor', 'Improved', 'regularization', 'convolutional', 'neural', 'networks', 'cutout', 'CoRR', 'abs/1708.04552', '2017', 'Golovin', 'Solnik', 'Moitra', 'Kochanski', 'Karro', 'Sculley', 'editors', 'Google', 'Vizier', 'Service', 'Black-Box', 'Optimization', '2017', 'Zhang', 'Ren', 'Sun', 'Deep', 'residual', 'learning', 'image', 'recognition', 'CoRR', 'abs/1512.03385', '2015', 'Hinton', 'Osindero', 'Y.-W.', 'Teh', 'fast', 'learning', 'algorithm', 'deep', 'belief', 'nets', 'Neural', 'Comput.', ':1527–1554', 'July', '2006', 'Howard', 'Zhu', 'Chen', 'Kalenichenko', 'Wang', 'Weyand', 'Andreetto', 'Adam', 'Mobilenets', 'Efficient', 'convolutional', 'neural', 'networks', 'mobile', 'vision', 'applications', 'CoRR', 'abs/1704.04861', '2017', 'Iandola', 'Moskewicz', 'Ashraf', 'Han', 'Dally', 'Keutzer', 'Squeezenet', 'Alexnet-level', 'accuracy', '50x', 'fewer', 'parameters', '1mb', 'model', 'size', 'CoRR', 'abs/1602.07360', '2016', 'Kang', 'Emmons', 'Abuzaid', 'Bailis', 'Zaharia', 'Noscope', 'Optimizing', 'neural', 'network', 'queries', 'video', 'scale', 'Proc', 'VLDB', 'Endow.', ':1586–1597', 'Aug.', '2017', 'Krizhevsky', 'Sutskever', 'Hinton', 'Imagenet', 'classification', 'deep', 'convolutional', 'neural', 'networks', 'NIPS', 'pages', '1106–1114', '2012', 'Kuncheva', 'Whitaker', 'Measures', 'diversity', 'classifier', 'ensembles', 'relationship', 'ensemble', 'accuracy', 'Mach', 'Learn.', ':181–207', 'May', '2003', 'LeCun', 'Bengio', 'Hinton', 'Deep', 'learning', 'Nature', '521', '7553', ':436–444', '2015', 'Zhong', 'Liu', 'Zhang', 'Ease.ml', 'Towards', 'multi-tenant', 'resource', 'sharing', 'machine', 'learning', 'workloads', 'arXiv:1708.07308', '2017', 'Deep', 'reinforcement', 'learning', 'overview', 'CoRR', 'abs/1701.07274', '2017', 'Mnih', 'Puigdomènech', 'Badia', 'Mirza', 'Graves', 'Lillicrap', 'Harley', 'Silver', 'Kavukcuoglu', 'Asynchronous', 'Methods', 'Deep', 'Reinforcement', 'Learning', 'ArXiv', 'e-prints', 'Feb.', '2016', 'Modi', 'Koo', 'Foo', 'Mewald', 'Baylor', 'Breck', 'H.-T.', 'Cheng', 'Wilkiewicz', 'Koc', 'Lew', 'Zinkevich', 'Wicke', 'Ispir', 'Polyzotis', 'Fiedel', 'Haykal', 'Whang', 'Roy', 'Ramesh', 'Jain', 'Zhang', 'Haque', 'Tfx', 'tensorflow-based', 'production-scale', 'machine', 'learning', 'platform', 'KDD', '2017', '2017', 'Ooi', 'Tan', 'Wang', 'Wang', 'Cai', 'Chen', 'Gao', 'Luo', 'Tung', 'Wang', 'Xie', 'Zhang', 'Zheng', 'SINGA', 'distributed', 'deep', 'learning', 'platform', 'ACM', 'Multimedia', 'pages', '685–688', '2015', 'Ré', 'Agrawal', 'Balazinska', 'Cafarella', 'Jordan', 'Kraska', 'Ramakrishnan', 'Machine', 'learning', 'databases', 'The', 'sound', 'things', 'come', 'cacophony', 'hype', 'SIGMOD', 'pages', '283–284', '2015', 'Schulman', 'Wolski', 'Dhariwal', 'Radford', 'Klimov', 'Proximal', 'policy', 'optimization', 'algorithms', 'CoRR', 'abs/1707.06347', '2017', 'Sculley', 'Holt', 'Golovin', 'Davydov', 'Phillips', 'Ebner', 'Chaudhary', 'Young', 'Machine', 'learning', 'The', 'high', 'interest', 'credit', 'card', 'technical', 'debt', 'SE4ML', 'Software', 'Engineering', 'Machine', 'Learning', 'NIPS', '2014', 'Workshop', '2014', 'Shahriari', 'Swersky', 'Wang', 'Adams', 'Freitas', 'Taking', 'human', 'loop', 'review', 'bayesian', 'optimization', 'Proceedings', 'IEEE', '104', ':148–175', 'Jan', '2016', 'Simonyan', 'Zisserman', 'Very', 'deep', 'convolutional', 'networks', 'large-scale', 'image', 'recognition', 'CoRR', 'abs/1409.1556', '2014', 'Snoek', 'Larochelle', 'Adams', 'Practical', 'Bayesian', 'Optimization', 'Machine', 'Learning', 'Algorithms', 'ArXiv', 'e-prints', 'June', '2012', 'Snoek', 'Rippel', 'Swersky', 'Kiros', 'Satish', 'Sundaram', 'Patwary', 'Prabhat', 'Adams', 'Scalable', 'Bayesian', 'Optimization', 'Using', 'Deep', 'Neural', 'Networks', 'ArXiv', 'e-prints', 'Feb.', '2015', 'Sutskever', 'Martens', 'Dahl', 'Hinton', 'importance', 'initialization', 'momentum', 'deep', 'learning', 'Proceedings', '30th', 'International', 'Conference', 'International', 'Conference', 'Machine', 'Learning', 'Volume', 'ICML', 'pages', 'III–1139–III–1147', 'JMLR.org', '2013', 'Sutton', 'Barto', 'Introduction', 'Reinforcement', 'Learning', 'MIT', 'Press', 'Cambridge', 'USA', '1st', 'edition', '1998', 'Szegedy', 'Liu', 'Jia', 'Sermanet', 'Reed', 'Anguelov', 'Erhan', 'Vanhoucke', 'Rabinovich', 'Going', 'deeper', 'convolutions', 'CoRR', 'abs/1409.4842', '2014', 'Wang', 'Chen', 'Chen', 'Dinh', 'Gao', 'Ooi', 'K.-L.', 'Tan', 'Wang', 'Deep', 'learning', 'scale', 'ease', 'Transactions', 'Multimedia', 'Computing', 'Communications', 'Applications', '2016', 'Wang', 'Chen', 'Dinh', 'Gao', 'Ooi', 'Tan', 'Wang', 'SINGA', 'putting', 'deep', 'learning', 'hands', 'multimedia', 'users', 'ACM', 'Multimedia', 'pages', '25–34', '2015', 'Wang', 'Yang', 'Ooi', 'Zhang', 'Zhuang', 'Effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', 'The', 'VLDB', 'Journal', 'pages', '1–23', '2015', 'Wang', 'Zhang', 'Chen', 'Jagadish', 'Ooi', 'K.-L.', 'Tan', 'Database', 'meets', 'deep', 'learning', 'Challenges', 'opportunities', 'ACM', 'SIGMOD', 'Record', ':17–22', '2016', 'Zhang', 'Zeng', 'Zhang', 'How', 'good', 'machine', 'learning', 'clouds', 'binary', 'classification', 'good', 'features', 'CoRR', 'abs/1707.09562', '2017', 'Zoph', 'Neural', 'architecture', 'search', 'reinforcement', 'learning', 'CoRR', 'abs/1611.01578', '2016']
['rafiki', 'machine', 'learning', 'analytics', 'service', 'system', 'wei', 'wang†', 'sheng', 'wang†', 'jinyang', 'gao†', 'meihui', 'zhang�', 'gang', 'chen‡', 'teck', 'khim', 'ng†', 'beng', 'chin', 'ooi†', '†national', 'university', 'singapore', '�beijing', 'institute', 'technology', '‡zhejiang', 'university', 'wangwei', 'jinyang.gao', 'wangsh', 'ngtk', 'ooibc', 'comp.nus.edu.sg', '�meihui', 'zhang', 'bit.edu.cn', 'zju.edu.cn', 'abstract', 'big', 'data', 'analytics', 'gaining', 'massive', 'momentum', 'last', 'years', 'applying', 'machine', 'learning', 'models', 'big', 'data', 'become', 'implicit', 'requirement', 'expectation', 'analysis', 'tasks', 'especially', 'high-stakes', 'applications.typical', 'applications', 'include', 'sentiment', 'analysis', 'reviews', 'analyzing', 'on-line', 'products', 'image', 'classification', 'food', 'logging', 'applications', 'monitoring', 'user', 'daily', 'intake', 'stock', 'movement', 'prediction', 'extending', 'tra-', 'ditional', 'database', 'systems', 'support', 'analysis', 'intriguing', 'challenging', 'first', 'almost', 'impossible', 'implement', 'ma-', 'chine', 'learning', 'models', 'database', 'engines', 'second', 'expertise', 'knowledge', 'required', 'optimize', 'training', 'inference', 'proce-', 'dures', 'terms', 'efficiency', 'effectiveness', 'imposes', 'heavy', 'burden', 'system', 'users', 'paper', 'develop', 'present', 'system', 'called', 'rafiki', 'provide', 'training', 'inference', 'ser-', 'vice', 'machine', 'learning', 'models', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', 'rafiki', 'provides', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensem-', 'ble', 'modeling', 'inference', 'service', 'trades', 'latency', 'accuracy', 'experimental', 'results', 'confirm', 'efficiency', 'effectiveness', 'scalability', 'usability', 'rafiki', 'introduction', 'data', 'analysis', 'plays', 'important', 'role', 'extracting', 'valuable', 'in-', 'sights', 'huge', 'amount', 'data', 'database', 'systems', 'traditionally', 'used', 'storing', 'analyzing', 'structured', 'data', 'spatial-', 'temporal', 'data', 'graph', 'data', 'etc', 'other', 'data', 'multimedia', 'data', 'e.g.', 'images', 'free', 'text', 'domain', 'specific', 'data', 'e.g', 'medical', 'data', 'sensor', 'data', 'generated', 'fast', 'speed', 'con-', 'stitutes', 'significant', 'portion', 'big', 'data', 'beneficial', 'analyze', 'data', 'database', 'applications', 'for', 'instance', 'inferring', 'quality', 'product', 'review', 'column', 'sales', 'database', 'would', 'help', 'explain', 'sales', 'numbers', 'analyz-', 'ing', 'food', 'images', 'food', 'logging', 'application', 'extract', 'food', 'preference', 'people', 'different', 'ages', 'however', 'analysis', 'requires', 'machine', 'learning', 'models', 'especially', 'deep', 'learn-', 'ing', 'models', 'sentiment', 'analysis', 'classify', 'review', 'positive', 'negative', 'image', 'classification', 'recognize', 'food', 'type', 'images', 'figure', 'shows', 'pipeline', 'data', 'analysis', 'database', 'systems', 'widely', 'used', 'first', 'stages', 'machine', 'learning', 'good', '4th', 'stage', 'big', 'data', '大数据', '3vs', 'volume', 'velocity', 'variety', '高容量，速度快，多样性', 'variety', 'implies', 'integrating', 'analyzing', 'data', 'necessary', 'develop', 'end-to-end', 'solutions', 'scale', 'easy', 'use', 'minimize', 'human', 'effort', 'acquisition', 'extraction/', 'cleaning/', 'annotation', 'integration', 'analysis/', 'modeling', 'interpretation/', 'visualization', 'figure', 'data', 'analytic', 'pipeline', 'one', 'approach', 'integrating', 'machine', 'learning', 'techniques', 'database', 'applications', 'preprocess', 'data', 'off-line', 'add', 'prediction', 'results', 'new', 'column', 'e.g', 'column', 'food', 'type', 'however', 'off-line', 'preprocessing', 'two-folds', 'restric-', 'tion', 'first', 'requires', 'developers', 'expertise', 'knowledge', 'experience', 'training', 'machine', 'learning', 'models', 'second', 'queries', 'involve', 'attributes', 'object', 'e.g', 'ingredients', 'food', 'predicted', 'preprocessing', 'step', 'addi-', 'tion', 'would', 'waste', 'lot', 'time', 'prediction', 'rows', 'queries', 'read', 'food', 'type', 'column', 'rows', 'e.g', 'due', 'filtering', 'columns', 'another', 'approach', 'carry', 'pre-', 'diction', 'on-line', 'user-defined', 'functions', 'udfs', 'sql', 'query', 'however', 'challenging', 'implement', 'machine', 'learning', 'mod-', 'els', 'udfs', 'database', 'users', 'machine', 'learning', 'models', 'vary', 'lot', 'terms', 'theory', 'implementation', 'also', 'difficult', 'optimize', 'prediction', 'accuracy', 'database', 'engine', 'better', 'solution', 'call', 'corresponding', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', 'apis', 'udfs', 'prediction', 'analysis', 'task', 'cloud', 'service', 'economical', 'elastic', 'easy', 'use', 'with', 'resurgence', 'cloud', 'providers', 'like', 'amazon', 'aws', 'google', 'microsoft', 'azure', 'built', 'machine', 'learning', 'services', 'cloud', 'platforms', 'there', 'two', 'types', 'cloud', 'services', 'the', 'first', 'one', 'provide', 'api', 'specific', 'task', 'e.g', 'image', 'classifi-', 'cation', 'sentiment', 'analysis', 'such', 'apis', 'available', 'amazon', 'aws1', 'google', 'cloud', 'platform2', 'the', 'disadvantage', 'accuracy', 'could', 'low', 'since', 'models', 'trained', 'amazon', 'google', 'data', 'likely', 'different', 'users', 'data', 'the', 'second', 'type', 'service', 'overcomes', 'issue', 'providing', 'training', 'service', 'users', 'upload', 'datasets', 'conduct', 'training', 'this', 'service', 'available', 'amazon', 'aws', 'microsoft', 'azure', 'however', 'limited', 'number', 'ma-', 'chine', 'learning', 'models', 'supported', 'for', 'example', 'sim-', '1https', '//aws.amazon.com/machine-learning/', '2https', '//cloud.google.com/products/machine-learning/', 'ple', 'logistic', 'regression', 'linear', 'regression', 'models3', 'supported', 'amazon', 'deep', 'learning', 'models', 'convolutional', 'neural', 'networks', 'convnets', 'recurrent', 'neural', 'networks', 'rnn', 'included', 'machine', 'learning', 'cloud', 'service', 'needs', 'cover', 'wide', 'range', 'models', 'including', 'deep', 'learning', 'models', 'also', 'provide', 'easy-to-use', 'efficient', 'effective', 'service', 'users', 'with-', 'much', 'machine', 'learning', 'knowledge', 'experience', 'e.g', 'database', 'users', 'considering', 'different', 'models', 'may', 'result', 'different', 'performance', 'terms', 'efficiency', 'e.g', 'latency', 'effectiveness', 'e.g', 'accuracy', 'cloud', 'service', 'select', 'proper', 'models', 'given', 'task', 'moreover', 'machine', 'learning', 'models', 'training', 'algorithms', 'come', 'set', 'hyper-parameters', 'knobs', 'e.g', 'number', 'layers', 'size', 'layer', 'neural', 'network', 'some', 'hyper-parameters', 'vital', 'convergence', 'training', 'algorithm', 'final', 'model', 'performance', 'e.g', 'learning', 'rate', 'stochastic', 'gradient', 'descent', 'sgd', 'algorithm', 'manual', 'hyper-', 'parameter', 'tuning', 'requires', 'rich', 'experience', 'tedious', 'random', 'search', 'bayesian', 'optimization', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approaches', 'however', 'costly', 'train', 'model', 'till', 'convergence', 'may', 'take', 'hundreds', 'hours', 'dis-', 'tributed', 'tuning', 'platform', 'desirable', 'besides', 'training', 'inference4', 'also', 'matters', 'directly', 'affects', 'user', 'experience', 'machine', 'learning', 'products', 'often', 'ensemble', 'multiple', 'models', 'average', 'results', 'boost', 'prediction', 'performance', 'however', 'ensemble', 'modeling', 'incurs', 'larger', 'latency', 'i.e', 'response', 'time', 'compared', 'using', 'single', 'prediction', 'model', 'therefore', 'trade-off', 'be-', 'tween', 'accuracy', 'latency', 'there', 'studies', 'challenges', 'providing', 'ma-', 'chine', 'learning', 'service', 'mlbench', 'compares', 'cloud', 'ser-', 'vice', 'amazon', 'azure', 'set', 'binary', 'classification', 'tasks', 'ease.ml', 'builds', 'training', 'platform', 'model', 'selection', 'aim-', 'ing', 'optimizing', 'resource', 'utilization', 'google', 'vizier', 'distributed', 'hyper-parameter', 'tuning', 'platform', 'provides', 'tuning', 'service', 'systems', 'clipper', 'focuses', 'inference', 'proposing', 'general', 'framework', 'specific', 'optimization', 'effi-', 'ciency', 'accuracy', 'paper', 'present', 'system', 'called', 'rafiki', 'provide', 'training', 'inference', 'services', 'machine', 'learning', 'mod-', 'els', 'with', 'rafiki', 'database', 'users', 'exempted', 'managing', 'hardware', 'resource', 'constructing', 'deep', 'learning', 'models', 'tun-', 'ing', 'hyper-parameters', 'optimizing', 'prediction', 'accuracy', 'speed', 'instead', 'simply', 'upload', 'datasets', 'configure', 'service', 'conduct', 'training', 'deploy', 'model', 'infer-', 'ence', 'cloud', 'service', 'system', 'rafiki', 'manages', 'hard-', 'ware', 'resources', 'failure', 'recovery', 'etc', 'comes', 'set', 'built-in', 'deep', 'learning', 'models', 'popular', 'tasks', 'image', 'text', 'processing', 'addition', 'make', 'following', 'contributions', 'make', 'rafiki', 'easy-to-use', 'efficient', 'effective', 'propose', 'unified', 'system', 'architecture', 'train-', 'ing', 'inference', 'services', 'observe', 'two', 'ser-', 'vices', 'share', 'common', 'components', 'parameter', 'server', 'model', 'parameter', 'storage', 'distributed', 'comput-', 'ing', 'environment', 'distributed', 'hyper-parameter', 'tuning', 'parallel', 'inference', 'sharing', 'underlying', 'storage', 'communication', 'protocols', 'computation', 'resource', 'im-', 'plicitly', 'avoid', 'technical', 'debts', 'moreover', 'com-', '3https', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4we', 'use', 'term', 'deployment', 'inference', 'serving', 'interchange-', 'ably', 'bining', 'two', 'services', 'together', 'rafiki', 'enables', 'instant', 'model', 'deployment', 'training', 'for', 'training', 'service', 'first', 'propose', 'general', 'frame-', 'work', 'distributed', 'hyper-parameter', 'tuning', 'ex-', 'tensible', 'popular', 'hyper-parameter', 'tuning', 'algorithms', 'in-', 'cluding', 'random', 'search', 'bayesian', 'optimization', 'addi-', 'tion', 'propose', 'collaborative', 'tuning', 'scheme', 'specifically', 'deep', 'learning', 'models', 'uses', 'model', 'parameters', 'current', 'top', 'performing', 'training', 'trials', 'initialize', 'new', 'trials', 'for', 'inference', 'service', 'propose', 'scheduling', 'algorithm', 'based', 'reinforcement', 'learning', 'optimize', 'overall', 'ac-', 'curacy', 'reduce', 'latency', 'both', 'algorithms', 'adaptive', 'changes', 'request', 'arrival', 'rate', 'conduct', 'micro-benchmark', 'experiments', 'evaluate', 'performance', 'proposed', 'algorithms', 'reminder', 'paper', 'give', 'system', 'architecture', 'section', 'section', 'describes', 'training', 'service', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'algorithm', 'the', 'deployment', 'ser-', 'vice', 'optimization', 'techniques', 'introduced', 'section', 'sec-', 'tion', 'describes', 'system', 'implementation', 'explain', 'ex-', 'perimental', 'study', 'section', 'introduce', 'related', 'works', 'section', 'related', 'work', 'rafiki', 'saas', 'provides', 'analytics', 'services', 'based', 'ma-', 'chine', 'learning', 'optimization', 'techniques', 'proposed', 'training', 'i.e', 'distributed', 'hyper-parameter', 'tuning', 'inference', 'stage', 'i.e', 'accuracy', 'latency', 'optimization', 'section', 'review', 'related', 'work', 'saas', 'hyper-parameter', 'tuning', 'inference', 'op-', 'timization', 'reinforcement', 'learning', 'adopted', 'rafiki', 'inference', 'optimization', '2.1', 'software', 'service', 'cloud', 'computing', 'changed', 'way', 'operation', 'many', 'companies', 'providing', 'infrastructure', 'service', 'iaas', 'platform', 'service', 'paas', 'software', 'service', 'saas', 'with', 'iaas', 'users', 'companies', 'use', 'remote', 'physical', 'virtual', 'machines', 'instead', 'establishing', 'data', 'center', 'based', 'user', 'require-', 'ments', 'iaas', 'scale', 'compute', 'resources', 'quickly', 'paas', 'e.g.', 'microsoft', 'azure', 'provides', 'development', 'toolkit', 'running', 'envi-', 'ronment', 'adjusted', 'automatically', 'based', 'business', 'demand', 'saas', 'including', 'database', 'service', 'installs', 'soft-', 'ware', 'cloud', 'computing', 'platforms', 'provides', 'application', 'ser-', 'vices', 'simplifies', 'software', 'maintenance', 'the', 'pay', 'pricing', 'model', 'convenient', 'economic', 'small', 'companies', 'research', 'labs', 'recently', 'machine', 'learning', 'especially', 'deep', 'learning', 'gain', 'lot', 'interest', 'due', 'outstanding', 'performance', 'analytic', 'predictive', 'tasks', 'there', 'two', 'primary', 'steps', 'apply', 'machine', 'learning', 'application', 'namely', 'training', 'inference', 'cloud', 'providers', 'like', 'amazon', 'aws', 'microsoft', 'azure', 'google', 'cloud', 'already', 'included', 'services', 'two', 'steps', 'however', 'training', 'services', 'limited', 'support', 'deep', 'learning', 'mod-', 'els', 'inference', 'services', 'customized', 'customers', 'data', 'see', 'explanation', 'section', 'there', 'also', 'research', 'papers', 'towards', 'efficient', 'resource', 'allocation', 'training', 'efficient', 'inference', 'cloud', 'rafiki', 'differs', 'exist-', 'ing', 'cloud', 'services', 'service', 'types', 'optimization', 'techniques', 'firstly', 'rafiki', 'allows', 'users', 'train', 'machine', 'learning', 'including', 'deep', 'learning', 'models', 'data', 'de-', 'ploy', 'inference', 'secondly', 'rafiki', 'special', 'optimization', 'training', 'inference', 'service', 'compared', 'existing', 'approaches', 'explained', 'following', 'two', 'subsections', '2.2', 'hyper-parameter', 'tuning', 'train', 'machine', 'learning', 'model', 'application', 'need', 'decide', 'many', 'hyper-parameters', 'related', 'model', 'structure', 'opti-', 'mization', 'algorithm', 'data', 'preprocessing', 'operations', 'all', 'hyper-', 'parameter', 'tuning', 'algorithms', 'work', 'empirical', 'trials', 'random', 'search', 'randomly', 'selects', 'value', 'hyper-parameter', 'try', 'shown', 'efficient', 'grid', 'search', 'enumerates', 'possible', 'hyper-parameter', 'combinations', 'bayesian', 'optimization', 'assumes', 'optimization', 'function', 'hyper-parameters', 'input', 'inference', 'performance', 'output', 'follows', 'gaussian', 'process', 'samples', 'next', 'point', 'hyper-parameter', 'space', 'based', 'existing', 'trials', 'according', 'acquisition', 'function', 'reinforcement', 'learning', 'recently', 'applied', 'tune', 'archi-', 'tecture', 'related', 'hyper-parameters', 'google', 'vizier', 'provides', 'hyper-parameter', 'tuning', 'service', 'cloud', 'rafiki', 'provides', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'service', 'compatible', 'mentioned', 'hyper-parameter', 'tuning', 'algorithms', 'ad-', 'dition', 'supports', 'collaborative', 'tuning', 'shares', 'model', 'parame-', 'ters', 'across', 'trials', 'our', 'experiments', 'confirm', 'effectiveness', 'collaborative', 'tuning', 'scheme', '2.3', 'inference', 'optimization', 'improve', 'inference', 'accuracy', 'ensemble', 'modeling', 'trains', 'deploys', 'multiple', 'models', 'widely', 'applied', 'for', 'real-time', 'in-', 'ference', 'latency', 'another', 'critical', 'metric', 'inference', 'service', 'noscope', 'proposes', 'specific', 'inference', 'optimization', 'video', 'querying', 'clipper', 'studies', 'multiple', 'optimization', 'techniques', 'improve', 'throughput', 'via', 'batch', 'size', 'reduce', 'latency', 'via', 'caching', 'also', 'proposes', 'model', 'selection', 'ensemble', 'mod-', 'eling', 'using', 'multi-armed', 'bandit', 'algorithms', 'compared', 'clip-', 'per', 'rafiki', 'provides', 'training', 'inference', 'services', 'whereas', 'clipper', 'focuses', 'inference', 'service', 'also', 'clipper', 'op-', 'timizes', 'throughput', 'latency', 'accuracy', 'separately', 'whereas', 'rafiki', 'models', 'together', 'find', 'optimal', 'model', 'selection', 'batch', 'size', 'tensorflow', 'serving', 'tfx', 'provide', 'inference', 'service', 'models', 'trained', 'using', 'tensorflow', 'rafiki', 'clipper', 'implementation', 'agnostic', 'they', 'communicate', 'training', 'inference', 'programs', 'docker', 'containers', 'via', 'rpc', '2.4', 'reinforcement', 'learning', 'reinforcement', 'learning', 'time', 'agent', 'takes', 'one', 'action', 'enters', 'next', 'state', 'the', 'environment', 'returns', 'reward', 'based', 'action', 'states', 'the', 'learning', 'objective', 'maximize', 'aggregated', 'rewards', 'algorithms', 'decide', 'ac-', 'tion', 'take', 'based', 'current', 'state', 'experience', 'gained', 'previous', 'trials', 'exploration', 'policy', 'gradient', 'based', 'algorithms', 'maximize', 'expected', 'reward', 'taking', 'actions', 'following', 'policy', 'function', 'at|st', 'steps', 'equation', 'represents', 'trajectory', 'action', 'state', 'reward', 'tuples', 'decaying', 'factor', 'the', 'expectation', 'taken', 'possible', 'trajec-', 'tories', 'usually', 'implemented', 'using', 'multi-layer', 'perceptron', 'model', 'represents', 'parameters', 'takes', 'state', 'vector', 'input', 'generates', 'action', 'scalar', 'value', 'continuous', 'action', 'softmax', 'output', 'discrete', 'actions', 'equation', 'optimized', 'using', 'stochastic', 'gradient', 'ascent', 'methods', 'equation', 'used', 'surrogate', 'function', 'objective', 'gradient', 'easy', 'com-', 'pute', 'via', 'automatic', 'differentiation', 'eς∼πθ', 't=0', 'γtrt', 'oθj', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'many', 'approaches', 'proposed', 'improve', 'policy', 'gra-', 'dient', 'reducing', 'variance', 'rewards', 'including', 'actor-critic', 'model', 'subtracts', 'reward', 'baseline', 'estimation', 'reward', 'also', 'approximated', 'using', 'neural', 'network', 'like', 'policy', 'function', 'then', 'equations', 'becomesrt−v', 'yuxi', 'done', 'survey', 'deep', 'reinforcement', 'learning', 'including', 'actor-critic', 'model', 'used', 'paper', 'system', 'overview', 'section', 'present', 'system', 'architecture', 'rafiki', 'illustrate', 'usability', 'use', 'cases', 'use', 'rafiki', 'users', 'simply', 'configure', 'training', 'inference', 'jobs', 'either', 'restful', 'apis', 'python', 'sdk', 'figure', 'left', 'column', 'show', 'one', 'image', 'classification', 'example', 'using', 'python', 'sdk', 'the', 'training', 'code', 'consists', 'lines', 'the', 'first', 'line', 'loads', 'images', 'folder', 'rafiki', 'distributed', 'data', 'stor-', 'age', 'hdfs', 'images', 'subfolder', 'labeled', 'subfolder', 'name', 'i.e', 'food', 'name', 'the', 'second', 'line', 'creates', 'configuration', 'object', 'representing', 'hyper-parameter', 'tuning', 'options', 'see', 'section', '4.2', 'details', 'the', 'third', 'line', 'creates', 'training', 'job', 'passing', 'data', 'options', 'input/output', 'shapes', 'tuple', 'list', 'tuples', 'the', 'input-output', 'shapes', 'used', 'model', 'cus-', 'tomization', 'for', 'example', 'convnets', 'usually', 'accept', 'input', 'images', 'fixed', 'shape', 'i.e', 'input', 'shape', 'adapt', 'final', 'output', 'layer', 'generate', 'number', 'outputs', 'output', 'shape', 'could', 'total', 'number', 'classes', 'bounding-box', 'shape', 'the', 'last', 'line', 'submits', 'job', 'restful', 'apis', 'rafiki', 'exe-', 'cution', 'returns', 'job', 'handle', 'job', 'monitoring', 'once', 'training', 'finishes', 'deploy', 'models', 'instantly', 'shown', 'infer.py', 'gets', 'model', 'instances', 'consists', 'model', 'name', 'parameter', 'names', 'retrieving', 'parameter', 'values', 'rafiki', 'parameter', 'server', 'uses', 'second', 'line', 'create', 'inference', 'job', 'given', 'models', 'after', 'model', 'deployed', 'line', 'application', 'users', 'submit', 'requests', 'job', 'prediction', 'shown', 'code', 'query.py', 'ap-', 'plications', 'like', 'mobile', 'app', 'send', 'restful', 'requests', 'query', 'for', 'training', 'job', 'rafiki', 'selects', 'corresponding', 'built-in', 'models', 'based', 'task', 'type', 'the', 'table', 'figure', 'lists', 'built-in', 'tasks', 'models', 'with', 'proliferation', 'machine', 'learning', 'able', 'find', 'open', 'source', 'implementations', 'al-', 'every', 'model', 'figure', 'compares', 'memory', 'footprint', 'ac-', 'curacy', 'inference', 'speed', 'open', 'source', 'convnets5', 'groups', 'convnets', 'compared', 'including', 'inception', 'convnets', 'mobilenet', 'nasnets', 'resnets', 'vggs', 'the', 'accuracy', 'measured', 'based', 'top-1', 'prediction', 'images', 'validation', 'dataset', 'imagenet', 'the', 'inference', 'time', 'mem-', 'ory', 'footprint', 'averaged', 'iterations', 'images', 'i.e', 'batch', 'size=50', '5https', '//github.com/tensorflow/models/tree/master/research/slim/', 'data', 'hyper-tune', 'hyper-tune', 'ensemble', 'modelling', 'resnet', 'parameter', 'task', 'models', 'image', 'classification', 'vgg', 'resnet', 'squeezenet', 'xceptionnet', 'inceptionnet', 'object', 'detection', 'yolo', 'ssd', 'fasterrcnn', 'sentiment', 'analysis', 'temporalcnn', 'fasttext', 'characterrnn', 'resnet', 'resnetvgg', 'vgg', 'vgg', 'master', 'worker', 'rafiki', 'user', 'code', 'rafiki', 'application', 'user', 'code', 'train.py', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'infer.py', 'models', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'models', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'ret', 'label', 'figure', 'overview', 'rafiki', '0.2', '0.4', '0.6', '0.8', '1.0', 'time', 'each', 'iteration', '0.70', '0.75', '0.80', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'figure', 'accuracy', 'inference', 'time', 'memory', 'footprint', 'popular', 'convnets', 'hyper-parameter', 'tuning', 'see', 'section', '4.2', 'conducted', 'every', 'selected', 'model', 'for', 'example', 'two', 'sets', 'hyper-parameters', 'be-', 'ing', 'tested', 'resnet', 'resp', 'vgg', 'shown', 'figure', 'the', 'trained', 'model', 'parameters', 'stored', 'global', 'parameter', 'server', 'persistent', 'distributed', 'in-memory', 'storage', 'once', 'training', 'done', 'inference', 'workers', 'fetch', 'parame-', 'ters', 'efficiently', 'the', 'inference', 'job', 'launches', 'models', 'passed', 'user', 'configuration', 'ensemble', 'modeling', 'see', 'section', 'applied', 'optimize', 'inference', 'accuracy', 'requests', 'application', 'e.g', 'database', 'users', 'rafiki', 'compatible', 'machine', 'learning', 'framework', 'in-', 'cluding', 'tensorflow', 'scikit-learn', 'kears', 'etc.', 'although', 'built', 'top', 'apache', 'singa', 'due', 'efficiency', 'scalable', 'architecture', 'more', 'details', 'rafiki', 'implementation', 'described', 'section', 'training', 'service', 'the', 'training', 'service', 'consists', 'two', 'steps', 'namely', 'model', 'selec-', 'tion', 'hyper-parameter', 'tuning', 'adopt', 'simple', 'model', 'selec-', 'tion', 'strategy', 'rafiki', 'for', 'hyper-parameter', 'tuning', 'first', 'pro-', 'pose', 'general', 'programming', 'model', 'distributed', 'tuning', 'propose', 'collaborative', 'tuning', 'scheme', '4.1', 'model', 'selection', 'every', 'built-in', 'model', 'rafiki', 'registered', 'task', 'e.g', 'im-', 'age', 'classification', 'sentiment', 'analysis', 'each', 'model', 'associated', 'meta', 'data', 'including', 'training', 'cost', 'e.g', 'speed', 'memory', 'consumption', 'performance', 'dataset', 'e.g', 'accuracy', 'area-under-curve', 'ease.ml', 'proposes', 'convert', 'model', 'selection', 'multi-armed', 'bandit', 'problem', 'ev-', 'ery', 'model', 'i.e', 'arm', 'gets', 'chance', 'training', 'after', 'many', 'trials', 'chance', 'under-performed', 'models', 'would', 'decreased', 'observe', 'models', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', 'for', 'example', 'resnet', 'better', 'alexnet', 'squeezenet', 'bunch', 'datasets', 'including', 'ima-', 'genet', 'cifar-106', 'etc..', 'therefore', 'adopt', 'simple', 'model', 'selection', 'strategy', 'without', 'advanced', 'analysis', 'select', 'models', 'similar', 'performance', 'different', 'architectures', 'this', 'create', 'diverse', 'model', 'set', 'whose', 'performance', 'would', 'boosted', 'applying', 'ensemble', 'modeling', '4.2', 'distributed', 'hyper-parameter', 'tuning', 'hyper-parameter', 'tuning', 'usually', 'run', 'many', 'different', 'sets', 'hyper-parameters', 'distributed', 'tuning', 'running', 'instances', 'parallel', 'natural', 'solution', 'reducing', 'tuning', 'time', 'there', '6https', '//www.cs.toronto.edu/', 'kriz/cifar.html', 'table', 'hyper-parameter', 'groups', 'group', 'hyper-parameter', 'example', 'domain', 'data', 'preprocessing', 'image', 'rotation', '0,30', 'image', 'cropping', '0,32', 'whitening', 'pca', 'zca', 'model', 'architecture', 'number', 'layers', 'cluster', 'kernel', 'linear', 'rbf', 'poly', 'training', 'algorithm', 'learning', 'rate', 'weight', 'decay', 'momentum', 'three', 'popular', 'approaches', 'hyper-parameter', 'tuning', 'namely', 'grid', 'search', 'random', 'search', 'bayesian', 'optimization', 'support', 'algorithms', 'need', 'general', 'extensible', 'pro-', 'gramming', 'model', '4.2.1', 'programming', 'model', 'cluster', 'hyper-parameters', 'involved', 'training', 'machine', 'learning', 'model', 'three', 'groups', 'shown', 'table', 'data', 'prepro-', 'cessing', 'adopts', 'different', 'approaches', 'normalize', 'data', 'augment', 'dataset', 'extract', 'features', 'raw', 'data', 'i.e', 'feature', 'en-', 'gineering', 'most', 'machine', 'learning', 'models', 'tuning', 'knobs', 'form', 'architecture', 'hyper-parameters', 'e.g', 'number', 'trees', 'random', 'forest', 'number', 'layers', 'convnets', 'kernel', 'function', 'svm', 'the', 'optimization', 'algorithms', 'especially', 'gradient', 'based', 'optimization', 'algorithms', 'like', 'sgd', 'many', 'hyper-parameters', 'including', 'initial', 'learning', 'rate', 'decaying', 'rate', 'decaying', 'method', 'linear', 'exponential', 'etc', 'from', 'table', 'see', 'hyper-parameters', 'could', 'come', 'range', 'list', 'numbers', 'categories', 'all', 'possible', 'as-', 'signments', 'hyper-parameters', 'construct', 'hyper-parameter', 'space', 'denoted', 'following', 'convention', 'call', 'one', 'point', 'space', 'trial', 'denoted', 'rafiki', 'provides', 'hyper-', 'space', 'class', 'functions', 'shown', 'figure', 'developers', 'specify', 'hyper-parameter', 'space', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'models', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'models', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'class', 'hyperspace', 'def', 'add_range_knob', 'name', 'dtype', 'min', 'max', 'depends=none', 'pre_hook=none', 'post_hook=none', 'def', 'add_categorical_knob', 'name', 'dtype', 'list', 'depends=none', 'pre_hook=none', 'post_hook=none', 'figure', 'hyperspace', 'apis', 'the', 'first', 'function', 'defines', 'domain', 'hyper-parameter', 'range', 'min', 'max', 'dtype', 'represents', 'data', 'type', 'could', 'float', 'integer', 'string', 'depends', 'list', 'hyper-parameters', 'whose', 'values', 'directly', 'affect', 'generation', 'hyper-parameter', 'for', 'example', 'initial', 'learning', 'rate', 'large', 'would', 'prefer', 'larger', 'decay', 'rate', 'decease', 'learning', 'rate', 'quickly', 'there-', 'fore', 'decay', 'rate', 'generated', 'generating', 'learn-', 'ing', 'rate', 'enforce', 'relation', 'add', 'learning', 'rate', 'depends', 'list', 'add', 'post', 'hook', 'function', 'adjust', 'value', 'learning', 'rate', 'decay', 'the', 'second', 'function', 'defines', 'categori-', 'cal', 'hyper-parameter', 'list', 'represents', 'candidates', 'depends', 'pre', 'hook', 'post', 'hook', 'analogous', 'range', 'knob', 'the', 'whole', 'hyper-parameter', 'tuning', 'process', 'one', 'model', 'dataset', 'called', 'study', 'the', 'performance', 'trial', 'de-', 'noted', 'larger', 'indicates', 'better', 'performance', 'e.g', 'ac-', 'curacy', 'for', 'distributed', 'hyper-parameter', 'tuning', 'master', 'multiple', 'workers', 'study', 'the', 'master', 'generates', 'trials', 'workers', 'workers', 'evaluate', 'trials', 'one', 'time', 'worker', 'trains', 'model', 'given', 'trial', 'the', 'workflow', 'study', 'master', 'side', 'explained', 'algorithm', 'the', 'master', 'iter-', 'ates', 'event', 'loop', 'collect', 'performance', 'trial', 'i.e', 'generates', 'next', 'trial', 'trialadvisor', 'im-', 'plements', 'hyper-parameter', 'search', 'algorithm', 'e.g', 'random', 'search', 'bayesian', 'optimization', 'stops', 'trials', 'test', 'user', 'configured', 'stop', 'criteria', 'satisfied', 'e.g', 'total', 'num-', 'ber', 'trials', 'finally', 'best', 'parameters', 'put', 'parameter', 'server', 'inference', 'service', 'the', 'worker', 'side', 'keeps', 'requesting', 'trials', 'master', 'conducting', 'training', 'reporting', 'results', 'master', 'algorithm', 'study', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', 'trial', 'adv.next', 'msg.worker', 'trial', 'nil', 'break', 'else', 'send', 'msg.worker', 'trial', 'end', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'else', 'msg.type', 'kfinish', 'num', 'adv.is', 'best', 'msg.worker', 'send', 'msg.worker', 'kput', 'end', 'end', 'end', 'return', 'adv.best', 'trial', '4.2.2', 'collaborative', 'tuning', 'section', 'introduced', 'distributed', 'hyper-', 'parameter', 'tuning', 'framework', 'next', 'extend', 'framework', 'proposing', 'collaborative', 'tuning', 'scheme', 'sgd', 'widely', 'used', 'training', 'machine', 'learning', 'models', 'often', 'observe', 'training', 'loss', 'stays', 'plateau', 'drops', 'suddenly', 'decrease', 'learning', 'rate', 'sgd', 'e.g', '0.1', '0.01', '0.01', '0.001', 'based', 'observation', 'see', 'hyper-parameters', 'changed', 'training', 'get', 'plateau', 'de-', 'rive', 'better', 'performance', 'therefore', 'fix', 'model', 'architec-', 'ture', 'tune', 'hyper-parameters', 'group', 'table', 'model', 'parameters', 'trained', 'using', 'one', 'hyper-parameter', 'trial', 'reused', 'initialize', 'model', 'another', 'trial', 'selecting', 'parameters', 'top', 'performing', 'trials', 'continue', 'hyper-parameter', 'tuning', 'old', 'trials', 'like', 'pre-', 'training', 'fact', 'good', 'model', 'initialization', 'results', 'faster', 'convergence', 'better', 'performance', 'users', 'typically', 'fine-tune', 'popular', 'convnet', 'architectures', 'datasets', 'conse-', 'quently', 'collaborative', 'tuning', 'scheme', 'likely', 'converge', 'good', 'state', 'straightforward', 'tune', 'hyper-parameters', 'related', 'model', 'architecture', 'this', 'architecture', 'changes', 'parameters', 'also', 'change', 'for', 'example', 'parameters', 'convolution', 'layer', 'filter', 'size', '3x3', 'used', 'initialize', 'convolution', 'layer', 'another', 'convnet', 'whose', 'filter', 'size', '5x5', 'however', 'architecture', 'tuning', 'many', 'architectures', 'available', 'likely', 'architectures', 'share', 'config-', 'urations', 'one', 'convolution', 'layer', 'for', 'instance', 'convnet', '3rd', 'convolution', 'layer', 'convnet', '3rd', 'layer', 'convo-', 'lution', 'setting', 'use', 'parametersw', 'convnet', '3rd', 'layer', 'initialize', 'convnet', '3rd', 'layer', 'store', 'allw', 'parameter', 'server', 'fetch', 'shape', 'matched', 'initialize', 'layers', 'new', 'trials', 'convnets', 'performance', 'new', 'trail', 'better', 'older', 'one', 'overwrite', 'parameter', 'server', 'new', 'values', '0.1', '0.01', '0.1', '0.01', '0.1', 'figure', 'collaborative', 'tuning', 'example', 'the', 'whole', 'process', 'illustrated', 'figure', 'workers', 'running', 'trials', 'tune', 'hyper-parameters', 'e.g', 'learning', 'rate', 'model', 'after', 'performance', 'worker', 'stops', 'increasing', 'the', 'training', 'stops', 'automatically', 'according', 'early', 'stopping', 'criteria', 'e.g', 'training', 'loss', 'decreasing', 'consecutive', 'epochs', 'early', 'stopping', 'widely', 'used', 'training', 'machine', 'learning', 'models7', 'the', 'new', 'trial', 'worker', 'uses', 'pa-', 'rameters', 'current', 'best', 'worker', 'the', 'work', 'done', 'serves', 'pre-training', 'new', 'trial', 'similarly', 'enters', 'plateau', 'master', 'instructs', 'start', 'new', 'trial', 'using', 'parameters', 'whose', 'model', 'best', 'performance', 'point', 'time', 'the', 'control', 'flow', 'collaborative', 'tuning', 'scheme', 'described', 'algorithm', 'similar', 'algorithm', 'except', 'master', 'instructs', 'worker', 'save', 'model', 'parameters', 'global', 'pa-', 'rameter', 'server', 'line', 'model', 'performance', 'significantly', 'larger', 'current', 'best', 'performance', 'line', 'the', 'performance', 'difference', 'i.e', 'conf.delta', 'configuration', 'parameter', 'hyper-', 'conf', 'set', 'according', 'user', 'expectation', 'performance', 'model', 'for', 'example', 'mnist', 'image', 'classi-', 'fication', 'improvement', '0.1', 'large', 'current', 'best', 'performance', 'for', 'cifar-10', 'image', 'classification', 'may', 'set', 'delta', '0.5', 'best', 'accuracy', '97.4', 'means', 'bigger', 'improvement', 'space', 'notice', 'bad', 'parameter', 'initialization', 'degrades', 'perfor-', 'mance', 'experiments', 'this', 'serious', 'random', 'search', 'because', 'checkpoint', 'one', 'trial', 'poor', 'accuracy', 'would', 'affect', 'next', 'trials', 'model', 'parameters', 'initialized', 'poor', 'state', 'resolve', 'problem', 'α-greedy', 'strategy', 'intro-', 'duced', 'implementation', 'initializes', 'model', 'param-', 'eters', 'either', 'random', 'initialization', 'pre-trained', 'model', 'checkpoint', 'file', 'threshold', 'represents', 'probability', 'choos-', 'ing', 'random', 'initialization', '1-α', 'represents', 'probability', 'us-', 'ing', 'pre-trained', 'checkpoint', 'files', 'decreases', 'gradually', 'decrease', 'chance', 'random', 'initialization', 'i.e', 'increasing', 'chance', 'costudy', 'this', 'α-greedy', 'strategy', 'widely', 'used', 'reinforcement', 'learning', 'balance', 'exploration', 'exploitation', 'inference', 'service', '7https', '//keras.io/callbacks/', 'earlystopping', 'algorithm', 'costudy', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'best', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', '...', 'algorithm', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'msg.p', 'best', 'conf.delta', 'send', 'msg.worker', 'kput', 'best', 'msg.p', 'else', 'adv.early', 'stopping', 'msg.worker', 'conf', 'send', 'msg.worker', 'kstop', 'end', 'else', 'msg.type', 'kfinish', 'num', 'end', 'end', 'return', 'adv.best', 'trial', 'inference', 'service', 'provides', 'real-time', 'request', 'serving', 'deploy-', 'ing', 'trained', 'model', 'other', 'services', 'like', 'database', 'services', 'sim-', 'ply', 'optimize', 'throughput', 'constraint', 'latency', 'set', 'manually', 'service', 'level', 'objective', 'slo', 'denoted', 'e.g', '0.1', 'seconds', 'for', 'machine', 'learning', 'services', 'accuracy', 'becomes', 'important', 'optimization', 'objective', 'the', 'accuracy', 'refers', 'wide', 'range', 'performance', 'measurements', 'e.g', 'negative', 'error', 'precision', 'recall', 'area', 'curve', 'etc', 'larger', 'value', 'accuracy', 'indicates', 'better', 'performance', 'set', 'latency', 'hard', 'constraint', 'shown', 'equation', 'overdue', 'requests', 'would', 'get', 'time', 'responses', 'typically', 'delayed', 'response', 'better', 'error', 'time', 'end-users', 'hence', 'process', 'requests', 'queue', 'se-', 'quentially', 'following', 'fifo', 'first-in-first-out', 'the', 'objective', 'maximize', 'accuracy', 'minimize', 'exceeding', 'time', 'accord-', 'ing', 'however', 'typically', 'trade-off', 'accuracy', 'latency', 'for', 'example', 'ensemble', 'modeling', 'models', 'increases', 'accuracy', 'latency', 'shall', 'optimize', 'model', 'selection', 'ensemble', 'modeling', 'section', '5.2', 'before', 'discuss', 'simpler', 'case', 'single', 'inference', 'model', 'table', 'summarizes', 'notations', 'used', 'section', 'maxaccuracy', 'subject', '5.1', 'single', 'inference', 'model', 'when', 'one', 'single', 'model', 'deployed', 'application', 'accuracy', 'inference', 'service', 'fixed', 'system', 'per-', 'spective', 'therefore', 'optimization', 'objective', 'reduced', 'mini-', 'mizing', 'exceeding', 'time', 'formalized', 'equation', 'min', 's∈smax', '|s|', 'the', 'latency', 'request', 'includes', 'waiting', 'time', 'queue', 'inference', 'time', 'depends', 'model', 'complexity', 'hardware', 'efficiency', 'i.e', 'flops', 'batch', 'size', 'the', 'batch', 'size', 'decides', 'number', 'requests', 'processed', 'to-', 'gether', 'modern', 'processing', 'units', 'like', 'cpu', 'gpu', 'exploit', 'data', 'parallelism', 'techniques', 'e.g', 'simd', 'improve', 'throughput', 'reduce', 'computation', 'cost', 'hence', 'large', 'batch', 'size', 'necessary', 'table', 'notations', 'name', 'definition', 'request', 'list', 'model', 'list', 'latency', 'requirement', 'one', 'batch', 'size', 'candidate', 'list', 'k−th', 'oldest', 'requests', 'queue', 'oldest', 'requests', 'latest', '|q|', 'requests', 'inference', 'time', 'batch', 'size', 'inference', 'time', 'model', 'batch', 'size', 'waiting', 'time', 'request', 'queue', 'latency', 'waiting', 'inference', 'time', 'request', 'balancing', 'factor', 'accuracy', 'latency', 'binary', 'vector', 'model', 'selection', 'reward', 'function', 'set', 'requests', 'saturate', 'parallelism', 'capacity', 'once', 'model', 'deployed', 'cloud', 'platform', 'model', 'complexity', 'hardware', 'efficiency', 'fixed', 'therefore', 'rafiki', 'tunes', 'batch', 'size', 'optimize', 'latency', 'construct', 'large', 'batch', 'e.g', 'requests', 'delay', 'processing', 'requests', 'arrive', 'may', 'incur', 'large', 'latency', 'old', 'requests', 'request', 'arrival', 'rate', 'low', 'the', 'op-', 'timal', 'batch', 'size', 'thus', 'influenced', 'slo', 'queue', 'status', 'e.g', 'waiting', 'time', 'request', 'arrival', 'rate', 'varies', 'along', 'time', 'since', 'inference', 'time', 'two', 'similar', 'batch', 'sizes', 'varies', 'lit-', 'tle', 'e.g', 'b=8', 'b=9', 'candidate', 'batch', 'size', 'list', 'include', 'values', 'significant', 'difference', 'w.r.t', 'in-', 'ference', 'time', 'e.g', '...', 'the', 'largest', 'batch', 'size', 'determined', 'system', 'gpu', 'memory', 'latency', 'processing', 'batch', 'requests', 'determined', 'hard-', 'ware', 'resource', 'e.g', 'gpu', 'memory', 'model', 'complexity', 'figure', 'shows', 'inference', 'time', 'memory', 'footprint', 'accuracy', 'popular', 'convnets', 'trained', 'imagenet', 'algorithm', 'shows', 'greedy', 'solution', 'problem', 'al-', 'ways', 'applies', 'largest', 'batch', 'size', 'possible', 'queue', 'length', 'i.e', 'number', 'requests', 'queue', 'larger', 'largest', 'batch', 'size', 'max', 'oldest', 'requests', 'processed', 'one', 'batch', 'otherwise', 'waits', 'oldest', 'request', 'overdue', 'checked', 'line', 'largest', 'batch', 'size', 'smaller', 'equal', 'queue', 'length', 'line', 'back-off', 'constant', 'equivalent', 'reducing', 'batch', 'size', 'additive-increase-multiplicative-decrease', 'scheme', 'aimd', 'e.g', '0.1τ', 'algorithm', 'inference', 'queue', 'model', 'true', 'maxb', 'len', 'm.infer', 'deque', 'else', 'max', 'len', 'm.infer', 'deque', 'end', 'end', 'end', '5.2', 'multiple', 'inference', 'models', 'single', 'model', 'two', 'models', 'three', 'models', 'four', 'models', 'ensemble', 'method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'figure', 'accuracy', 'ensemble', 'modeling', 'different', 'models', 'ensemble', 'modeling', 'effective', 'popular', 'approach', 'im-', 'prove', 'inference', 'accuracy', 'give', 'example', 'compare', 'performance', 'different', 'ensemble', 'convnets', 'shown', 'figure', 'majority', 'voting', 'applied', 'aggregate', 'predictions', 'the', 'accuracy', 'evaluated', 'validation', 'dataset', 'imagenet', 'generally', 'models', 'accuracy', 'better', 'the', 'exception', 'ensemble', 'resnet', '101', 'inception', 'good', 'single', 'best', 'model', 'i.e', 'inception', 'resnet', 'fact', 'prediction', 'ensemble', 'modeling', 'incep-', 'tion', 'tie', 'prediction', 'model', 'best', 'accuracy', 'selected', 'final', 'prediction', 'parallel', 'ensemble', 'modeling', 'running', 'one', 'model', 'per', 'node', 'gpu', 'straight-forward', 'way', 'scale', 'system', 'improve', 'throughput', 'however', 'latency', 'could', 'high', 'due', 'stragglers', 'for', 'example', 'shown', 'figure', 'node', 'running', 'nasnet', 'large', 'would', 'slow', 'although', 'accuracy', 'high', 'addition', 'en-', 'semble', 'modeling', 'also', 'costly', 'terms', 'throughput', 'com-', 'pared', 'serving', 'different', 'requests', 'different', 'nodes', 'i.e', 'ensemble', 'see', 'trade-off', 'latency', 'throughput', 'accuracy', 'controlled', 'model', 'selec-', 'tion', 'requests', 'arrive', 'slowly', 'simply', 'run', 'models', 'batch', 'get', 'best', 'accuracy', 'however', 'request', 'arrival', 'rate', 'high', 'like', 'section', '5.1', 'select', 'different', 'models', 'different', 'requests', 'increase', 'throughput', 'reduce', 'latency', 'addition', 'model', 'selection', 'current', 'batch', 'also', 'affects', 'next', 'batch', 'for', 'example', 'use', 'models', 'batch', 'next', 'batch', 'wait', 'least', 'one', 'model', 'finishes', 'solve', 'equation', 'balance', 'accuracy', 'latency', 'get', 'single', 'optimization', 'objective', 'move', 'latency', 'term', 'objective', 'shown', 'equation', 'maximizes', 'reward', 'functionr', 'related', 'prediction', 'accuracy', 'penalizes', 'overdue', 'requests', 'balances', 'accuracy', 'latency', 'objective', 'ground', 'truth', 'request', 'available', 'evaluating', 'accuracy', 'normal', 'case', 'find', 'surrogate', 'accuracy', 'maxr', 'like', 'analysis', 'single', 'inference', 'model', 'need', 'consider', 'batch', 'size', 'selection', 'well', 'difficult', 'design', 'optimal', 'policy', 'complex', 'decision', 'making', 'problem', 'decides', 'model', 'selection', 'batch', 'size', 'selection', 'paper', 'propose', 'optimize', 'equation', 'using', 'reinforcement', 'learning', 'optimizes', 'objective', 'long', 'term', 'trying', 'different', 'actions', 'entering', 'corresponding', 'states', 'collect', 'rewards', 'setting', 'reward', 'equation', 'defining', 'actions', 'model', 'selection', 'batch', 'selection', 'apply', 'optimization', 'problem', 'three', 'core', 'concepts', 'namely', 'action', 'reward', 'state', 'once', 'three', 'concepts', 'defined', 'apply', 'existing', 'al-', 'gorithms', 'optimization', 'define', 'three', 'concepts', 'w.r.t', 'optimization', 'problem', 'follows', 'first', 'state', 'space', 'consists', 'queue', 'status', 'represented', 'waiting', 'time', 'request', 'queue', 'the', 'waiting', 'time', 'requests', 'form', 'feature', 'vec-', 'tor', 'generate', 'fixed', 'length', 'feature', 'vector', 'pad', 'shorter', 'queues', 'truncate', 'longer', 'queues', 'model', 'status', 'represented', 'vector', 'including', 'inference', 'time', 'different', 'models', 'different', 'batch', 'sizes', 'i.e', 'left', 'time', 'finish', 'existing', 'requests', 'dispatched', 'the', 'two', 'feature', 'vectors', 'concatenated', 'state', 'feature', 'vector', 'input', 'model', 'generating', 'action', 'second', 'action', 'decides', 'batch', 'size', 'model', 'selection', 'represented', 'binary', 'vector', 'length', 'selected', 'unselected', 'the', 'action', 'space', 'size', 'thus', '2|m|−', '|b|', 'exclude', 'case', 'i.e', 'none', 'models', 'selected', 'third', 'following', 'equation', 'reward', 'one', 'batch', 'requests', 'without', 'ground', 'truth', 'labels', 'defined', 'equation', 'accuracy', 'selected', 'models', 'ensemble', 'modeling', 'paper', 'use', 'accuracy', 'evaluated', 'validation', 'dataset', 'surrogate', 'accu-', 'racy', 'experiment', 'use', 'imagenet', 'validation', 'dataset', 'evaluate', 'accuracy', 'different', 'ensemble', 'combinations', 'im-', 'age', 'classification', 'the', 'results', 'shown', 'figure', 'the', 'reward', 'shown', 'equation', 'considers', 'accuracy', 'latency', 'indirectly', 'represented', 'number', 'overdue', 'requests', 'number', 'requests', 'batch|l', 'with', 'state', 'action', 'reward', 'well', 'defined', 'apply', 'actor-critic', 'algorithm', 'optimize', 'overall', 'reward', 'learn-', 'ing', 'good', 'policy', 'selecting', 'models', 'batch', 'size', 'system', 'implementation', 'section', 'introduce', 'implementation', 'details', 'rafiki', 'including', 'cluster', 'management', 'data', 'parameter', 'storage', 'failure', 'recovery', '6.1', 'cluster', 'management', 'manager', 'master', 'data', 'worker', 'worker', 'parameter', 'master', 'data', 'worker', 'worker', 'parameter', 'train', 'inference', 'node', 'node', 'cnode', 'figure', 'rafiki', 'cluster', 'topology', 'rafiki', 'uses', 'kubernetes', 'manage', 'docker', 'containers', 'run', 'masters', 'workers', 'data', 'servers', 'parameter', 'servers', 'shown', 'figure', 'docker', 'container', 'widely', 'used', 'applica-', 'tion', 'deployment', 'bundles', 'application', 'code', 'e.g', 'training', 'inference', 'code', 'libraries', 'e.g', 'keras', 'avoid', 'tedious', 'en-', 'vironment', 'setup', 'new', 'models', 'hyper-parameter', 'tuning', 'algorithms', 'ensemble', 'modeling', 'approaches', 'deployed', 'new', 'docker', 'containers', 'physical', 'node', 'could', 'multiple', 'masters', 'workers', 'different', 'jobs', 'including', 'training', 'infer-', 'ence', 'jobs', 'these', 'jobs', 'started', 'rafiki', 'manager', 'accepts', 'job', 'submissions', 'users', 'see', 'figure', 'once', 'job', 'launched', 'users', 'communicate', 'master', 'directly', 'get', 'training', 'progress', 'submit', 'query', 'requests', 'rafiki', 'prefers', 'locate', 'master', 'workers', 'job', 'physical', 'node', 'avoid', 'network', 'communication', 'overhead', '6.2', 'data', 'parameter', 'storage', 'deep', 'learning', 'models', 'typically', 'trained', 'large', 'datasets', 'would', 'consume', 'lot', 'space', 'stored', 'cpu', 'memory', 'there-', 'fore', 'rafiki', 'uses', 'hdfs', 'data', 'storage', 'data', 'nodes', 'also', 'docker', 'containers', 'users', 'upload', 'datasets', 'hdfs', 'via', 'rafiki', 'utility', 'functions', 'e.g', 'rafiki.import', 'images', 'see', 'fig-', 'ure', 'the', 'training', 'dataset', 'downloaded', 'local', 'directory', 'be-', 'fore', 'training', 'via', 'rafiki.download', 'passing', 'dataset', 'name', 'for', 'model', 'parameters', 'rafiki', 'distributed', 'parameter', 'server', 'the', 'parameter', 'server', 'designed', 'special', 'optimiza-', 'tion', 'hyper-parameter', 'training', 'inference', 'particular', 'hyper-parameters', 'cached', 'memory', 'accessed', 'frequently', 'e.g', 'rafiki', 'hyper-parameter', 'training', 'otherwise', 'stored', 'hdfs', 'the', 'parameters', 'trained', 'model', 'different', 'datasets', 'shared', 'long', 'privacy', 'setting', 'public', 'shown', 'training', 'warm-up', 'using', 'parameters', 'pre-trained', 'datasets', 'speeds', 'training', '6.3', 'failure', 'recovery', 'for', 'hyper-parameter', 'training', 'inference', 'services', 'workers', 'stateless', 'hence', 'rafiki', 'manager', 'easily', 'recover', 'nodes', 'running', 'new', 'docker', 'container', 'registering', 'training', 'inference', 'master', 'however', 'masters', 'state', 'information', 'for', 'example', 'master', 'training', 'ser-', 'vice', 'records', 'current', 'best', 'hyper-parameter', 'trial', 'the', 'master', 'inference', 'service', 'state', 'action', 'reward', 'reinforce-', 'ment', 'learning', 'rafiki', 'checkpoints', 'small', 'state', 'information', 'masters', 'fast', 'failure', 'recovery', 'experimental', 'study', 'section', 'evaluate', 'scalability', 'efficiency', 'effec-', 'tiveness', 'rafiki', 'hyper-parameter', 'tuning', 'inference', 'ser-', 'vice', 'optimization', 'respectively', 'the', 'experiments', 'conducted', 'three', 'machines', 'nvidia', 'gtx', '1080ti', 'gpus', 'intel', 'e5-1650v4', 'cpu', '64gb', 'memory', '7.1', 'evaluation', 'hyper-parameter', 'tuning', 'task', 'dataset', 'test', 'rafiki', 'distributed', 'hyper-parameter', 'tuning', 'service', 'running', 'tune', 'hyper-parameters', 'deep', 'convnets', 'cifar-10', 'image', 'classification', 'cifar-10', 'popular', 'benchmark', 'dataset', 'rgb', 'images', 'categories', 'each', 'category', '5000', 'training', 'images', 'including', '1000', 'validation', 'images', '1000', 'test', 'images', 'all', 'images', 'size', '32x32', 'there', 'standard', 'sequence', 'preprocessing', 'steps', 'cifar-10', 'subtracts', 'mean', 'divides', 'standard', 'deviation', 'channel', 'computed', 'training', 'images', 'pads', 'image', 'pixels', 'zeros', 'side', 'obtain', '40x40', 'pixel', 'image', 'ran-', 'domly', 'crops', '32x32', 'patch', 'flips', 'horizontal', 'direction', 'image', 'randomly', 'probability', '0.5', '100', '200', 'trial', 'index', 'lid', 'without', 'costudy', '100', '200', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', '200', 'total', 'training', 'epochs', 'lid', 'wihtout', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tuning', 'based', 'random', 'search', '100', 'trial', 'index', 'lid', 'without', 'costudy', '100', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', 'total', 'training', 'epochs', 'lid', 'without', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tuning', 'based', 'bayesian', 'optimization', '7.1.1', 'tuning', 'optimization', 'hyper-parameters', 'fix', 'convnet', 'architecture', 'shown', 'table', 'convolution', 'layers', 'the', 'hyper-parameters', 'tuned', 'optimization', 'algorithm', 'including', 'momen-', 'tum', 'learning', 'rate', 'weight', 'decay', 'coefficients', 'dropout', 'rates', 'standard', 'deviations', 'gaussian', 'distribution', 'weight', 'initial-', 'ization', 'run', 'trial', 'early', 'stopping', 'terminates', 'training', 'validation', 'loss', 'stops', 'decreasing', 'compare', 'naı̈ve', 'distributed', 'tuning', 'algorithm', 'i.e', 'study', 'algorithm', 'collaborative', 'tuning', 'algorithm', 'i.e', 'cos-', 'tudy', 'algorithm', 'different', 'trialadvisor', 'algorithms', 'figure', 'shows', 'comparison', 'using', 'random', 'search', 'trialadvisor', 'particular', 'point', 'figure', 'stands', 'one', 'trial', 'see', 'top', 'area', 'costudy', 'denser', 'study', 'words', 'costudy', 'likely', 'get', 'better', 'performance', 'this', 'confirmed', 'figure', 'shows', 'costudy', 'trials', 'high', 'accuracy', 'i.e', 'accuracy', 'study', 'fewer', 'trials', 'low', 'accuracy', 'i.e.', 'accuracy≤50', 'figure', 'illustrates', 'tuning', 'progress', 'two', 'approaches', 'point', 'line', 'represents', 'best', 'performance', 'among', 'trials', 'conducted', 'far', 'the', 'x-axis', 'total', 'number', 'training', 'epochs8', 'corre-', 'sponds', 'tuning', 'time', '=total', 'number', 'epochs', 'times', 'time', 'per', 'epoch', 'observe', 'costudy', 'faster', 'study', 'achieves', 'better', 'accuracy', 'study', 'notice', 'validation', 'ac-', 'curacy', 'high', 'therefore', 'small', 'difference', 'indicates', 'significant', 'improvement', 'figure', 'compares', 'study', 'costudy', 'using', 'gaussian', 'process', 'based', 'bayesian', 'optimization', 'trialadvisor', 'comparing', 'figure', 'figure', 'see', 'points', 'top', 'area', 'figures', 'words', 'better', 'random', '8training', 'model', 'scanning', 'dataset', 'called', 'one', 'epoch', '9https', '//github.com/scikit-optimize', 'searchwhich', 'observed', 'papers', 'figure', 'costudy', 'points', 'right', 'bottom', 'area', 'cos-', 'tudy', 'after', 'in-depth', 'inspection', 'found', 'points', 'trials', 'initialized', 'randomly', 'instead', 'pre-trained', 'models', 'for', 'study', 'always', 'uses', 'random', 'initialization', 'hence', 'algo-', 'rithm', 'fixed', 'prior', 'initialization', 'method', 'however', 'costuy', 'initialization', 'pre-trained', 'models', 'time', 'these', 'random', 'initialization', 'trials', 'change', 'prior', 'thus', 'get', 'biased', 'estimation', 'gaussian', 'process', 'leads', 'poor', 'accuracy', 'since', 'decaying', 'reduce', 'chance', 'random', 'initialization', 'fewer', 'fewer', 'points', 'right', 'bottom', 'area', 'overall', 'costudy', 'achieves', 'better', 'accuracy', 'shown', 'figure', 'figure', 'study', 'scalability', 'rafiki', 'varying', 'number', 'work-', 'ers', 'figure', 'compares', 'jobs', 'running', 'gpus', 'respectively', 'each', 'point', 'curves', 'figure', 'represents', 'best', 'validation', 'performance', 'among', 'trials', 'tested', 'far', 'the', 'x-axis', 'wall', 'clock', 'time', 'see', 'gpus', 'tuning', 'becomes', 'faster', 'scales', 'almost', 'linearly', '7.2', 'evaluation', 'inference', 'optimization', 'use', 'image', 'classification', 'application', 'test', 'opti-', 'mization', 'techniques', 'introduced', 'section', 'the', 'inference', 'models', 'convnets', 'trained', 'imagenet', 'benchmark', 'dataset', 'imagenet', 'popular', 'image', 'classification', 'benchmark', 'many', 'open-source', 'convnets', 'trained', 'figure', '1.2', 'million', 'rgb', 'training', 'images', '50,000', 'validation', 'images', 'our', 'environment', 'simulator', 'randomly', 'samples', 'images', 'validation', 'dataset', 'requests', 'the', 'number', 'requests', 'deter-', 'mined', 'follows', 'first', 'simulate', 'scenario', 'high', 'arriving', 'rate', 'low', 'arriving', 'rate', 'set', 'arriving', 'rate', 'based', 'maximum', 'throughput', 'minimum', 'throughput', 'specifically', 'maximum', 'throughput', 'sum', 'models', 'throughput', 'achieved', 'models', 'run', 'asynchronously', '250', '500', '750', '1000', '1250', '1500', 'time', 'seconds', '100', '200', '300', '400', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'number', 'workers', '500', '1000', '1500', '250', '500', '750', '1000', 'wall', 'time', 'minutes', 'lid', 'worker', 'workers', 'workers', 'workers', 'figure', 'scalability', 'test', 'distributed', 'hyper-parameter', 'tuning', 't/2t/4', '0.1t', '0.1t', 'figure', 'sine', 'function', 'controlling', 'request', 'arriving', 'rate', 'process', 'different', 'batches', 'requests', 'contrast', 'mod-', 'els', 'run', 'synchronously', 'slowest', 'model', 'throughput', 'minimum', 'throughput', 'second', 'use', 'sine', 'function', 'extreme', 'throughput', 'values', 'define', 'request', 'arriving', 'rate', 'i.e', 'γsin', 'the', 'slope', 'intercept', 'derived', 'solving', 'equation', 'cycle', 'period', 'configured', '500', 'experiments', 'the', 'first', 'equation', 'make', 'sure', 'requests', 'generated', 'cycle', 'period', 'figure', '0.2t', 'way', 'simulating', 'real-life', 'environment', 'overwhelming', 'requests', 'coming', 'times', 'the', 'second', 'equa-', 'tion', 'make', 'sure', 'highest', 'arriving', 'rate', 'large', 'otherwise', 'request', 'queue', 'would', 'filled', 'quickly', 'new', 'requests', 'dropped', 'finally', 'small', 'random', 'noise', 'applied', 'prevent', 'algorithm', 'remembering', 'sine', 'function', 'conclude', 'number', 'new', 'requests', 'γsin', '0.1', 'time', 'span', 'last', 'invocation', 'simulator', 'current', 'time', 'sin', 't/2−', '0.2×', '2t/2', 'sin', 't/2', '1.1×', '7.2.1', 'single', 'inference', 'model', 'use', 'inception', 'trained', 'imagenet', 'single', 'infer-', 'ence', 'model', 'besides', 'greedy', 'algorithm', 'algorithm', 'also', 'run', 'algorithm', 'section', '5.2', 'decide', 'batch', 'size', 'the', 'state', 'section', '5.2', 'except', 'model', 'related', 'status', 'removed', 'the', 'batch', 'size', 'list', 'the', 'maximum', 'throughput', 'max', 'b/c', '64/0.23', '272', 'images/second', 'minimum', 'throughput', 'min', 'b/c', '16/0.07', '228', 'set', '0.56s', 'figure', 'compares', 'algorithm', 'greedy', 'algorithm', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'see', 'iterations', 'performs', 'similarly', 'greedy', 'algorithm', 'request', 'arriving', 'rate', 'high', 'when', 'low', 'performs', 'better', 'greedy', 'algorithm', 'this', 'requests', 'left', 'queue', 'length', 'equal', 'batch', 'size', 'line', 'algorithm', 'these', 'left', 'requests', 'likely', 'overdue', 'new', 'requests', 'coming', 'slowly', 'form', 'new', 'batch', 'figure', 'compares', 'algorithm', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'defined', 'based', 'minimum', 'throughput', 'see', 'performs', 'better', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'either', 'high', 'low', 'overall', 'since', 'arriving', 'rate', 'smaller', 'figure', 'fewer', 'overdue', 'requests', '7.2.2', 'multiple', 'inference', 'models', 'following', 'experiments', 'select', 'inception', 'inception', 'inception', 'resnet', 'construct', 'model', 'list', 'the', 'maxi-', 'mum', 'throughput', 'minimum', 'throughput', '572', 'requests/second', '128', 'requests/second', 'respectively', 'the', 'experimental', 'results', 'plotted', 'figure', 'figure', 'figure', 'the', 'legend', 'text', 'overdue', 'represents', 'number', 'overdue', 'requests', 'per', 'sec-', 'ond', 'arriving', 'stands', 'request', 'arriving', 'rate', 'compare', 'algorithm', 'two', 'baseline', 'algorithms', 're-', 'spectively', 'for', 'baseline', 'use', 'greedy', 'algorithm', 'find', 'batch', 'size', 'they', 'differ', 'model', 'selection', 'strategy', 'the', 'first', 'baseline', 'runs', 'models', 'synchronously', 'batch', 'requests', 'correspondingly', 'requests', 'generated', 'using', 'rate', 'based', 'from', 'figure', '14a', 'figure', '14b', 'see', 'greedy', 'algorithm', 'fixed', 'accuracy', 'whereas', 'algorithm', 'ac-', 'curacy', 'high', 'resp', 'low', 'rate', 'low', 'resp', 'high', '250', '500', '750', '1000', '1250', '1500', 'time', 'seconds', '100', '150', '200', '250', '300', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'time', 'seconds', '0.78', '0.80', '0.82', '0.84', '100', '125', '150', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'seconds', '0.802', '0.804', '0.806', '0.808', '0.810', '100', '125', '150', 'algorithm', '500', '1000', 'time', 'seconds', '100', '150', '200', 'overdue', 'arriving', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'seconds', '100', '150', '200', 'overdue', 'arriving', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'time', 'seconds', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'seconds', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'algorithm', '500', '1000', 'time', 'seconds', '200', '400', '600', '800', '1000', 'overdue', 'arriving', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'seconds', '200', '400', '600', '800', '1000', 'overdue', 'arriving', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', '2000', '4000', '6000', 'time', 'seconds', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'seconds', '0.795', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'seconds', '100', '150', '200', 'overdue', 'arriving', '2000', '4000', '6000', 'time', 'seconds', '100', '150', '200', 'overdue', 'arriving', 'figure', 'comparison', 'effect', 'different', 'algorithm', 'fact', 'synchronous', 'algorithm', 'always', 'uses', 'models', 'en-', 'semble', 'modelling', 'whereas', 'algorithm', 'uses', 'fewer', 'models', 'ensemble', 'modeling', 'arriving', 'rate', 'high', 'since', 'request', 'arriving', 'rate', 'low', 'baseline', 'able', 'handle', 'al-', 'requests', 'similar', 'figure', 'overdue', 'requests', 'figure', '14c', 'due', 'mismatch', 'queue', 'size', 'batch', 'size', 'algorithm', 'the', 'second', 'baseline', 'runs', 'models', 'asynchronously', 'one', 'model', 'per', 'batch', 'requests', 'words', 'ensemble', 'mod-', 'eling', 'correspondingly', 'requests', 'generated', 'using', 'rate', 'based', 'see', 'better', 'accuracy', 'figure', '15a', '15b', 'fewer', 'overdue', 'requests', 'figure', '15c', '15d', 'baseline', 'moreover', 'adaptive', 'request', 'arriving', 'rate', 'when', 'rate', 'high', 'uses', 'fewer', 'models', 'serve', 'batch', 'im-', 'prove', 'throughput', 'reduce', 'overdue', 'requests', 'when', 'rate', 'low', 'uses', 'models', 'serve', 'batch', 'improve', 'accuracy', 'also', 'compare', 'effect', 'different', 'namely', 'reward', 'function', 'i.e', 'equation', 'figure', 'shows', 'results', 'requests', 'generated', 'based', 'see', 'smaller', 'accuracy', 'figure', '16a', 'higher', 'this', 'reward', 'function', 'focus', 'accuracy', 'part', 'con-', 'sequently', 'many', 'overdue', 'requests', 'shown', 'figure', '16c', 'contrast', 'reward', 'function', 'tries', 'avoid', 'overdue', 'requests', 'reducing', 'number', 'models', 'ensemble', 'there-', 'fore', 'accuracy', 'number', 'overdue', 'requests', 'smaller', 'figure', '16b', 'figure', '16d', 'case', 'study', 'usability', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'figure', 'sql', 'table', 'creation', 'section', 'detail', 'rafiki', 'help', 'database', 'expert', 'use', 'deep', 'learning', 'services', 'easily', 'existing', 'application', 'present', 'scenario', 'analyzing', 'food', 'preference', 'users', 'food', 'logging', 'application', 'shown', 'figure', 'this', 'application', 'keeps', 'log', 'food', 'user', 'eats', 'storing', 'time', 'loca-', 'tion', 'photo', 'meal', 'for', 'simplicity', 'assume', 'data', 'stored', 'one', 'table', 'created', 'figure', 'each', 'row', 'table', 'contains', 'information', 'meal', 'the', 'image', 'path', 'file', 'path', 'image', 'this', 'image', 'contains', 'picture', 'food', 'however', 'direct', 'way', 'query', 'information', 'e.g.', 'name', 'food', 'image', 'using', 'rafiki', 'database', 'developer', 'collaborates', 'deep', 'learning', 'expert', 'develops', 'trains', 'image', 'recog-', 'nition', 'model', 'food', 'images', 'this', 'trained', 'model', 'shared', 'rafiki', 'provides', 'recognition', 'services', 'database', 'users', 'black', 'box', 'via', 'web', 'apis', 'figure', 'displays', 'web', 'interface', 'rafiki', 'figure', 'rafiki', 'web', 'interface', 'deep', 'learning', 'expert', 'the', 'deep', 'learning', 'expert', 'prepares', 'training', 'train.py', 'serving', 'serve.py', 'scripts', 'deep', 'learning', 'model', 'using', 'apache', 'singa', '10http', '//singa.apache.org/', 'database', 'user', 'after', 'uploading', 'training', 'dataset', 'i.e', 'set', 'food', 'image', 'label', 'pairs', 'rafiki', 'database', 'user', 'starts', 'training', 'job', 'once', 'training', 'finished', 'user', 'deploys', 'trained', 'model', 'serving', 'job', 'afterwards', 'exploits', 'deep', 'learning', 'service', 'get', 'food', 'name', 'sending', 'request', 'rafiki', 'via', 'user-defined', 'function', 'udf', 'the', 'food', 'name', 'function', 'calls', 'web', 'api', 'serving', 'application', 'rafiki', 'particular', 'function', 'executed', 'images', 'rows', 'sat-', 'isfy', 'condition', 'age', 'greater', 'consequently', 'saves', 'much', 'time', 'batch', 'processing', 'supported', 'rafiki', 'side', 'im-', 'prove', 'efficiency', 'furthermore', 'model', 'modified', 're-trained', 'rafiki', 'change', 'sql', 'query', 'database', 'user', 'side', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'select', 'food_name', 'image_path', 'name', 'count', 'foodlog', 'age', 'group', 'name', 'this', 'service', 'also', 'serve', 'requests', 'mobile', 'apps', 'demon-', 'strated', 'figure', 'created', 'food', 'logging', 'app', 'sends', 'requests', 'rafiki', 'food', 'image', 'prediction', 'conclusions', 'complex', 'analytics', 'become', 'inherent', 'expected', 'func-', 'tionality', 'supported', 'big', 'data', 'systems', 'however', 'widely', 'recognized', 'machine', 'learning', 'models', 'easy', 'build', 'train', 'sensitive', 'data', 'distributions', 'characteris-', 'tics', 'therefore', 'important', 'reduce', 'pain', 'points', 'imple-', 'menting', 'tuning', 'dataset', 'specific', 'models', 'step', 'towards', 'making', 'usable', 'paper', 'present', 'rafiki', 'provide', 'training', 'inference', 'service', 'machine', 'learning', 'models', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'systems', 'rafiki', 'supports', 'effective', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensemble', 'modeling', 'inference', 'service', 'amenable', 'trade', 'latency', 'accu-', 'racy', 'the', 'system', 'evaluated', 'various', 'benchmarks', 'illustrate', 'efficiency', 'effectiveness', 'scalability', 'also', 'conducted', 'case', 'study', 'demonstrates', 'system', 'enables', 'database', 'developer', 'use', 'deep', 'learning', 'services', 'easily', 'references', 'providing', 'database', 'service', 'proceedings', '18th', 'international', 'conference', 'data', 'engineering', 'icde', 'pages', '29–', 'washington', 'usa', '2002', 'ieee', 'computer', 'society', 'abadi', 'barham', 'chen', 'chen', 'davis', 'dean', 'devin', 'ghemawat', 'irving', 'isard', 'kudlur', 'levenberg', 'monga', 'moore', 'murray', 'steiner', 'tucker', 'vasudevan', 'warden', 'wicke', 'zheng', 'tensorflow', 'system', 'large-scale', 'machine', 'learning', '12th', 'usenix', 'symposium', 'operating', 'systems', 'design', 'implementation', 'osdi', 'pages', '265–283', '2016', 'usenix', 'association', 'bergstra', 'bengio', 'random', 'search', 'hyper-parameter', 'optimization', 'mach', 'learn', 'res.', '13:281–305', 'feb.', '2012', 'collobert', 'weston', 'bottou', 'karlen', 'kavukcuoglu', 'kuksa', 'natural', 'language', 'processing', 'almost', 'scratch', 'corr', 'abs/1103.0398', '2011', 'crankshaw', 'wang', 'zhou', 'franklin', 'gonzalez', 'stoica', 'clipper', 'low-latency', 'online', 'prediction', 'serving', 'system', '14th', 'usenix', 'symposium', 'networked', 'systems', 'design', 'implementation', 'nsdi', 'pages', '613–627', 'boston', '2017', 'usenix', 'association', 'curino', 'philip', 'charles', 'jones', 'popa', 'malviya', 'madden', 'balakrishnan', 'zeldovich', 'relational', 'cloud', 'database-as-a-service', 'cloud', '2011', 'deng', 'dong', 'socher', 'l.-j', 'fei-fei', 'imagenet', 'large-scale', 'hierarchical', 'image', 'database', 'cvpr09', '2009', 'devries', 'taylor', 'improved', 'regularization', 'convolutional', 'neural', 'networks', 'cutout', 'corr', 'abs/1708.04552', '2017', 'golovin', 'solnik', 'moitra', 'kochanski', 'karro', 'sculley', 'editors', 'google', 'vizier', 'service', 'black-box', 'optimization', '2017', 'zhang', 'ren', 'sun', 'deep', 'residual', 'learning', 'image', 'recognition', 'corr', 'abs/1512.03385', '2015', 'hinton', 'osindero', 'y.-w.', 'teh', 'fast', 'learning', 'algorithm', 'deep', 'belief', 'nets', 'neural', 'comput.', ':1527–1554', 'july', '2006', 'howard', 'zhu', 'chen', 'kalenichenko', 'wang', 'weyand', 'andreetto', 'adam', 'mobilenets', 'efficient', 'convolutional', 'neural', 'networks', 'mobile', 'vision', 'applications', 'corr', 'abs/1704.04861', '2017', 'iandola', 'moskewicz', 'ashraf', 'han', 'dally', 'keutzer', 'squeezenet', 'alexnet-level', 'accuracy', '50x', 'fewer', 'parameters', '1mb', 'model', 'size', 'corr', 'abs/1602.07360', '2016', 'kang', 'emmons', 'abuzaid', 'bailis', 'zaharia', 'noscope', 'optimizing', 'neural', 'network', 'queries', 'video', 'scale', 'proc', 'vldb', 'endow.', ':1586–1597', 'aug.', '2017', 'krizhevsky', 'sutskever', 'hinton', 'imagenet', 'classification', 'deep', 'convolutional', 'neural', 'networks', 'nips', 'pages', '1106–1114', '2012', 'kuncheva', 'whitaker', 'measures', 'diversity', 'classifier', 'ensembles', 'relationship', 'ensemble', 'accuracy', 'mach', 'learn.', ':181–207', 'may', '2003', 'lecun', 'bengio', 'hinton', 'deep', 'learning', 'nature', '521', '7553', ':436–444', '2015', 'zhong', 'liu', 'zhang', 'ease.ml', 'towards', 'multi-tenant', 'resource', 'sharing', 'machine', 'learning', 'workloads', 'arxiv:1708.07308', '2017', 'deep', 'reinforcement', 'learning', 'overview', 'corr', 'abs/1701.07274', '2017', 'mnih', 'puigdomènech', 'badia', 'mirza', 'graves', 'lillicrap', 'harley', 'silver', 'kavukcuoglu', 'asynchronous', 'methods', 'deep', 'reinforcement', 'learning', 'arxiv', 'e-prints', 'feb.', '2016', 'modi', 'koo', 'foo', 'mewald', 'baylor', 'breck', 'h.-t.', 'cheng', 'wilkiewicz', 'koc', 'lew', 'zinkevich', 'wicke', 'ispir', 'polyzotis', 'fiedel', 'haykal', 'whang', 'roy', 'ramesh', 'jain', 'zhang', 'haque', 'tfx', 'tensorflow-based', 'production-scale', 'machine', 'learning', 'platform', 'kdd', '2017', '2017', 'ooi', 'tan', 'wang', 'wang', 'cai', 'chen', 'gao', 'luo', 'tung', 'wang', 'xie', 'zhang', 'zheng', 'singa', 'distributed', 'deep', 'learning', 'platform', 'acm', 'multimedia', 'pages', '685–688', '2015', 'ré', 'agrawal', 'balazinska', 'cafarella', 'jordan', 'kraska', 'ramakrishnan', 'machine', 'learning', 'databases', 'the', 'sound', 'things', 'come', 'cacophony', 'hype', 'sigmod', 'pages', '283–284', '2015', 'schulman', 'wolski', 'dhariwal', 'radford', 'klimov', 'proximal', 'policy', 'optimization', 'algorithms', 'corr', 'abs/1707.06347', '2017', 'sculley', 'holt', 'golovin', 'davydov', 'phillips', 'ebner', 'chaudhary', 'young', 'machine', 'learning', 'the', 'high', 'interest', 'credit', 'card', 'technical', 'debt', 'se4ml', 'software', 'engineering', 'machine', 'learning', 'nips', '2014', 'workshop', '2014', 'shahriari', 'swersky', 'wang', 'adams', 'freitas', 'taking', 'human', 'loop', 'review', 'bayesian', 'optimization', 'proceedings', 'ieee', '104', ':148–175', 'jan', '2016', 'simonyan', 'zisserman', 'very', 'deep', 'convolutional', 'networks', 'large-scale', 'image', 'recognition', 'corr', 'abs/1409.1556', '2014', 'snoek', 'larochelle', 'adams', 'practical', 'bayesian', 'optimization', 'machine', 'learning', 'algorithms', 'arxiv', 'e-prints', 'june', '2012', 'snoek', 'rippel', 'swersky', 'kiros', 'satish', 'sundaram', 'patwary', 'prabhat', 'adams', 'scalable', 'bayesian', 'optimization', 'using', 'deep', 'neural', 'networks', 'arxiv', 'e-prints', 'feb.', '2015', 'sutskever', 'martens', 'dahl', 'hinton', 'importance', 'initialization', 'momentum', 'deep', 'learning', 'proceedings', '30th', 'international', 'conference', 'international', 'conference', 'machine', 'learning', 'volume', 'icml', 'pages', 'iii–1139–iii–1147', 'jmlr.org', '2013', 'sutton', 'barto', 'introduction', 'reinforcement', 'learning', 'mit', 'press', 'cambridge', 'usa', '1st', 'edition', '1998', 'szegedy', 'liu', 'jia', 'sermanet', 'reed', 'anguelov', 'erhan', 'vanhoucke', 'rabinovich', 'going', 'deeper', 'convolutions', 'corr', 'abs/1409.4842', '2014', 'wang', 'chen', 'chen', 'dinh', 'gao', 'ooi', 'k.-l.', 'tan', 'wang', 'deep', 'learning', 'scale', 'ease', 'transactions', 'multimedia', 'computing', 'communications', 'applications', '2016', 'wang', 'chen', 'dinh', 'gao', 'ooi', 'tan', 'wang', 'singa', 'putting', 'deep', 'learning', 'hands', 'multimedia', 'users', 'acm', 'multimedia', 'pages', '25–34', '2015', 'wang', 'yang', 'ooi', 'zhang', 'zhuang', 'effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', 'the', 'vldb', 'journal', 'pages', '1–23', '2015', 'wang', 'zhang', 'chen', 'jagadish', 'ooi', 'k.-l.', 'tan', 'database', 'meets', 'deep', 'learning', 'challenges', 'opportunities', 'acm', 'sigmod', 'record', ':17–22', '2016', 'zhang', 'zeng', 'zhang', 'how', 'good', 'machine', 'learning', 'clouds', 'binary', 'classification', 'good', 'features', 'corr', 'abs/1707.09562', '2017', 'zoph', 'neural', 'architecture', 'search', 'reinforcement', 'learning', 'corr', 'abs/1611.01578', '2016']
['rafiki', 'machine', 'learning', 'analytics', 'service', 'system', 'wei', 'wang†', 'sheng', 'wang†', 'jinyang', 'gao†', 'meihui', 'zhang�', 'gang', 'chen‡', 'teck', 'khim', 'ng†', 'beng', 'chin', 'ooi†', '†national', 'university', 'singapore', '�beijing', 'institute', 'technology', '‡zhejiang', 'university', 'wangwei', 'jinyang.gao', 'wangsh', 'ngtk', 'ooibc', 'comp.nus.edu.sg', '�meihui', 'zhang', 'bit.edu.cn', 'zju.edu.cn', 'abstract', 'big', 'data', 'analytics', 'gaining', 'massive', 'momentum', 'last', 'year', 'applying', 'machine', 'learning', 'model', 'big', 'data', 'become', 'implicit', 'requirement', 'expectation', 'analysis', 'task', 'especially', 'high-stakes', 'applications.typical', 'application', 'include', 'sentiment', 'analysis', 'review', 'analyzing', 'on-line', 'product', 'image', 'classification', 'food', 'logging', 'application', 'monitoring', 'user', 'daily', 'intake', 'stock', 'movement', 'prediction', 'extending', 'tra-', 'ditional', 'database', 'system', 'support', 'analysis', 'intriguing', 'challenging', 'first', 'almost', 'impossible', 'implement', 'ma-', 'chine', 'learning', 'model', 'database', 'engine', 'second', 'expertise', 'knowledge', 'required', 'optimize', 'training', 'inference', 'proce-', 'dures', 'term', 'efficiency', 'effectiveness', 'imposes', 'heavy', 'burden', 'system', 'user', 'paper', 'develop', 'present', 'system', 'called', 'rafiki', 'provide', 'training', 'inference', 'ser-', 'vice', 'machine', 'learning', 'model', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'system', 'rafiki', 'provides', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensem-', 'ble', 'modeling', 'inference', 'service', 'trade', 'latency', 'accuracy', 'experimental', 'result', 'confirm', 'efficiency', 'effectiveness', 'scalability', 'usability', 'rafiki', 'introduction', 'data', 'analysis', 'play', 'important', 'role', 'extracting', 'valuable', 'in-', 'sight', 'huge', 'amount', 'data', 'database', 'system', 'traditionally', 'used', 'storing', 'analyzing', 'structured', 'data', 'spatial-', 'temporal', 'data', 'graph', 'data', 'etc', 'other', 'data', 'multimedia', 'data', 'e.g.', 'image', 'free', 'text', 'domain', 'specific', 'data', 'e.g', 'medical', 'data', 'sensor', 'data', 'generated', 'fast', 'speed', 'con-', 'stitutes', 'significant', 'portion', 'big', 'data', 'beneficial', 'analyze', 'data', 'database', 'application', 'for', 'instance', 'inferring', 'quality', 'product', 'review', 'column', 'sale', 'database', 'would', 'help', 'explain', 'sale', 'number', 'analyz-', 'ing', 'food', 'image', 'food', 'logging', 'application', 'extract', 'food', 'preference', 'people', 'different', 'age', 'however', 'analysis', 'requires', 'machine', 'learning', 'model', 'especially', 'deep', 'learn-', 'ing', 'model', 'sentiment', 'analysis', 'classify', 'review', 'positive', 'negative', 'image', 'classification', 'recognize', 'food', 'type', 'image', 'figure', 'show', 'pipeline', 'data', 'analysis', 'database', 'system', 'widely', 'used', 'first', 'stage', 'machine', 'learning', 'good', '4th', 'stage', 'big', 'data', '大数据', '3vs', 'volume', 'velocity', 'variety', '高容量，速度快，多样性', 'variety', 'implies', 'integrating', 'analyzing', 'data', 'necessary', 'develop', 'end-to-end', 'solution', 'scale', 'easy', 'use', 'minimize', 'human', 'effort', 'acquisition', 'extraction/', 'cleaning/', 'annotation', 'integration', 'analysis/', 'modeling', 'interpretation/', 'visualization', 'figure', 'data', 'analytic', 'pipeline', 'one', 'approach', 'integrating', 'machine', 'learning', 'technique', 'database', 'application', 'preprocess', 'data', 'off-line', 'add', 'prediction', 'result', 'new', 'column', 'e.g', 'column', 'food', 'type', 'however', 'off-line', 'preprocessing', 'two-folds', 'restric-', 'tion', 'first', 'requires', 'developer', 'expertise', 'knowledge', 'experience', 'training', 'machine', 'learning', 'model', 'second', 'query', 'involve', 'attribute', 'object', 'e.g', 'ingredient', 'food', 'predicted', 'preprocessing', 'step', 'addi-', 'tion', 'would', 'waste', 'lot', 'time', 'prediction', 'row', 'query', 'read', 'food', 'type', 'column', 'row', 'e.g', 'due', 'filtering', 'column', 'another', 'approach', 'carry', 'pre-', 'diction', 'on-line', 'user-defined', 'function', 'udfs', 'sql', 'query', 'however', 'challenging', 'implement', 'machine', 'learning', 'mod-', 'el', 'udfs', 'database', 'user', 'machine', 'learning', 'model', 'vary', 'lot', 'term', 'theory', 'implementation', 'also', 'difficult', 'optimize', 'prediction', 'accuracy', 'database', 'engine', 'better', 'solution', 'call', 'corresponding', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', 'apis', 'udfs', 'prediction', 'analysis', 'task', 'cloud', 'service', 'economical', 'elastic', 'easy', 'use', 'with', 'resurgence', 'cloud', 'provider', 'like', 'amazon', 'aws', 'google', 'microsoft', 'azure', 'built', 'machine', 'learning', 'service', 'cloud', 'platform', 'there', 'two', 'type', 'cloud', 'service', 'the', 'first', 'one', 'provide', 'api', 'specific', 'task', 'e.g', 'image', 'classifi-', 'cation', 'sentiment', 'analysis', 'such', 'apis', 'available', 'amazon', 'aws1', 'google', 'cloud', 'platform2', 'the', 'disadvantage', 'accuracy', 'could', 'low', 'since', 'model', 'trained', 'amazon', 'google', 'data', 'likely', 'different', 'user', 'data', 'the', 'second', 'type', 'service', 'overcomes', 'issue', 'providing', 'training', 'service', 'user', 'upload', 'datasets', 'conduct', 'training', 'this', 'service', 'available', 'amazon', 'aws', 'microsoft', 'azure', 'however', 'limited', 'number', 'ma-', 'chine', 'learning', 'model', 'supported', 'for', 'example', 'sim-', '1https', '//aws.amazon.com/machine-learning/', '2https', '//cloud.google.com/products/machine-learning/', 'ple', 'logistic', 'regression', 'linear', 'regression', 'models3', 'supported', 'amazon', 'deep', 'learning', 'model', 'convolutional', 'neural', 'network', 'convnets', 'recurrent', 'neural', 'network', 'rnn', 'included', 'machine', 'learning', 'cloud', 'service', 'need', 'cover', 'wide', 'range', 'model', 'including', 'deep', 'learning', 'model', 'also', 'provide', 'easy-to-use', 'efficient', 'effective', 'service', 'user', 'with-', 'much', 'machine', 'learning', 'knowledge', 'experience', 'e.g', 'database', 'user', 'considering', 'different', 'model', 'may', 'result', 'different', 'performance', 'term', 'efficiency', 'e.g', 'latency', 'effectiveness', 'e.g', 'accuracy', 'cloud', 'service', 'select', 'proper', 'model', 'given', 'task', 'moreover', 'machine', 'learning', 'model', 'training', 'algorithm', 'come', 'set', 'hyper-parameters', 'knob', 'e.g', 'number', 'layer', 'size', 'layer', 'neural', 'network', 'some', 'hyper-parameters', 'vital', 'convergence', 'training', 'algorithm', 'final', 'model', 'performance', 'e.g', 'learning', 'rate', 'stochastic', 'gradient', 'descent', 'sgd', 'algorithm', 'manual', 'hyper-', 'parameter', 'tuning', 'requires', 'rich', 'experience', 'tedious', 'random', 'search', 'bayesian', 'optimization', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approach', 'however', 'costly', 'train', 'model', 'till', 'convergence', 'may', 'take', 'hundred', 'hour', 'dis-', 'tributed', 'tuning', 'platform', 'desirable', 'besides', 'training', 'inference4', 'also', 'matter', 'directly', 'affect', 'user', 'experience', 'machine', 'learning', 'product', 'often', 'ensemble', 'multiple', 'model', 'average', 'result', 'boost', 'prediction', 'performance', 'however', 'ensemble', 'modeling', 'incurs', 'larger', 'latency', 'i.e', 'response', 'time', 'compared', 'using', 'single', 'prediction', 'model', 'therefore', 'trade-off', 'be-', 'tween', 'accuracy', 'latency', 'there', 'study', 'challenge', 'providing', 'ma-', 'chine', 'learning', 'service', 'mlbench', 'compare', 'cloud', 'ser-', 'vice', 'amazon', 'azure', 'set', 'binary', 'classification', 'task', 'ease.ml', 'build', 'training', 'platform', 'model', 'selection', 'aim-', 'ing', 'optimizing', 'resource', 'utilization', 'google', 'vizier', 'distributed', 'hyper-parameter', 'tuning', 'platform', 'provides', 'tuning', 'service', 'system', 'clipper', 'focus', 'inference', 'proposing', 'general', 'framework', 'specific', 'optimization', 'effi-', 'ciency', 'accuracy', 'paper', 'present', 'system', 'called', 'rafiki', 'provide', 'training', 'inference', 'service', 'machine', 'learning', 'mod-', 'el', 'with', 'rafiki', 'database', 'user', 'exempted', 'managing', 'hardware', 'resource', 'constructing', 'deep', 'learning', 'model', 'tun-', 'ing', 'hyper-parameters', 'optimizing', 'prediction', 'accuracy', 'speed', 'instead', 'simply', 'upload', 'datasets', 'configure', 'service', 'conduct', 'training', 'deploy', 'model', 'infer-', 'ence', 'cloud', 'service', 'system', 'rafiki', 'manages', 'hard-', 'ware', 'resource', 'failure', 'recovery', 'etc', 'come', 'set', 'built-in', 'deep', 'learning', 'model', 'popular', 'task', 'image', 'text', 'processing', 'addition', 'make', 'following', 'contribution', 'make', 'rafiki', 'easy-to-use', 'efficient', 'effective', 'propose', 'unified', 'system', 'architecture', 'train-', 'ing', 'inference', 'service', 'observe', 'two', 'ser-', 'vice', 'share', 'common', 'component', 'parameter', 'server', 'model', 'parameter', 'storage', 'distributed', 'comput-', 'ing', 'environment', 'distributed', 'hyper-parameter', 'tuning', 'parallel', 'inference', 'sharing', 'underlying', 'storage', 'communication', 'protocol', 'computation', 'resource', 'im-', 'plicitly', 'avoid', 'technical', 'debt', 'moreover', 'com-', '3https', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4we', 'use', 'term', 'deployment', 'inference', 'serving', 'interchange-', 'ably', 'bining', 'two', 'service', 'together', 'rafiki', 'enables', 'instant', 'model', 'deployment', 'training', 'for', 'training', 'service', 'first', 'propose', 'general', 'frame-', 'work', 'distributed', 'hyper-parameter', 'tuning', 'ex-', 'tensible', 'popular', 'hyper-parameter', 'tuning', 'algorithm', 'in-', 'cluding', 'random', 'search', 'bayesian', 'optimization', 'addi-', 'tion', 'propose', 'collaborative', 'tuning', 'scheme', 'specifically', 'deep', 'learning', 'model', 'us', 'model', 'parameter', 'current', 'top', 'performing', 'training', 'trial', 'initialize', 'new', 'trial', 'for', 'inference', 'service', 'propose', 'scheduling', 'algorithm', 'based', 'reinforcement', 'learning', 'optimize', 'overall', 'ac-', 'curacy', 'reduce', 'latency', 'both', 'algorithm', 'adaptive', 'change', 'request', 'arrival', 'rate', 'conduct', 'micro-benchmark', 'experiment', 'evaluate', 'performance', 'proposed', 'algorithm', 'reminder', 'paper', 'give', 'system', 'architecture', 'section', 'section', 'describes', 'training', 'service', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'algorithm', 'the', 'deployment', 'ser-', 'vice', 'optimization', 'technique', 'introduced', 'section', 'sec-', 'tion', 'describes', 'system', 'implementation', 'explain', 'ex-', 'perimental', 'study', 'section', 'introduce', 'related', 'work', 'section', 'related', 'work', 'rafiki', 'saas', 'provides', 'analytics', 'service', 'based', 'ma-', 'chine', 'learning', 'optimization', 'technique', 'proposed', 'training', 'i.e', 'distributed', 'hyper-parameter', 'tuning', 'inference', 'stage', 'i.e', 'accuracy', 'latency', 'optimization', 'section', 'review', 'related', 'work', 'saas', 'hyper-parameter', 'tuning', 'inference', 'op-', 'timization', 'reinforcement', 'learning', 'adopted', 'rafiki', 'inference', 'optimization', '2.1', 'software', 'service', 'cloud', 'computing', 'changed', 'way', 'operation', 'many', 'company', 'providing', 'infrastructure', 'service', 'iaa', 'platform', 'service', 'paas', 'software', 'service', 'saas', 'with', 'iaa', 'user', 'company', 'use', 'remote', 'physical', 'virtual', 'machine', 'instead', 'establishing', 'data', 'center', 'based', 'user', 'require-', 'ments', 'iaa', 'scale', 'compute', 'resource', 'quickly', 'paas', 'e.g.', 'microsoft', 'azure', 'provides', 'development', 'toolkit', 'running', 'envi-', 'ronment', 'adjusted', 'automatically', 'based', 'business', 'demand', 'saas', 'including', 'database', 'service', 'installs', 'soft-', 'ware', 'cloud', 'computing', 'platform', 'provides', 'application', 'ser-', 'vice', 'simplifies', 'software', 'maintenance', 'the', 'pay', 'pricing', 'model', 'convenient', 'economic', 'small', 'company', 'research', 'lab', 'recently', 'machine', 'learning', 'especially', 'deep', 'learning', 'gain', 'lot', 'interest', 'due', 'outstanding', 'performance', 'analytic', 'predictive', 'task', 'there', 'two', 'primary', 'step', 'apply', 'machine', 'learning', 'application', 'namely', 'training', 'inference', 'cloud', 'provider', 'like', 'amazon', 'aws', 'microsoft', 'azure', 'google', 'cloud', 'already', 'included', 'service', 'two', 'step', 'however', 'training', 'service', 'limited', 'support', 'deep', 'learning', 'mod-', 'el', 'inference', 'service', 'customized', 'customer', 'data', 'see', 'explanation', 'section', 'there', 'also', 'research', 'paper', 'towards', 'efficient', 'resource', 'allocation', 'training', 'efficient', 'inference', 'cloud', 'rafiki', 'differs', 'exist-', 'ing', 'cloud', 'service', 'service', 'type', 'optimization', 'technique', 'firstly', 'rafiki', 'allows', 'user', 'train', 'machine', 'learning', 'including', 'deep', 'learning', 'model', 'data', 'de-', 'ploy', 'inference', 'secondly', 'rafiki', 'special', 'optimization', 'training', 'inference', 'service', 'compared', 'existing', 'approach', 'explained', 'following', 'two', 'subsection', '2.2', 'hyper-parameter', 'tuning', 'train', 'machine', 'learning', 'model', 'application', 'need', 'decide', 'many', 'hyper-parameters', 'related', 'model', 'structure', 'opti-', 'mization', 'algorithm', 'data', 'preprocessing', 'operation', 'all', 'hyper-', 'parameter', 'tuning', 'algorithm', 'work', 'empirical', 'trial', 'random', 'search', 'randomly', 'selects', 'value', 'hyper-parameter', 'try', 'shown', 'efficient', 'grid', 'search', 'enumerates', 'possible', 'hyper-parameter', 'combination', 'bayesian', 'optimization', 'assumes', 'optimization', 'function', 'hyper-parameters', 'input', 'inference', 'performance', 'output', 'follows', 'gaussian', 'process', 'sample', 'next', 'point', 'hyper-parameter', 'space', 'based', 'existing', 'trial', 'according', 'acquisition', 'function', 'reinforcement', 'learning', 'recently', 'applied', 'tune', 'archi-', 'tecture', 'related', 'hyper-parameters', 'google', 'vizier', 'provides', 'hyper-parameter', 'tuning', 'service', 'cloud', 'rafiki', 'provides', 'dis-', 'tributed', 'hyper-parameter', 'tuning', 'service', 'compatible', 'mentioned', 'hyper-parameter', 'tuning', 'algorithm', 'ad-', 'dition', 'support', 'collaborative', 'tuning', 'share', 'model', 'parame-', 'ters', 'across', 'trial', 'our', 'experiment', 'confirm', 'effectiveness', 'collaborative', 'tuning', 'scheme', '2.3', 'inference', 'optimization', 'improve', 'inference', 'accuracy', 'ensemble', 'modeling', 'train', 'deploys', 'multiple', 'model', 'widely', 'applied', 'for', 'real-time', 'in-', 'ference', 'latency', 'another', 'critical', 'metric', 'inference', 'service', 'noscope', 'proposes', 'specific', 'inference', 'optimization', 'video', 'querying', 'clipper', 'study', 'multiple', 'optimization', 'technique', 'improve', 'throughput', 'via', 'batch', 'size', 'reduce', 'latency', 'via', 'caching', 'also', 'proposes', 'model', 'selection', 'ensemble', 'mod-', 'eling', 'using', 'multi-armed', 'bandit', 'algorithm', 'compared', 'clip-', 'per', 'rafiki', 'provides', 'training', 'inference', 'service', 'whereas', 'clipper', 'focus', 'inference', 'service', 'also', 'clipper', 'op-', 'timizes', 'throughput', 'latency', 'accuracy', 'separately', 'whereas', 'rafiki', 'model', 'together', 'find', 'optimal', 'model', 'selection', 'batch', 'size', 'tensorflow', 'serving', 'tfx', 'provide', 'inference', 'service', 'model', 'trained', 'using', 'tensorflow', 'rafiki', 'clipper', 'implementation', 'agnostic', 'they', 'communicate', 'training', 'inference', 'program', 'docker', 'container', 'via', 'rpc', '2.4', 'reinforcement', 'learning', 'reinforcement', 'learning', 'time', 'agent', 'take', 'one', 'action', 'enters', 'next', 'state', 'the', 'environment', 'return', 'reward', 'based', 'action', 'state', 'the', 'learning', 'objective', 'maximize', 'aggregated', 'reward', 'algorithm', 'decide', 'ac-', 'tion', 'take', 'based', 'current', 'state', 'experience', 'gained', 'previous', 'trial', 'exploration', 'policy', 'gradient', 'based', 'algorithm', 'maximize', 'expected', 'reward', 'taking', 'action', 'following', 'policy', 'function', 'at|st', 'step', 'equation', 'represents', 'trajectory', 'action', 'state', 'reward', 'tuples', 'decaying', 'factor', 'the', 'expectation', 'taken', 'possible', 'trajec-', 'tory', 'usually', 'implemented', 'using', 'multi-layer', 'perceptron', 'model', 'represents', 'parameter', 'take', 'state', 'vector', 'input', 'generates', 'action', 'scalar', 'value', 'continuous', 'action', 'softmax', 'output', 'discrete', 'action', 'equation', 'optimized', 'using', 'stochastic', 'gradient', 'ascent', 'method', 'equation', 'used', 'surrogate', 'function', 'objective', 'gradient', 'easy', 'com-', 'pute', 'via', 'automatic', 'differentiation', 'eς∼πθ', 't=0', 'γtrt', 'oθj', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'many', 'approach', 'proposed', 'improve', 'policy', 'gra-', 'dient', 'reducing', 'variance', 'reward', 'including', 'actor-critic', 'model', 'subtracts', 'reward', 'baseline', 'estimation', 'reward', 'also', 'approximated', 'using', 'neural', 'network', 'like', 'policy', 'function', 'then', 'equation', 'becomesrt−v', 'yuxi', 'done', 'survey', 'deep', 'reinforcement', 'learning', 'including', 'actor-critic', 'model', 'used', 'paper', 'system', 'overview', 'section', 'present', 'system', 'architecture', 'rafiki', 'illustrate', 'usability', 'use', 'case', 'use', 'rafiki', 'user', 'simply', 'configure', 'training', 'inference', 'job', 'either', 'restful', 'apis', 'python', 'sdk', 'figure', 'left', 'column', 'show', 'one', 'image', 'classification', 'example', 'using', 'python', 'sdk', 'the', 'training', 'code', 'consists', 'line', 'the', 'first', 'line', 'load', 'image', 'folder', 'rafiki', 'distributed', 'data', 'stor-', 'age', 'hdfs', 'image', 'subfolder', 'labeled', 'subfolder', 'name', 'i.e', 'food', 'name', 'the', 'second', 'line', 'creates', 'configuration', 'object', 'representing', 'hyper-parameter', 'tuning', 'option', 'see', 'section', '4.2', 'detail', 'the', 'third', 'line', 'creates', 'training', 'job', 'passing', 'data', 'option', 'input/output', 'shape', 'tuple', 'list', 'tuples', 'the', 'input-output', 'shape', 'used', 'model', 'cus-', 'tomization', 'for', 'example', 'convnets', 'usually', 'accept', 'input', 'image', 'fixed', 'shape', 'i.e', 'input', 'shape', 'adapt', 'final', 'output', 'layer', 'generate', 'number', 'output', 'output', 'shape', 'could', 'total', 'number', 'class', 'bounding-box', 'shape', 'the', 'last', 'line', 'submits', 'job', 'restful', 'apis', 'rafiki', 'exe-', 'cution', 'return', 'job', 'handle', 'job', 'monitoring', 'once', 'training', 'finish', 'deploy', 'model', 'instantly', 'shown', 'infer.py', 'get', 'model', 'instance', 'consists', 'model', 'name', 'parameter', 'name', 'retrieving', 'parameter', 'value', 'rafiki', 'parameter', 'server', 'us', 'second', 'line', 'create', 'inference', 'job', 'given', 'model', 'after', 'model', 'deployed', 'line', 'application', 'user', 'submit', 'request', 'job', 'prediction', 'shown', 'code', 'query.py', 'ap-', 'plication', 'like', 'mobile', 'app', 'send', 'restful', 'request', 'query', 'for', 'training', 'job', 'rafiki', 'selects', 'corresponding', 'built-in', 'model', 'based', 'task', 'type', 'the', 'table', 'figure', 'list', 'built-in', 'task', 'model', 'with', 'proliferation', 'machine', 'learning', 'able', 'find', 'open', 'source', 'implementation', 'al-', 'every', 'model', 'figure', 'compare', 'memory', 'footprint', 'ac-', 'curacy', 'inference', 'speed', 'open', 'source', 'convnets5', 'group', 'convnets', 'compared', 'including', 'inception', 'convnets', 'mobilenet', 'nasnets', 'resnets', 'vggs', 'the', 'accuracy', 'measured', 'based', 'top-1', 'prediction', 'image', 'validation', 'dataset', 'imagenet', 'the', 'inference', 'time', 'mem-', 'ory', 'footprint', 'averaged', 'iteration', 'image', 'i.e', 'batch', 'size=50', '5https', '//github.com/tensorflow/models/tree/master/research/slim/', 'data', 'hyper-tune', 'hyper-tune', 'ensemble', 'modelling', 'resnet', 'parameter', 'task', 'model', 'image', 'classification', 'vgg', 'resnet', 'squeezenet', 'xceptionnet', 'inceptionnet', 'object', 'detection', 'yolo', 'ssd', 'fasterrcnn', 'sentiment', 'analysis', 'temporalcnn', 'fasttext', 'characterrnn', 'resnet', 'resnetvgg', 'vgg', 'vgg', 'master', 'worker', 'rafiki', 'user', 'code', 'rafiki', 'application', 'user', 'code', 'train.py', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'infer.py', 'model', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'model', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'ret', 'label', 'figure', 'overview', 'rafiki', '0.2', '0.4', '0.6', '0.8', '1.0', 'time', 'each', 'iteration', '0.70', '0.75', '0.80', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'figure', 'accuracy', 'inference', 'time', 'memory', 'footprint', 'popular', 'convnets', 'hyper-parameter', 'tuning', 'see', 'section', '4.2', 'conducted', 'every', 'selected', 'model', 'for', 'example', 'two', 'set', 'hyper-parameters', 'be-', 'ing', 'tested', 'resnet', 'resp', 'vgg', 'shown', 'figure', 'the', 'trained', 'model', 'parameter', 'stored', 'global', 'parameter', 'server', 'persistent', 'distributed', 'in-memory', 'storage', 'once', 'training', 'done', 'inference', 'worker', 'fetch', 'parame-', 'ters', 'efficiently', 'the', 'inference', 'job', 'launch', 'model', 'passed', 'user', 'configuration', 'ensemble', 'modeling', 'see', 'section', 'applied', 'optimize', 'inference', 'accuracy', 'request', 'application', 'e.g', 'database', 'user', 'rafiki', 'compatible', 'machine', 'learning', 'framework', 'in-', 'cluding', 'tensorflow', 'scikit-learn', 'kears', 'etc.', 'although', 'built', 'top', 'apache', 'singa', 'due', 'efficiency', 'scalable', 'architecture', 'more', 'detail', 'rafiki', 'implementation', 'described', 'section', 'training', 'service', 'the', 'training', 'service', 'consists', 'two', 'step', 'namely', 'model', 'selec-', 'tion', 'hyper-parameter', 'tuning', 'adopt', 'simple', 'model', 'selec-', 'tion', 'strategy', 'rafiki', 'for', 'hyper-parameter', 'tuning', 'first', 'pro-', 'pose', 'general', 'programming', 'model', 'distributed', 'tuning', 'propose', 'collaborative', 'tuning', 'scheme', '4.1', 'model', 'selection', 'every', 'built-in', 'model', 'rafiki', 'registered', 'task', 'e.g', 'im-', 'age', 'classification', 'sentiment', 'analysis', 'each', 'model', 'associated', 'meta', 'data', 'including', 'training', 'cost', 'e.g', 'speed', 'memory', 'consumption', 'performance', 'dataset', 'e.g', 'accuracy', 'area-under-curve', 'ease.ml', 'proposes', 'convert', 'model', 'selection', 'multi-armed', 'bandit', 'problem', 'ev-', 'ery', 'model', 'i.e', 'arm', 'get', 'chance', 'training', 'after', 'many', 'trial', 'chance', 'under-performed', 'model', 'would', 'decreased', 'observe', 'model', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', 'for', 'example', 'resnet', 'better', 'alexnet', 'squeezenet', 'bunch', 'datasets', 'including', 'ima-', 'genet', 'cifar-106', 'etc..', 'therefore', 'adopt', 'simple', 'model', 'selection', 'strategy', 'without', 'advanced', 'analysis', 'select', 'model', 'similar', 'performance', 'different', 'architecture', 'this', 'create', 'diverse', 'model', 'set', 'whose', 'performance', 'would', 'boosted', 'applying', 'ensemble', 'modeling', '4.2', 'distributed', 'hyper-parameter', 'tuning', 'hyper-parameter', 'tuning', 'usually', 'run', 'many', 'different', 'set', 'hyper-parameters', 'distributed', 'tuning', 'running', 'instance', 'parallel', 'natural', 'solution', 'reducing', 'tuning', 'time', 'there', '6https', '//www.cs.toronto.edu/', 'kriz/cifar.html', 'table', 'hyper-parameter', 'group', 'group', 'hyper-parameter', 'example', 'domain', 'data', 'preprocessing', 'image', 'rotation', '0,30', 'image', 'cropping', '0,32', 'whitening', 'pca', 'zca', 'model', 'architecture', 'number', 'layer', 'cluster', 'kernel', 'linear', 'rbf', 'poly', 'training', 'algorithm', 'learning', 'rate', 'weight', 'decay', 'momentum', 'three', 'popular', 'approach', 'hyper-parameter', 'tuning', 'namely', 'grid', 'search', 'random', 'search', 'bayesian', 'optimization', 'support', 'algorithm', 'need', 'general', 'extensible', 'pro-', 'gramming', 'model', '4.2.1', 'programming', 'model', 'cluster', 'hyper-parameters', 'involved', 'training', 'machine', 'learning', 'model', 'three', 'group', 'shown', 'table', 'data', 'prepro-', 'cessing', 'adopts', 'different', 'approach', 'normalize', 'data', 'augment', 'dataset', 'extract', 'feature', 'raw', 'data', 'i.e', 'feature', 'en-', 'gineering', 'most', 'machine', 'learning', 'model', 'tuning', 'knob', 'form', 'architecture', 'hyper-parameters', 'e.g', 'number', 'tree', 'random', 'forest', 'number', 'layer', 'convnets', 'kernel', 'function', 'svm', 'the', 'optimization', 'algorithm', 'especially', 'gradient', 'based', 'optimization', 'algorithm', 'like', 'sgd', 'many', 'hyper-parameters', 'including', 'initial', 'learning', 'rate', 'decaying', 'rate', 'decaying', 'method', 'linear', 'exponential', 'etc', 'from', 'table', 'see', 'hyper-parameters', 'could', 'come', 'range', 'list', 'number', 'category', 'all', 'possible', 'as-', 'signments', 'hyper-parameters', 'construct', 'hyper-parameter', 'space', 'denoted', 'following', 'convention', 'call', 'one', 'point', 'space', 'trial', 'denoted', 'rafiki', 'provides', 'hyper-', 'space', 'class', 'function', 'shown', 'figure', 'developer', 'specify', 'hyper-parameter', 'space', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'model', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'model', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'class', 'hyperspace', 'def', 'add_range_knob', 'name', 'dtype', 'min', 'max', 'depends=none', 'pre_hook=none', 'post_hook=none', 'def', 'add_categorical_knob', 'name', 'dtype', 'list', 'depends=none', 'pre_hook=none', 'post_hook=none', 'figure', 'hyperspace', 'apis', 'the', 'first', 'function', 'defines', 'domain', 'hyper-parameter', 'range', 'min', 'max', 'dtype', 'represents', 'data', 'type', 'could', 'float', 'integer', 'string', 'depends', 'list', 'hyper-parameters', 'whose', 'value', 'directly', 'affect', 'generation', 'hyper-parameter', 'for', 'example', 'initial', 'learning', 'rate', 'large', 'would', 'prefer', 'larger', 'decay', 'rate', 'decease', 'learning', 'rate', 'quickly', 'there-', 'fore', 'decay', 'rate', 'generated', 'generating', 'learn-', 'ing', 'rate', 'enforce', 'relation', 'add', 'learning', 'rate', 'depends', 'list', 'add', 'post', 'hook', 'function', 'adjust', 'value', 'learning', 'rate', 'decay', 'the', 'second', 'function', 'defines', 'categori-', 'cal', 'hyper-parameter', 'list', 'represents', 'candidate', 'depends', 'pre', 'hook', 'post', 'hook', 'analogous', 'range', 'knob', 'the', 'whole', 'hyper-parameter', 'tuning', 'process', 'one', 'model', 'dataset', 'called', 'study', 'the', 'performance', 'trial', 'de-', 'noted', 'larger', 'indicates', 'better', 'performance', 'e.g', 'ac-', 'curacy', 'for', 'distributed', 'hyper-parameter', 'tuning', 'master', 'multiple', 'worker', 'study', 'the', 'master', 'generates', 'trial', 'worker', 'worker', 'evaluate', 'trial', 'one', 'time', 'worker', 'train', 'model', 'given', 'trial', 'the', 'workflow', 'study', 'master', 'side', 'explained', 'algorithm', 'the', 'master', 'iter-', 'ate', 'event', 'loop', 'collect', 'performance', 'trial', 'i.e', 'generates', 'next', 'trial', 'trialadvisor', 'im-', 'plements', 'hyper-parameter', 'search', 'algorithm', 'e.g', 'random', 'search', 'bayesian', 'optimization', 'stop', 'trial', 'test', 'user', 'configured', 'stop', 'criterion', 'satisfied', 'e.g', 'total', 'num-', 'ber', 'trial', 'finally', 'best', 'parameter', 'put', 'parameter', 'server', 'inference', 'service', 'the', 'worker', 'side', 'keep', 'requesting', 'trial', 'master', 'conducting', 'training', 'reporting', 'result', 'master', 'algorithm', 'study', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', 'trial', 'adv.next', 'msg.worker', 'trial', 'nil', 'break', 'else', 'send', 'msg.worker', 'trial', 'end', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'else', 'msg.type', 'kfinish', 'num', 'adv.is', 'best', 'msg.worker', 'send', 'msg.worker', 'kput', 'end', 'end', 'end', 'return', 'adv.best', 'trial', '4.2.2', 'collaborative', 'tuning', 'section', 'introduced', 'distributed', 'hyper-', 'parameter', 'tuning', 'framework', 'next', 'extend', 'framework', 'proposing', 'collaborative', 'tuning', 'scheme', 'sgd', 'widely', 'used', 'training', 'machine', 'learning', 'model', 'often', 'observe', 'training', 'loss', 'stay', 'plateau', 'drop', 'suddenly', 'decrease', 'learning', 'rate', 'sgd', 'e.g', '0.1', '0.01', '0.01', '0.001', 'based', 'observation', 'see', 'hyper-parameters', 'changed', 'training', 'get', 'plateau', 'de-', 'rive', 'better', 'performance', 'therefore', 'fix', 'model', 'architec-', 'ture', 'tune', 'hyper-parameters', 'group', 'table', 'model', 'parameter', 'trained', 'using', 'one', 'hyper-parameter', 'trial', 'reused', 'initialize', 'model', 'another', 'trial', 'selecting', 'parameter', 'top', 'performing', 'trial', 'continue', 'hyper-parameter', 'tuning', 'old', 'trial', 'like', 'pre-', 'training', 'fact', 'good', 'model', 'initialization', 'result', 'faster', 'convergence', 'better', 'performance', 'user', 'typically', 'fine-tune', 'popular', 'convnet', 'architecture', 'datasets', 'conse-', 'quently', 'collaborative', 'tuning', 'scheme', 'likely', 'converge', 'good', 'state', 'straightforward', 'tune', 'hyper-parameters', 'related', 'model', 'architecture', 'this', 'architecture', 'change', 'parameter', 'also', 'change', 'for', 'example', 'parameter', 'convolution', 'layer', 'filter', 'size', '3x3', 'used', 'initialize', 'convolution', 'layer', 'another', 'convnet', 'whose', 'filter', 'size', '5x5', 'however', 'architecture', 'tuning', 'many', 'architecture', 'available', 'likely', 'architecture', 'share', 'config-', 'urations', 'one', 'convolution', 'layer', 'for', 'instance', 'convnet', '3rd', 'convolution', 'layer', 'convnet', '3rd', 'layer', 'convo-', 'lution', 'setting', 'use', 'parametersw', 'convnet', '3rd', 'layer', 'initialize', 'convnet', '3rd', 'layer', 'store', 'allw', 'parameter', 'server', 'fetch', 'shape', 'matched', 'initialize', 'layer', 'new', 'trial', 'convnets', 'performance', 'new', 'trail', 'better', 'older', 'one', 'overwrite', 'parameter', 'server', 'new', 'value', '0.1', '0.01', '0.1', '0.01', '0.1', 'figure', 'collaborative', 'tuning', 'example', 'the', 'whole', 'process', 'illustrated', 'figure', 'worker', 'running', 'trial', 'tune', 'hyper-parameters', 'e.g', 'learning', 'rate', 'model', 'after', 'performance', 'worker', 'stop', 'increasing', 'the', 'training', 'stop', 'automatically', 'according', 'early', 'stopping', 'criterion', 'e.g', 'training', 'loss', 'decreasing', 'consecutive', 'epoch', 'early', 'stopping', 'widely', 'used', 'training', 'machine', 'learning', 'models7', 'the', 'new', 'trial', 'worker', 'us', 'pa-', 'rameters', 'current', 'best', 'worker', 'the', 'work', 'done', 'serf', 'pre-training', 'new', 'trial', 'similarly', 'enters', 'plateau', 'master', 'instructs', 'start', 'new', 'trial', 'using', 'parameter', 'whose', 'model', 'best', 'performance', 'point', 'time', 'the', 'control', 'flow', 'collaborative', 'tuning', 'scheme', 'described', 'algorithm', 'similar', 'algorithm', 'except', 'master', 'instructs', 'worker', 'save', 'model', 'parameter', 'global', 'pa-', 'rameter', 'server', 'line', 'model', 'performance', 'significantly', 'larger', 'current', 'best', 'performance', 'line', 'the', 'performance', 'difference', 'i.e', 'conf.delta', 'configuration', 'parameter', 'hyper-', 'conf', 'set', 'according', 'user', 'expectation', 'performance', 'model', 'for', 'example', 'mnist', 'image', 'classi-', 'fication', 'improvement', '0.1', 'large', 'current', 'best', 'performance', 'for', 'cifar-10', 'image', 'classification', 'may', 'set', 'delta', '0.5', 'best', 'accuracy', '97.4', 'mean', 'bigger', 'improvement', 'space', 'notice', 'bad', 'parameter', 'initialization', 'degrades', 'perfor-', 'mance', 'experiment', 'this', 'serious', 'random', 'search', 'because', 'checkpoint', 'one', 'trial', 'poor', 'accuracy', 'would', 'affect', 'next', 'trial', 'model', 'parameter', 'initialized', 'poor', 'state', 'resolve', 'problem', 'α-greedy', 'strategy', 'intro-', 'duced', 'implementation', 'initializes', 'model', 'param-', 'eters', 'either', 'random', 'initialization', 'pre-trained', 'model', 'checkpoint', 'file', 'threshold', 'represents', 'probability', 'choos-', 'ing', 'random', 'initialization', '1-α', 'represents', 'probability', 'us-', 'ing', 'pre-trained', 'checkpoint', 'file', 'decrease', 'gradually', 'decrease', 'chance', 'random', 'initialization', 'i.e', 'increasing', 'chance', 'costudy', 'this', 'α-greedy', 'strategy', 'widely', 'used', 'reinforcement', 'learning', 'balance', 'exploration', 'exploitation', 'inference', 'service', '7https', '//keras.io/callbacks/', 'earlystopping', 'algorithm', 'costudy', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'best', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', '...', 'algorithm', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'msg.p', 'best', 'conf.delta', 'send', 'msg.worker', 'kput', 'best', 'msg.p', 'else', 'adv.early', 'stopping', 'msg.worker', 'conf', 'send', 'msg.worker', 'kstop', 'end', 'else', 'msg.type', 'kfinish', 'num', 'end', 'end', 'return', 'adv.best', 'trial', 'inference', 'service', 'provides', 'real-time', 'request', 'serving', 'deploy-', 'ing', 'trained', 'model', 'other', 'service', 'like', 'database', 'service', 'sim-', 'ply', 'optimize', 'throughput', 'constraint', 'latency', 'set', 'manually', 'service', 'level', 'objective', 'slo', 'denoted', 'e.g', '0.1', 'second', 'for', 'machine', 'learning', 'service', 'accuracy', 'becomes', 'important', 'optimization', 'objective', 'the', 'accuracy', 'refers', 'wide', 'range', 'performance', 'measurement', 'e.g', 'negative', 'error', 'precision', 'recall', 'area', 'curve', 'etc', 'larger', 'value', 'accuracy', 'indicates', 'better', 'performance', 'set', 'latency', 'hard', 'constraint', 'shown', 'equation', 'overdue', 'request', 'would', 'get', 'time', 'response', 'typically', 'delayed', 'response', 'better', 'error', 'time', 'end-users', 'hence', 'process', 'request', 'queue', 'se-', 'quentially', 'following', 'fifo', 'first-in-first-out', 'the', 'objective', 'maximize', 'accuracy', 'minimize', 'exceeding', 'time', 'accord-', 'ing', 'however', 'typically', 'trade-off', 'accuracy', 'latency', 'for', 'example', 'ensemble', 'modeling', 'model', 'increase', 'accuracy', 'latency', 'shall', 'optimize', 'model', 'selection', 'ensemble', 'modeling', 'section', '5.2', 'before', 'discus', 'simpler', 'case', 'single', 'inference', 'model', 'table', 'summarizes', 'notation', 'used', 'section', 'maxaccuracy', 'subject', '5.1', 'single', 'inference', 'model', 'when', 'one', 'single', 'model', 'deployed', 'application', 'accuracy', 'inference', 'service', 'fixed', 'system', 'per-', 'spective', 'therefore', 'optimization', 'objective', 'reduced', 'mini-', 'mizing', 'exceeding', 'time', 'formalized', 'equation', 'min', 's∈smax', '|s|', 'the', 'latency', 'request', 'includes', 'waiting', 'time', 'queue', 'inference', 'time', 'depends', 'model', 'complexity', 'hardware', 'efficiency', 'i.e', 'flop', 'batch', 'size', 'the', 'batch', 'size', 'decides', 'number', 'request', 'processed', 'to-', 'gether', 'modern', 'processing', 'unit', 'like', 'cpu', 'gpu', 'exploit', 'data', 'parallelism', 'technique', 'e.g', 'simd', 'improve', 'throughput', 'reduce', 'computation', 'cost', 'hence', 'large', 'batch', 'size', 'necessary', 'table', 'notation', 'name', 'definition', 'request', 'list', 'model', 'list', 'latency', 'requirement', 'one', 'batch', 'size', 'candidate', 'list', 'k−th', 'oldest', 'request', 'queue', 'oldest', 'request', 'latest', '|q|', 'request', 'inference', 'time', 'batch', 'size', 'inference', 'time', 'model', 'batch', 'size', 'waiting', 'time', 'request', 'queue', 'latency', 'waiting', 'inference', 'time', 'request', 'balancing', 'factor', 'accuracy', 'latency', 'binary', 'vector', 'model', 'selection', 'reward', 'function', 'set', 'request', 'saturate', 'parallelism', 'capacity', 'once', 'model', 'deployed', 'cloud', 'platform', 'model', 'complexity', 'hardware', 'efficiency', 'fixed', 'therefore', 'rafiki', 'tune', 'batch', 'size', 'optimize', 'latency', 'construct', 'large', 'batch', 'e.g', 'request', 'delay', 'processing', 'request', 'arrive', 'may', 'incur', 'large', 'latency', 'old', 'request', 'request', 'arrival', 'rate', 'low', 'the', 'op-', 'timal', 'batch', 'size', 'thus', 'influenced', 'slo', 'queue', 'status', 'e.g', 'waiting', 'time', 'request', 'arrival', 'rate', 'varies', 'along', 'time', 'since', 'inference', 'time', 'two', 'similar', 'batch', 'size', 'varies', 'lit-', 'tle', 'e.g', 'b=8', 'b=9', 'candidate', 'batch', 'size', 'list', 'include', 'value', 'significant', 'difference', 'w.r.t', 'in-', 'ference', 'time', 'e.g', '...', 'the', 'largest', 'batch', 'size', 'determined', 'system', 'gpu', 'memory', 'latency', 'processing', 'batch', 'request', 'determined', 'hard-', 'ware', 'resource', 'e.g', 'gpu', 'memory', 'model', 'complexity', 'figure', 'show', 'inference', 'time', 'memory', 'footprint', 'accuracy', 'popular', 'convnets', 'trained', 'imagenet', 'algorithm', 'show', 'greedy', 'solution', 'problem', 'al-', 'way', 'applies', 'largest', 'batch', 'size', 'possible', 'queue', 'length', 'i.e', 'number', 'request', 'queue', 'larger', 'largest', 'batch', 'size', 'max', 'oldest', 'request', 'processed', 'one', 'batch', 'otherwise', 'wait', 'oldest', 'request', 'overdue', 'checked', 'line', 'largest', 'batch', 'size', 'smaller', 'equal', 'queue', 'length', 'line', 'back-off', 'constant', 'equivalent', 'reducing', 'batch', 'size', 'additive-increase-multiplicative-decrease', 'scheme', 'aimd', 'e.g', '0.1τ', 'algorithm', 'inference', 'queue', 'model', 'true', 'maxb', 'len', 'm.infer', 'deque', 'else', 'max', 'len', 'm.infer', 'deque', 'end', 'end', 'end', '5.2', 'multiple', 'inference', 'model', 'single', 'model', 'two', 'model', 'three', 'model', 'four', 'model', 'ensemble', 'method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'figure', 'accuracy', 'ensemble', 'modeling', 'different', 'model', 'ensemble', 'modeling', 'effective', 'popular', 'approach', 'im-', 'prove', 'inference', 'accuracy', 'give', 'example', 'compare', 'performance', 'different', 'ensemble', 'convnets', 'shown', 'figure', 'majority', 'voting', 'applied', 'aggregate', 'prediction', 'the', 'accuracy', 'evaluated', 'validation', 'dataset', 'imagenet', 'generally', 'model', 'accuracy', 'better', 'the', 'exception', 'ensemble', 'resnet', '101', 'inception', 'good', 'single', 'best', 'model', 'i.e', 'inception', 'resnet', 'fact', 'prediction', 'ensemble', 'modeling', 'incep-', 'tion', 'tie', 'prediction', 'model', 'best', 'accuracy', 'selected', 'final', 'prediction', 'parallel', 'ensemble', 'modeling', 'running', 'one', 'model', 'per', 'node', 'gpu', 'straight-forward', 'way', 'scale', 'system', 'improve', 'throughput', 'however', 'latency', 'could', 'high', 'due', 'straggler', 'for', 'example', 'shown', 'figure', 'node', 'running', 'nasnet', 'large', 'would', 'slow', 'although', 'accuracy', 'high', 'addition', 'en-', 'semble', 'modeling', 'also', 'costly', 'term', 'throughput', 'com-', 'pared', 'serving', 'different', 'request', 'different', 'node', 'i.e', 'ensemble', 'see', 'trade-off', 'latency', 'throughput', 'accuracy', 'controlled', 'model', 'selec-', 'tion', 'request', 'arrive', 'slowly', 'simply', 'run', 'model', 'batch', 'get', 'best', 'accuracy', 'however', 'request', 'arrival', 'rate', 'high', 'like', 'section', '5.1', 'select', 'different', 'model', 'different', 'request', 'increase', 'throughput', 'reduce', 'latency', 'addition', 'model', 'selection', 'current', 'batch', 'also', 'affect', 'next', 'batch', 'for', 'example', 'use', 'model', 'batch', 'next', 'batch', 'wait', 'least', 'one', 'model', 'finish', 'solve', 'equation', 'balance', 'accuracy', 'latency', 'get', 'single', 'optimization', 'objective', 'move', 'latency', 'term', 'objective', 'shown', 'equation', 'maximizes', 'reward', 'functionr', 'related', 'prediction', 'accuracy', 'penalizes', 'overdue', 'request', 'balance', 'accuracy', 'latency', 'objective', 'ground', 'truth', 'request', 'available', 'evaluating', 'accuracy', 'normal', 'case', 'find', 'surrogate', 'accuracy', 'maxr', 'like', 'analysis', 'single', 'inference', 'model', 'need', 'consider', 'batch', 'size', 'selection', 'well', 'difficult', 'design', 'optimal', 'policy', 'complex', 'decision', 'making', 'problem', 'decides', 'model', 'selection', 'batch', 'size', 'selection', 'paper', 'propose', 'optimize', 'equation', 'using', 'reinforcement', 'learning', 'optimizes', 'objective', 'long', 'term', 'trying', 'different', 'action', 'entering', 'corresponding', 'state', 'collect', 'reward', 'setting', 'reward', 'equation', 'defining', 'action', 'model', 'selection', 'batch', 'selection', 'apply', 'optimization', 'problem', 'three', 'core', 'concept', 'namely', 'action', 'reward', 'state', 'once', 'three', 'concept', 'defined', 'apply', 'existing', 'al-', 'gorithms', 'optimization', 'define', 'three', 'concept', 'w.r.t', 'optimization', 'problem', 'follows', 'first', 'state', 'space', 'consists', 'queue', 'status', 'represented', 'waiting', 'time', 'request', 'queue', 'the', 'waiting', 'time', 'request', 'form', 'feature', 'vec-', 'tor', 'generate', 'fixed', 'length', 'feature', 'vector', 'pad', 'shorter', 'queue', 'truncate', 'longer', 'queue', 'model', 'status', 'represented', 'vector', 'including', 'inference', 'time', 'different', 'model', 'different', 'batch', 'size', 'i.e', 'left', 'time', 'finish', 'existing', 'request', 'dispatched', 'the', 'two', 'feature', 'vector', 'concatenated', 'state', 'feature', 'vector', 'input', 'model', 'generating', 'action', 'second', 'action', 'decides', 'batch', 'size', 'model', 'selection', 'represented', 'binary', 'vector', 'length', 'selected', 'unselected', 'the', 'action', 'space', 'size', 'thus', '2|m|−', '|b|', 'exclude', 'case', 'i.e', 'none', 'model', 'selected', 'third', 'following', 'equation', 'reward', 'one', 'batch', 'request', 'without', 'ground', 'truth', 'label', 'defined', 'equation', 'accuracy', 'selected', 'model', 'ensemble', 'modeling', 'paper', 'use', 'accuracy', 'evaluated', 'validation', 'dataset', 'surrogate', 'accu-', 'racy', 'experiment', 'use', 'imagenet', 'validation', 'dataset', 'evaluate', 'accuracy', 'different', 'ensemble', 'combination', 'im-', 'age', 'classification', 'the', 'result', 'shown', 'figure', 'the', 'reward', 'shown', 'equation', 'considers', 'accuracy', 'latency', 'indirectly', 'represented', 'number', 'overdue', 'request', 'number', 'request', 'batch|l', 'with', 'state', 'action', 'reward', 'well', 'defined', 'apply', 'actor-critic', 'algorithm', 'optimize', 'overall', 'reward', 'learn-', 'ing', 'good', 'policy', 'selecting', 'model', 'batch', 'size', 'system', 'implementation', 'section', 'introduce', 'implementation', 'detail', 'rafiki', 'including', 'cluster', 'management', 'data', 'parameter', 'storage', 'failure', 'recovery', '6.1', 'cluster', 'management', 'manager', 'master', 'data', 'worker', 'worker', 'parameter', 'master', 'data', 'worker', 'worker', 'parameter', 'train', 'inference', 'node', 'node', 'cnode', 'figure', 'rafiki', 'cluster', 'topology', 'rafiki', 'us', 'kubernetes', 'manage', 'docker', 'container', 'run', 'master', 'worker', 'data', 'server', 'parameter', 'server', 'shown', 'figure', 'docker', 'container', 'widely', 'used', 'applica-', 'tion', 'deployment', 'bundle', 'application', 'code', 'e.g', 'training', 'inference', 'code', 'library', 'e.g', 'kera', 'avoid', 'tedious', 'en-', 'vironment', 'setup', 'new', 'model', 'hyper-parameter', 'tuning', 'algorithm', 'ensemble', 'modeling', 'approach', 'deployed', 'new', 'docker', 'container', 'physical', 'node', 'could', 'multiple', 'master', 'worker', 'different', 'job', 'including', 'training', 'infer-', 'ence', 'job', 'these', 'job', 'started', 'rafiki', 'manager', 'accepts', 'job', 'submission', 'user', 'see', 'figure', 'once', 'job', 'launched', 'user', 'communicate', 'master', 'directly', 'get', 'training', 'progress', 'submit', 'query', 'request', 'rafiki', 'prefers', 'locate', 'master', 'worker', 'job', 'physical', 'node', 'avoid', 'network', 'communication', 'overhead', '6.2', 'data', 'parameter', 'storage', 'deep', 'learning', 'model', 'typically', 'trained', 'large', 'datasets', 'would', 'consume', 'lot', 'space', 'stored', 'cpu', 'memory', 'there-', 'fore', 'rafiki', 'us', 'hdfs', 'data', 'storage', 'data', 'node', 'also', 'docker', 'container', 'user', 'upload', 'datasets', 'hdfs', 'via', 'rafiki', 'utility', 'function', 'e.g', 'rafiki.import', 'image', 'see', 'fig-', 'ure', 'the', 'training', 'dataset', 'downloaded', 'local', 'directory', 'be-', 'fore', 'training', 'via', 'rafiki.download', 'passing', 'dataset', 'name', 'for', 'model', 'parameter', 'rafiki', 'distributed', 'parameter', 'server', 'the', 'parameter', 'server', 'designed', 'special', 'optimiza-', 'tion', 'hyper-parameter', 'training', 'inference', 'particular', 'hyper-parameters', 'cached', 'memory', 'accessed', 'frequently', 'e.g', 'rafiki', 'hyper-parameter', 'training', 'otherwise', 'stored', 'hdfs', 'the', 'parameter', 'trained', 'model', 'different', 'datasets', 'shared', 'long', 'privacy', 'setting', 'public', 'shown', 'training', 'warm-up', 'using', 'parameter', 'pre-trained', 'datasets', 'speed', 'training', '6.3', 'failure', 'recovery', 'for', 'hyper-parameter', 'training', 'inference', 'service', 'worker', 'stateless', 'hence', 'rafiki', 'manager', 'easily', 'recover', 'node', 'running', 'new', 'docker', 'container', 'registering', 'training', 'inference', 'master', 'however', 'master', 'state', 'information', 'for', 'example', 'master', 'training', 'ser-', 'vice', 'record', 'current', 'best', 'hyper-parameter', 'trial', 'the', 'master', 'inference', 'service', 'state', 'action', 'reward', 'reinforce-', 'ment', 'learning', 'rafiki', 'checkpoint', 'small', 'state', 'information', 'master', 'fast', 'failure', 'recovery', 'experimental', 'study', 'section', 'evaluate', 'scalability', 'efficiency', 'effec-', 'tiveness', 'rafiki', 'hyper-parameter', 'tuning', 'inference', 'ser-', 'vice', 'optimization', 'respectively', 'the', 'experiment', 'conducted', 'three', 'machine', 'nvidia', 'gtx', '1080ti', 'gpus', 'intel', 'e5-1650v4', 'cpu', '64gb', 'memory', '7.1', 'evaluation', 'hyper-parameter', 'tuning', 'task', 'dataset', 'test', 'rafiki', 'distributed', 'hyper-parameter', 'tuning', 'service', 'running', 'tune', 'hyper-parameters', 'deep', 'convnets', 'cifar-10', 'image', 'classification', 'cifar-10', 'popular', 'benchmark', 'dataset', 'rgb', 'image', 'category', 'each', 'category', '5000', 'training', 'image', 'including', '1000', 'validation', 'image', '1000', 'test', 'image', 'all', 'image', 'size', '32x32', 'there', 'standard', 'sequence', 'preprocessing', 'step', 'cifar-10', 'subtracts', 'mean', 'divide', 'standard', 'deviation', 'channel', 'computed', 'training', 'image', 'pad', 'image', 'pixel', 'zero', 'side', 'obtain', '40x40', 'pixel', 'image', 'ran-', 'domly', 'crop', '32x32', 'patch', 'flip', 'horizontal', 'direction', 'image', 'randomly', 'probability', '0.5', '100', '200', 'trial', 'index', 'lid', 'without', 'costudy', '100', '200', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', '200', 'total', 'training', 'epoch', 'lid', 'wihtout', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tuning', 'based', 'random', 'search', '100', 'trial', 'index', 'lid', 'without', 'costudy', '100', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', 'total', 'training', 'epoch', 'lid', 'without', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tuning', 'based', 'bayesian', 'optimization', '7.1.1', 'tuning', 'optimization', 'hyper-parameters', 'fix', 'convnet', 'architecture', 'shown', 'table', 'convolution', 'layer', 'the', 'hyper-parameters', 'tuned', 'optimization', 'algorithm', 'including', 'momen-', 'tum', 'learning', 'rate', 'weight', 'decay', 'coefficient', 'dropout', 'rate', 'standard', 'deviation', 'gaussian', 'distribution', 'weight', 'initial-', 'ization', 'run', 'trial', 'early', 'stopping', 'terminates', 'training', 'validation', 'loss', 'stop', 'decreasing', 'compare', 'naı̈ve', 'distributed', 'tuning', 'algorithm', 'i.e', 'study', 'algorithm', 'collaborative', 'tuning', 'algorithm', 'i.e', 'cos-', 'tudy', 'algorithm', 'different', 'trialadvisor', 'algorithm', 'figure', 'show', 'comparison', 'using', 'random', 'search', 'trialadvisor', 'particular', 'point', 'figure', 'stand', 'one', 'trial', 'see', 'top', 'area', 'costudy', 'denser', 'study', 'word', 'costudy', 'likely', 'get', 'better', 'performance', 'this', 'confirmed', 'figure', 'show', 'costudy', 'trial', 'high', 'accuracy', 'i.e', 'accuracy', 'study', 'fewer', 'trial', 'low', 'accuracy', 'i.e.', 'accuracy≤50', 'figure', 'illustrates', 'tuning', 'progress', 'two', 'approach', 'point', 'line', 'represents', 'best', 'performance', 'among', 'trial', 'conducted', 'far', 'the', 'x-axis', 'total', 'number', 'training', 'epochs8', 'corre-', 'sponds', 'tuning', 'time', '=total', 'number', 'epoch', 'time', 'time', 'per', 'epoch', 'observe', 'costudy', 'faster', 'study', 'achieves', 'better', 'accuracy', 'study', 'notice', 'validation', 'ac-', 'curacy', 'high', 'therefore', 'small', 'difference', 'indicates', 'significant', 'improvement', 'figure', 'compare', 'study', 'costudy', 'using', 'gaussian', 'process', 'based', 'bayesian', 'optimization', 'trialadvisor', 'comparing', 'figure', 'figure', 'see', 'point', 'top', 'area', 'figure', 'word', 'better', 'random', '8training', 'model', 'scanning', 'dataset', 'called', 'one', 'epoch', '9https', '//github.com/scikit-optimize', 'searchwhich', 'observed', 'paper', 'figure', 'costudy', 'point', 'right', 'bottom', 'area', 'cos-', 'tudy', 'after', 'in-depth', 'inspection', 'found', 'point', 'trial', 'initialized', 'randomly', 'instead', 'pre-trained', 'model', 'for', 'study', 'always', 'us', 'random', 'initialization', 'hence', 'algo-', 'rithm', 'fixed', 'prior', 'initialization', 'method', 'however', 'costuy', 'initialization', 'pre-trained', 'model', 'time', 'these', 'random', 'initialization', 'trial', 'change', 'prior', 'thus', 'get', 'biased', 'estimation', 'gaussian', 'process', 'lead', 'poor', 'accuracy', 'since', 'decaying', 'reduce', 'chance', 'random', 'initialization', 'fewer', 'fewer', 'point', 'right', 'bottom', 'area', 'overall', 'costudy', 'achieves', 'better', 'accuracy', 'shown', 'figure', 'figure', 'study', 'scalability', 'rafiki', 'varying', 'number', 'work-', 'er', 'figure', 'compare', 'job', 'running', 'gpus', 'respectively', 'each', 'point', 'curve', 'figure', 'represents', 'best', 'validation', 'performance', 'among', 'trial', 'tested', 'far', 'the', 'x-axis', 'wall', 'clock', 'time', 'see', 'gpus', 'tuning', 'becomes', 'faster', 'scale', 'almost', 'linearly', '7.2', 'evaluation', 'inference', 'optimization', 'use', 'image', 'classification', 'application', 'test', 'opti-', 'mization', 'technique', 'introduced', 'section', 'the', 'inference', 'model', 'convnets', 'trained', 'imagenet', 'benchmark', 'dataset', 'imagenet', 'popular', 'image', 'classification', 'benchmark', 'many', 'open-source', 'convnets', 'trained', 'figure', '1.2', 'million', 'rgb', 'training', 'image', '50,000', 'validation', 'image', 'our', 'environment', 'simulator', 'randomly', 'sample', 'image', 'validation', 'dataset', 'request', 'the', 'number', 'request', 'deter-', 'mined', 'follows', 'first', 'simulate', 'scenario', 'high', 'arriving', 'rate', 'low', 'arriving', 'rate', 'set', 'arriving', 'rate', 'based', 'maximum', 'throughput', 'minimum', 'throughput', 'specifically', 'maximum', 'throughput', 'sum', 'model', 'throughput', 'achieved', 'model', 'run', 'asynchronously', '250', '500', '750', '1000', '1250', '1500', 'time', 'second', '100', '200', '300', '400', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'number', 'worker', '500', '1000', '1500', '250', '500', '750', '1000', 'wall', 'time', 'minute', 'lid', 'worker', 'worker', 'worker', 'worker', 'figure', 'scalability', 'test', 'distributed', 'hyper-parameter', 'tuning', 't/2t/4', '0.1t', '0.1t', 'figure', 'sine', 'function', 'controlling', 'request', 'arriving', 'rate', 'process', 'different', 'batch', 'request', 'contrast', 'mod-', 'el', 'run', 'synchronously', 'slowest', 'model', 'throughput', 'minimum', 'throughput', 'second', 'use', 'sine', 'function', 'extreme', 'throughput', 'value', 'define', 'request', 'arriving', 'rate', 'i.e', 'γsin', 'the', 'slope', 'intercept', 'derived', 'solving', 'equation', 'cycle', 'period', 'configured', '500', 'experiment', 'the', 'first', 'equation', 'make', 'sure', 'request', 'generated', 'cycle', 'period', 'figure', '0.2t', 'way', 'simulating', 'real-life', 'environment', 'overwhelming', 'request', 'coming', 'time', 'the', 'second', 'equa-', 'tion', 'make', 'sure', 'highest', 'arriving', 'rate', 'large', 'otherwise', 'request', 'queue', 'would', 'filled', 'quickly', 'new', 'request', 'dropped', 'finally', 'small', 'random', 'noise', 'applied', 'prevent', 'algorithm', 'remembering', 'sine', 'function', 'conclude', 'number', 'new', 'request', 'γsin', '0.1', 'time', 'span', 'last', 'invocation', 'simulator', 'current', 'time', 'sin', 't/2−', '0.2×', '2t/2', 'sin', 't/2', '1.1×', '7.2.1', 'single', 'inference', 'model', 'use', 'inception', 'trained', 'imagenet', 'single', 'infer-', 'ence', 'model', 'besides', 'greedy', 'algorithm', 'algorithm', 'also', 'run', 'algorithm', 'section', '5.2', 'decide', 'batch', 'size', 'the', 'state', 'section', '5.2', 'except', 'model', 'related', 'status', 'removed', 'the', 'batch', 'size', 'list', 'the', 'maximum', 'throughput', 'max', 'b/c', '64/0.23', '272', 'images/second', 'minimum', 'throughput', 'min', 'b/c', '16/0.07', '228', 'set', '0.56s', 'figure', 'compare', 'algorithm', 'greedy', 'algorithm', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', 'see', 'iteration', 'performs', 'similarly', 'greedy', 'algorithm', 'request', 'arriving', 'rate', 'high', 'when', 'low', 'performs', 'better', 'greedy', 'algorithm', 'this', 'request', 'left', 'queue', 'length', 'equal', 'batch', 'size', 'line', 'algorithm', 'these', 'left', 'request', 'likely', 'overdue', 'new', 'request', 'coming', 'slowly', 'form', 'new', 'batch', 'figure', 'compare', 'algorithm', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'defined', 'based', 'minimum', 'throughput', 'see', 'performs', 'better', 'greedy', 'algorithm', 'ar-', 'riving', 'rate', 'either', 'high', 'low', 'overall', 'since', 'arriving', 'rate', 'smaller', 'figure', 'fewer', 'overdue', 'request', '7.2.2', 'multiple', 'inference', 'model', 'following', 'experiment', 'select', 'inception', 'inception', 'inception', 'resnet', 'construct', 'model', 'list', 'the', 'maxi-', 'mum', 'throughput', 'minimum', 'throughput', '572', 'requests/second', '128', 'requests/second', 'respectively', 'the', 'experimental', 'result', 'plotted', 'figure', 'figure', 'figure', 'the', 'legend', 'text', 'overdue', 'represents', 'number', 'overdue', 'request', 'per', 'sec-', 'ond', 'arriving', 'stand', 'request', 'arriving', 'rate', 'compare', 'algorithm', 'two', 'baseline', 'algorithm', 're-', 'spectively', 'for', 'baseline', 'use', 'greedy', 'algorithm', 'find', 'batch', 'size', 'they', 'differ', 'model', 'selection', 'strategy', 'the', 'first', 'baseline', 'run', 'model', 'synchronously', 'batch', 'request', 'correspondingly', 'request', 'generated', 'using', 'rate', 'based', 'from', 'figure', '14a', 'figure', '14b', 'see', 'greedy', 'algorithm', 'fixed', 'accuracy', 'whereas', 'algorithm', 'ac-', 'curacy', 'high', 'resp', 'low', 'rate', 'low', 'resp', 'high', '250', '500', '750', '1000', '1250', '1500', 'time', 'second', '100', '150', '200', '250', '300', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'time', 'second', '0.78', '0.80', '0.82', '0.84', '100', '125', '150', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'second', '0.802', '0.804', '0.806', '0.808', '0.810', '100', '125', '150', 'algorithm', '500', '1000', 'time', 'second', '100', '150', '200', 'overdue', 'arriving', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'second', '100', '150', '200', 'overdue', 'arriving', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'minimum', 'throughput', '500', '1000', 'time', 'second', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'second', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'algorithm', '500', '1000', 'time', 'second', '200', '400', '600', '800', '1000', 'overdue', 'arriving', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'second', '200', '400', '600', '800', '1000', 'overdue', 'arriving', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arriving', 'rate', 'defined', 'based', 'maximum', 'throughput', '2000', '4000', '6000', 'time', 'second', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'second', '0.795', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'second', '100', '150', '200', 'overdue', 'arriving', '2000', '4000', '6000', 'time', 'second', '100', '150', '200', 'overdue', 'arriving', 'figure', 'comparison', 'effect', 'different', 'algorithm', 'fact', 'synchronous', 'algorithm', 'always', 'us', 'model', 'en-', 'semble', 'modelling', 'whereas', 'algorithm', 'us', 'fewer', 'model', 'ensemble', 'modeling', 'arriving', 'rate', 'high', 'since', 'request', 'arriving', 'rate', 'low', 'baseline', 'able', 'handle', 'al-', 'request', 'similar', 'figure', 'overdue', 'request', 'figure', '14c', 'due', 'mismatch', 'queue', 'size', 'batch', 'size', 'algorithm', 'the', 'second', 'baseline', 'run', 'model', 'asynchronously', 'one', 'model', 'per', 'batch', 'request', 'word', 'ensemble', 'mod-', 'eling', 'correspondingly', 'request', 'generated', 'using', 'rate', 'based', 'see', 'better', 'accuracy', 'figure', '15a', '15b', 'fewer', 'overdue', 'request', 'figure', '15c', '15d', 'baseline', 'moreover', 'adaptive', 'request', 'arriving', 'rate', 'when', 'rate', 'high', 'us', 'fewer', 'model', 'serve', 'batch', 'im-', 'prove', 'throughput', 'reduce', 'overdue', 'request', 'when', 'rate', 'low', 'us', 'model', 'serve', 'batch', 'improve', 'accuracy', 'also', 'compare', 'effect', 'different', 'namely', 'reward', 'function', 'i.e', 'equation', 'figure', 'show', 'result', 'request', 'generated', 'based', 'see', 'smaller', 'accuracy', 'figure', '16a', 'higher', 'this', 'reward', 'function', 'focus', 'accuracy', 'part', 'con-', 'sequently', 'many', 'overdue', 'request', 'shown', 'figure', '16c', 'contrast', 'reward', 'function', 'try', 'avoid', 'overdue', 'request', 'reducing', 'number', 'model', 'ensemble', 'there-', 'fore', 'accuracy', 'number', 'overdue', 'request', 'smaller', 'figure', '16b', 'figure', '16d', 'case', 'study', 'usability', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'figure', 'sql', 'table', 'creation', 'section', 'detail', 'rafiki', 'help', 'database', 'expert', 'use', 'deep', 'learning', 'service', 'easily', 'existing', 'application', 'present', 'scenario', 'analyzing', 'food', 'preference', 'user', 'food', 'logging', 'application', 'shown', 'figure', 'this', 'application', 'keep', 'log', 'food', 'user', 'eats', 'storing', 'time', 'loca-', 'tion', 'photo', 'meal', 'for', 'simplicity', 'assume', 'data', 'stored', 'one', 'table', 'created', 'figure', 'each', 'row', 'table', 'contains', 'information', 'meal', 'the', 'image', 'path', 'file', 'path', 'image', 'this', 'image', 'contains', 'picture', 'food', 'however', 'direct', 'way', 'query', 'information', 'e.g.', 'name', 'food', 'image', 'using', 'rafiki', 'database', 'developer', 'collaborates', 'deep', 'learning', 'expert', 'develops', 'train', 'image', 'recog-', 'nition', 'model', 'food', 'image', 'this', 'trained', 'model', 'shared', 'rafiki', 'provides', 'recognition', 'service', 'database', 'user', 'black', 'box', 'via', 'web', 'apis', 'figure', 'display', 'web', 'interface', 'rafiki', 'figure', 'rafiki', 'web', 'interface', 'deep', 'learning', 'expert', 'the', 'deep', 'learning', 'expert', 'prepares', 'training', 'train.py', 'serving', 'serve.py', 'script', 'deep', 'learning', 'model', 'using', 'apache', 'singa', '10http', '//singa.apache.org/', 'database', 'user', 'after', 'uploading', 'training', 'dataset', 'i.e', 'set', 'food', 'image', 'label', 'pair', 'rafiki', 'database', 'user', 'start', 'training', 'job', 'once', 'training', 'finished', 'user', 'deploys', 'trained', 'model', 'serving', 'job', 'afterwards', 'exploit', 'deep', 'learning', 'service', 'get', 'food', 'name', 'sending', 'request', 'rafiki', 'via', 'user-defined', 'function', 'udf', 'the', 'food', 'name', 'function', 'call', 'web', 'api', 'serving', 'application', 'rafiki', 'particular', 'function', 'executed', 'image', 'row', 'sat-', 'isfy', 'condition', 'age', 'greater', 'consequently', 'save', 'much', 'time', 'batch', 'processing', 'supported', 'rafiki', 'side', 'im-', 'prove', 'efficiency', 'furthermore', 'model', 'modified', 're-trained', 'rafiki', 'change', 'sql', 'query', 'database', 'user', 'side', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'select', 'food_name', 'image_path', 'name', 'count', 'foodlog', 'age', 'group', 'name', 'this', 'service', 'also', 'serve', 'request', 'mobile', 'apps', 'demon-', 'strated', 'figure', 'created', 'food', 'logging', 'app', 'sends', 'request', 'rafiki', 'food', 'image', 'prediction', 'conclusion', 'complex', 'analytics', 'become', 'inherent', 'expected', 'func-', 'tionality', 'supported', 'big', 'data', 'system', 'however', 'widely', 'recognized', 'machine', 'learning', 'model', 'easy', 'build', 'train', 'sensitive', 'data', 'distribution', 'characteris-', 'tic', 'therefore', 'important', 'reduce', 'pain', 'point', 'imple-', 'menting', 'tuning', 'dataset', 'specific', 'model', 'step', 'towards', 'making', 'usable', 'paper', 'present', 'rafiki', 'provide', 'training', 'inference', 'service', 'machine', 'learning', 'model', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'system', 'rafiki', 'support', 'effective', 'distributed', 'hyper-parameter', 'tuning', 'training', 'service', 'online', 'ensemble', 'modeling', 'inference', 'service', 'amenable', 'trade', 'latency', 'accu-', 'racy', 'the', 'system', 'evaluated', 'various', 'benchmark', 'illustrate', 'efficiency', 'effectiveness', 'scalability', 'also', 'conducted', 'case', 'study', 'demonstrates', 'system', 'enables', 'database', 'developer', 'use', 'deep', 'learning', 'service', 'easily', 'reference', 'providing', 'database', 'service', 'proceeding', '18th', 'international', 'conference', 'data', 'engineering', 'icde', 'page', '29–', 'washington', 'usa', '2002', 'ieee', 'computer', 'society', 'abadi', 'barham', 'chen', 'chen', 'davis', 'dean', 'devin', 'ghemawat', 'irving', 'isard', 'kudlur', 'levenberg', 'monga', 'moore', 'murray', 'steiner', 'tucker', 'vasudevan', 'warden', 'wicke', 'zheng', 'tensorflow', 'system', 'large-scale', 'machine', 'learning', '12th', 'usenix', 'symposium', 'operating', 'system', 'design', 'implementation', 'osdi', 'page', '265–283', '2016', 'usenix', 'association', 'bergstra', 'bengio', 'random', 'search', 'hyper-parameter', 'optimization', 'mach', 'learn', 'res.', '13:281–305', 'feb.', '2012', 'collobert', 'weston', 'bottou', 'karlen', 'kavukcuoglu', 'kuksa', 'natural', 'language', 'processing', 'almost', 'scratch', 'corr', 'abs/1103.0398', '2011', 'crankshaw', 'wang', 'zhou', 'franklin', 'gonzalez', 'stoica', 'clipper', 'low-latency', 'online', 'prediction', 'serving', 'system', '14th', 'usenix', 'symposium', 'networked', 'system', 'design', 'implementation', 'nsdi', 'page', '613–627', 'boston', '2017', 'usenix', 'association', 'curino', 'philip', 'charles', 'jones', 'popa', 'malviya', 'madden', 'balakrishnan', 'zeldovich', 'relational', 'cloud', 'database-as-a-service', 'cloud', '2011', 'deng', 'dong', 'socher', 'l.-j', 'fei-fei', 'imagenet', 'large-scale', 'hierarchical', 'image', 'database', 'cvpr09', '2009', 'devries', 'taylor', 'improved', 'regularization', 'convolutional', 'neural', 'network', 'cutout', 'corr', 'abs/1708.04552', '2017', 'golovin', 'solnik', 'moitra', 'kochanski', 'karro', 'sculley', 'editor', 'google', 'vizier', 'service', 'black-box', 'optimization', '2017', 'zhang', 'ren', 'sun', 'deep', 'residual', 'learning', 'image', 'recognition', 'corr', 'abs/1512.03385', '2015', 'hinton', 'osindero', 'y.-w.', 'teh', 'fast', 'learning', 'algorithm', 'deep', 'belief', 'net', 'neural', 'comput.', ':1527–1554', 'july', '2006', 'howard', 'zhu', 'chen', 'kalenichenko', 'wang', 'weyand', 'andreetto', 'adam', 'mobilenets', 'efficient', 'convolutional', 'neural', 'network', 'mobile', 'vision', 'application', 'corr', 'abs/1704.04861', '2017', 'iandola', 'moskewicz', 'ashraf', 'han', 'dally', 'keutzer', 'squeezenet', 'alexnet-level', 'accuracy', '50x', 'fewer', 'parameter', '1mb', 'model', 'size', 'corr', 'abs/1602.07360', '2016', 'kang', 'emmons', 'abuzaid', 'bailis', 'zaharia', 'noscope', 'optimizing', 'neural', 'network', 'query', 'video', 'scale', 'proc', 'vldb', 'endow.', ':1586–1597', 'aug.', '2017', 'krizhevsky', 'sutskever', 'hinton', 'imagenet', 'classification', 'deep', 'convolutional', 'neural', 'network', 'nip', 'page', '1106–1114', '2012', 'kuncheva', 'whitaker', 'measure', 'diversity', 'classifier', 'ensemble', 'relationship', 'ensemble', 'accuracy', 'mach', 'learn.', ':181–207', 'may', '2003', 'lecun', 'bengio', 'hinton', 'deep', 'learning', 'nature', '521', '7553', ':436–444', '2015', 'zhong', 'liu', 'zhang', 'ease.ml', 'towards', 'multi-tenant', 'resource', 'sharing', 'machine', 'learning', 'workload', 'arxiv:1708.07308', '2017', 'deep', 'reinforcement', 'learning', 'overview', 'corr', 'abs/1701.07274', '2017', 'mnih', 'puigdomènech', 'badia', 'mirza', 'graf', 'lillicrap', 'harley', 'silver', 'kavukcuoglu', 'asynchronous', 'method', 'deep', 'reinforcement', 'learning', 'arxiv', 'e-prints', 'feb.', '2016', 'modi', 'koo', 'foo', 'mewald', 'baylor', 'breck', 'h.-t.', 'cheng', 'wilkiewicz', 'koc', 'lew', 'zinkevich', 'wicke', 'ispir', 'polyzotis', 'fiedel', 'haykal', 'whang', 'roy', 'ramesh', 'jain', 'zhang', 'haque', 'tfx', 'tensorflow-based', 'production-scale', 'machine', 'learning', 'platform', 'kdd', '2017', '2017', 'ooi', 'tan', 'wang', 'wang', 'cai', 'chen', 'gao', 'luo', 'tung', 'wang', 'xie', 'zhang', 'zheng', 'singa', 'distributed', 'deep', 'learning', 'platform', 'acm', 'multimedia', 'page', '685–688', '2015', 'ré', 'agrawal', 'balazinska', 'cafarella', 'jordan', 'kraska', 'ramakrishnan', 'machine', 'learning', 'database', 'the', 'sound', 'thing', 'come', 'cacophony', 'hype', 'sigmod', 'page', '283–284', '2015', 'schulman', 'wolski', 'dhariwal', 'radford', 'klimov', 'proximal', 'policy', 'optimization', 'algorithm', 'corr', 'abs/1707.06347', '2017', 'sculley', 'holt', 'golovin', 'davydov', 'phillips', 'ebner', 'chaudhary', 'young', 'machine', 'learning', 'the', 'high', 'interest', 'credit', 'card', 'technical', 'debt', 'se4ml', 'software', 'engineering', 'machine', 'learning', 'nip', '2014', 'workshop', '2014', 'shahriari', 'swersky', 'wang', 'adam', 'freitas', 'taking', 'human', 'loop', 'review', 'bayesian', 'optimization', 'proceeding', 'ieee', '104', ':148–175', 'jan', '2016', 'simonyan', 'zisserman', 'very', 'deep', 'convolutional', 'network', 'large-scale', 'image', 'recognition', 'corr', 'abs/1409.1556', '2014', 'snoek', 'larochelle', 'adam', 'practical', 'bayesian', 'optimization', 'machine', 'learning', 'algorithm', 'arxiv', 'e-prints', 'june', '2012', 'snoek', 'rippel', 'swersky', 'kiros', 'satish', 'sundaram', 'patwary', 'prabhat', 'adam', 'scalable', 'bayesian', 'optimization', 'using', 'deep', 'neural', 'network', 'arxiv', 'e-prints', 'feb.', '2015', 'sutskever', 'marten', 'dahl', 'hinton', 'importance', 'initialization', 'momentum', 'deep', 'learning', 'proceeding', '30th', 'international', 'conference', 'international', 'conference', 'machine', 'learning', 'volume', 'icml', 'page', 'iii–1139–iii–1147', 'jmlr.org', '2013', 'sutton', 'barto', 'introduction', 'reinforcement', 'learning', 'mit', 'press', 'cambridge', 'usa', '1st', 'edition', '1998', 'szegedy', 'liu', 'jia', 'sermanet', 'reed', 'anguelov', 'erhan', 'vanhoucke', 'rabinovich', 'going', 'deeper', 'convolution', 'corr', 'abs/1409.4842', '2014', 'wang', 'chen', 'chen', 'dinh', 'gao', 'ooi', 'k.-l.', 'tan', 'wang', 'deep', 'learning', 'scale', 'ease', 'transaction', 'multimedia', 'computing', 'communication', 'application', '2016', 'wang', 'chen', 'dinh', 'gao', 'ooi', 'tan', 'wang', 'singa', 'putting', 'deep', 'learning', 'hand', 'multimedia', 'user', 'acm', 'multimedia', 'page', '25–34', '2015', 'wang', 'yang', 'ooi', 'zhang', 'zhuang', 'effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', 'the', 'vldb', 'journal', 'page', '1–23', '2015', 'wang', 'zhang', 'chen', 'jagadish', 'ooi', 'k.-l.', 'tan', 'database', 'meet', 'deep', 'learning', 'challenge', 'opportunity', 'acm', 'sigmod', 'record', ':17–22', '2016', 'zhang', 'zeng', 'zhang', 'how', 'good', 'machine', 'learning', 'cloud', 'binary', 'classification', 'good', 'feature', 'corr', 'abs/1707.09562', '2017', 'zoph', 'neural', 'architecture', 'search', 'reinforcement', 'learning', 'corr', 'abs/1611.01578', '2016']
['rafiki', 'machine', 'learn', 'analytics', 'service', 'system', 'wei', 'wang†', 'sheng', 'wang†', 'jinyang', 'gao†', 'meihui', 'zhang�', 'gang', 'chen‡', 'teck', 'khim', 'ng†', 'beng', 'chin', 'ooi†', '†national', 'university', 'singapore', '�beijing', 'institute', 'technology', '‡zhejiang', 'university', 'wangwei', 'jinyang.gao', 'wangsh', 'ngtk', 'ooibc', 'comp.nus.edu.sg', '�meihui', 'zhang', 'bit.edu.cn', 'zju.edu.cn', 'abstract', 'big', 'data', 'analytics', 'gain', 'massive', 'momentum', 'last', 'year', 'apply', 'machine', 'learn', 'model', 'big', 'data', 'become', 'implicit', 'requirement', 'expectation', 'analysis', 'task', 'especially', 'high-stakes', 'applications.typical', 'application', 'include', 'sentiment', 'analysis', 'review', 'analyze', 'on-line', 'product', 'image', 'classification', 'food', 'log', 'application', 'monitor', 'user', 'daily', 'intake', 'stock', 'movement', 'prediction', 'extend', 'tra-', 'ditional', 'database', 'system', 'support', 'analysis', 'intrigue', 'challenge', 'first', 'almost', 'impossible', 'implement', 'ma-', 'chine', 'learn', 'model', 'database', 'engine', 'second', 'expertise', 'knowledge', 'require', 'optimize', 'train', 'inference', 'proce-', 'dures', 'term', 'efficiency', 'effectiveness', 'impose', 'heavy', 'burden', 'system', 'user', 'paper', 'develop', 'present', 'system', 'call', 'rafiki', 'provide', 'train', 'inference', 'ser-', 'vice', 'machine', 'learn', 'model', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'system', 'rafiki', 'provide', 'distribute', 'hyper-parameter', 'tune', 'train', 'service', 'online', 'ensem-', 'ble', 'model', 'inference', 'service', 'trade', 'latency', 'accuracy', 'experimental', 'result', 'confirm', 'efficiency', 'effectiveness', 'scalability', 'usability', 'rafiki', 'introduction', 'data', 'analysis', 'play', 'important', 'role', 'extract', 'valuable', 'in-', 'sight', 'huge', 'amount', 'data', 'database', 'system', 'traditionally', 'use', 'store', 'analyze', 'structure', 'data', 'spatial-', 'temporal', 'data', 'graph', 'data', 'etc', 'other', 'data', 'multimedia', 'data', 'e.g.', 'image', 'free', 'text', 'domain', 'specific', 'data', 'e.g', 'medical', 'data', 'sensor', 'data', 'generate', 'fast', 'speed', 'con-', 'stitutes', 'significant', 'portion', 'big', 'data', 'beneficial', 'analyze', 'data', 'database', 'application', 'for', 'instance', 'infer', 'quality', 'product', 'review', 'column', 'sale', 'database', 'would', 'help', 'explain', 'sale', 'number', 'analyz-', 'ing', 'food', 'image', 'food', 'log', 'application', 'extract', 'food', 'preference', 'people', 'different', 'age', 'however', 'analysis', 'require', 'machine', 'learn', 'model', 'especially', 'deep', 'learn-', 'ing', 'model', 'sentiment', 'analysis', 'classify', 'review', 'positive', 'negative', 'image', 'classification', 'recognize', 'food', 'type', 'image', 'figure', 'show', 'pipeline', 'data', 'analysis', 'database', 'system', 'widely', 'use', 'first', 'stage', 'machine', 'learn', 'good', '4th', 'stage', 'big', 'data', '大数据', '3vs', 'volume', 'velocity', 'variety', '高容量，速度快，多样性', 'variety', 'imply', 'integrate', 'analyze', 'data', 'necessary', 'develop', 'end-to-end', 'solution', 'scale', 'easy', 'use', 'minimize', 'human', 'effort', 'acquisition', 'extraction/', 'cleaning/', 'annotation', 'integration', 'analysis/', 'model', 'interpretation/', 'visualization', 'figure', 'data', 'analytic', 'pipeline', 'one', 'approach', 'integrate', 'machine', 'learn', 'technique', 'database', 'application', 'preprocess', 'data', 'off-line', 'add', 'prediction', 'result', 'new', 'column', 'e.g', 'column', 'food', 'type', 'however', 'off-line', 'preprocessing', 'two-folds', 'restric-', 'tion', 'first', 'require', 'developer', 'expertise', 'knowledge', 'experience', 'train', 'machine', 'learn', 'model', 'second', 'query', 'involve', 'attribute', 'object', 'e.g', 'ingredient', 'food', 'predict', 'preprocessing', 'step', 'addi-', 'tion', 'would', 'waste', 'lot', 'time', 'prediction', 'row', 'query', 'read', 'food', 'type', 'column', 'row', 'e.g', 'due', 'filter', 'column', 'another', 'approach', 'carry', 'pre-', 'diction', 'on-line', 'user-defined', 'function', 'udfs', 'sql', 'query', 'however', 'challenge', 'implement', 'machine', 'learn', 'mod-', 'el', 'udfs', 'database', 'user', 'machine', 'learn', 'model', 'vary', 'lot', 'term', 'theory', 'implementation', 'also', 'difficult', 'optimize', 'prediction', 'accuracy', 'database', 'engine', 'better', 'solution', 'call', 'correspond', 'cloud', 'machine', 'learn-', 'ing', 'service', 'e.g', 'apis', 'udfs', 'prediction', 'analysis', 'task', 'cloud', 'service', 'economical', 'elastic', 'easy', 'use', 'with', 'resurgence', 'cloud', 'provider', 'like', 'amazon', 'aws', 'google', 'microsoft', 'azure', 'build', 'machine', 'learn', 'service', 'cloud', 'platform', 'there', 'two', 'type', 'cloud', 'service', 'the', 'first', 'one', 'provide', 'api', 'specific', 'task', 'e.g', 'image', 'classifi-', 'cation', 'sentiment', 'analysis', 'such', 'apis', 'available', 'amazon', 'aws1', 'google', 'cloud', 'platform2', 'the', 'disadvantage', 'accuracy', 'could', 'low', 'since', 'model', 'train', 'amazon', 'google', 'data', 'likely', 'different', 'user', 'data', 'the', 'second', 'type', 'service', 'overcome', 'issue', 'provide', 'train', 'service', 'user', 'upload', 'datasets', 'conduct', 'train', 'this', 'service', 'available', 'amazon', 'aws', 'microsoft', 'azure', 'however', 'limit', 'number', 'ma-', 'chine', 'learn', 'model', 'support', 'for', 'example', 'sim-', '1https', '//aws.amazon.com/machine-learning/', '2https', '//cloud.google.com/products/machine-learning/', 'ple', 'logistic', 'regression', 'linear', 'regression', 'models3', 'support', 'amazon', 'deep', 'learn', 'model', 'convolutional', 'neural', 'network', 'convnets', 'recurrent', 'neural', 'network', 'rnn', 'include', 'machine', 'learn', 'cloud', 'service', 'need', 'cover', 'wide', 'range', 'model', 'include', 'deep', 'learn', 'model', 'also', 'provide', 'easy-to-use', 'efficient', 'effective', 'service', 'user', 'with-', 'much', 'machine', 'learn', 'knowledge', 'experience', 'e.g', 'database', 'user', 'consider', 'different', 'model', 'may', 'result', 'different', 'performance', 'term', 'efficiency', 'e.g', 'latency', 'effectiveness', 'e.g', 'accuracy', 'cloud', 'service', 'select', 'proper', 'model', 'give', 'task', 'moreover', 'machine', 'learn', 'model', 'train', 'algorithm', 'come', 'set', 'hyper-parameters', 'knob', 'e.g', 'number', 'layer', 'size', 'layer', 'neural', 'network', 'some', 'hyper-parameters', 'vital', 'convergence', 'train', 'algorithm', 'final', 'model', 'performance', 'e.g', 'learn', 'rate', 'stochastic', 'gradient', 'descent', 'sgd', 'algorithm', 'manual', 'hyper-', 'parameter', 'tune', 'require', 'rich', 'experience', 'tedious', 'random', 'search', 'bayesian', 'optimization', 'two', 'popular', 'automatic', 'tun-', 'ing', 'approach', 'however', 'costly', 'train', 'model', 'till', 'convergence', 'may', 'take', 'hundred', 'hour', 'dis-', 'tributed', 'tune', 'platform', 'desirable', 'besides', 'train', 'inference4', 'also', 'matter', 'directly', 'affect', 'user', 'experience', 'machine', 'learn', 'product', 'often', 'ensemble', 'multiple', 'model', 'average', 'result', 'boost', 'prediction', 'performance', 'however', 'ensemble', 'model', 'incur', 'larger', 'latency', 'i.e', 'response', 'time', 'compare', 'use', 'single', 'prediction', 'model', 'therefore', 'trade-off', 'be-', 'tween', 'accuracy', 'latency', 'there', 'study', 'challenge', 'provide', 'ma-', 'chine', 'learn', 'service', 'mlbench', 'compare', 'cloud', 'ser-', 'vice', 'amazon', 'azure', 'set', 'binary', 'classification', 'task', 'ease.ml', 'build', 'train', 'platform', 'model', 'selection', 'aim-', 'ing', 'optimize', 'resource', 'utilization', 'google', 'vizier', 'distribute', 'hyper-parameter', 'tune', 'platform', 'provide', 'tune', 'service', 'system', 'clipper', 'focus', 'inference', 'propose', 'general', 'framework', 'specific', 'optimization', 'effi-', 'ciency', 'accuracy', 'paper', 'present', 'system', 'call', 'rafiki', 'provide', 'train', 'inference', 'service', 'machine', 'learn', 'mod-', 'el', 'with', 'rafiki', 'database', 'user', 'exempt', 'manage', 'hardware', 'resource', 'construct', 'deep', 'learn', 'model', 'tun-', 'ing', 'hyper-parameters', 'optimize', 'prediction', 'accuracy', 'speed', 'instead', 'simply', 'upload', 'datasets', 'configure', 'service', 'conduct', 'train', 'deploy', 'model', 'infer-', 'ence', 'cloud', 'service', 'system', 'rafiki', 'manage', 'hard-', 'ware', 'resource', 'failure', 'recovery', 'etc', 'come', 'set', 'built-in', 'deep', 'learn', 'model', 'popular', 'task', 'image', 'text', 'process', 'addition', 'make', 'follow', 'contribution', 'make', 'rafiki', 'easy-to-use', 'efficient', 'effective', 'propose', 'unify', 'system', 'architecture', 'train-', 'ing', 'inference', 'service', 'observe', 'two', 'ser-', 'vice', 'share', 'common', 'component', 'parameter', 'server', 'model', 'parameter', 'storage', 'distribute', 'comput-', 'ing', 'environment', 'distribute', 'hyper-parameter', 'tune', 'parallel', 'inference', 'share', 'underlie', 'storage', 'communication', 'protocol', 'computation', 'resource', 'im-', 'plicitly', 'avoid', 'technical', 'debt', 'moreover', 'com-', '3https', '//docs.aws.amazon.com/machine-', 'learning/latest/dg/learning-algorithm.html', '4we', 'use', 'term', 'deployment', 'inference', 'serve', 'interchange-', 'ably', 'bin', 'two', 'service', 'together', 'rafiki', 'enable', 'instant', 'model', 'deployment', 'train', 'for', 'train', 'service', 'first', 'propose', 'general', 'frame-', 'work', 'distribute', 'hyper-parameter', 'tune', 'ex-', 'tensible', 'popular', 'hyper-parameter', 'tune', 'algorithm', 'in-', 'cluding', 'random', 'search', 'bayesian', 'optimization', 'addi-', 'tion', 'propose', 'collaborative', 'tune', 'scheme', 'specifically', 'deep', 'learn', 'model', 'us', 'model', 'parameter', 'current', 'top', 'perform', 'train', 'trial', 'initialize', 'new', 'trial', 'for', 'inference', 'service', 'propose', 'schedule', 'algorithm', 'base', 'reinforcement', 'learn', 'optimize', 'overall', 'ac-', 'curacy', 'reduce', 'latency', 'both', 'algorithm', 'adaptive', 'change', 'request', 'arrival', 'rate', 'conduct', 'micro-benchmark', 'experiment', 'evaluate', 'performance', 'propose', 'algorithm', 'reminder', 'paper', 'give', 'system', 'architecture', 'section', 'section', 'describe', 'train', 'service', 'dis-', 'tributed', 'hyper-parameter', 'tune', 'algorithm', 'the', 'deployment', 'ser-', 'vice', 'optimization', 'technique', 'introduce', 'section', 'sec-', 'tion', 'describe', 'system', 'implementation', 'explain', 'ex-', 'perimental', 'study', 'section', 'introduce', 'relate', 'work', 'section', 'relate', 'work', 'rafiki', 'saas', 'provide', 'analytics', 'service', 'base', 'ma-', 'chine', 'learn', 'optimization', 'technique', 'propose', 'train', 'i.e', 'distribute', 'hyper-parameter', 'tune', 'inference', 'stage', 'i.e', 'accuracy', 'latency', 'optimization', 'section', 'review', 'relate', 'work', 'saas', 'hyper-parameter', 'tune', 'inference', 'op-', 'timization', 'reinforcement', 'learn', 'adopt', 'rafiki', 'inference', 'optimization', '2.1', 'software', 'service', 'cloud', 'compute', 'change', 'way', 'operation', 'many', 'company', 'provide', 'infrastructure', 'service', 'iaa', 'platform', 'service', 'paas', 'software', 'service', 'saas', 'with', 'iaa', 'user', 'company', 'use', 'remote', 'physical', 'virtual', 'machine', 'instead', 'establish', 'data', 'center', 'base', 'user', 'require-', 'ments', 'iaa', 'scale', 'compute', 'resource', 'quickly', 'paas', 'e.g.', 'microsoft', 'azure', 'provide', 'development', 'toolkit', 'run', 'envi-', 'ronment', 'adjust', 'automatically', 'base', 'business', 'demand', 'saas', 'include', 'database', 'service', 'install', 'soft-', 'ware', 'cloud', 'compute', 'platform', 'provide', 'application', 'ser-', 'vice', 'simplify', 'software', 'maintenance', 'the', 'pay', 'price', 'model', 'convenient', 'economic', 'small', 'company', 'research', 'lab', 'recently', 'machine', 'learn', 'especially', 'deep', 'learn', 'gain', 'lot', 'interest', 'due', 'outstanding', 'performance', 'analytic', 'predictive', 'task', 'there', 'two', 'primary', 'step', 'apply', 'machine', 'learn', 'application', 'namely', 'train', 'inference', 'cloud', 'provider', 'like', 'amazon', 'aws', 'microsoft', 'azure', 'google', 'cloud', 'already', 'include', 'service', 'two', 'step', 'however', 'train', 'service', 'limit', 'support', 'deep', 'learn', 'mod-', 'el', 'inference', 'service', 'customize', 'customer', 'data', 'see', 'explanation', 'section', 'there', 'also', 'research', 'paper', 'towards', 'efficient', 'resource', 'allocation', 'train', 'efficient', 'inference', 'cloud', 'rafiki', 'differ', 'exist-', 'ing', 'cloud', 'service', 'service', 'type', 'optimization', 'technique', 'firstly', 'rafiki', 'allow', 'user', 'train', 'machine', 'learn', 'include', 'deep', 'learn', 'model', 'data', 'de-', 'ploy', 'inference', 'secondly', 'rafiki', 'special', 'optimization', 'train', 'inference', 'service', 'compare', 'exist', 'approach', 'explain', 'follow', 'two', 'subsection', '2.2', 'hyper-parameter', 'tune', 'train', 'machine', 'learn', 'model', 'application', 'need', 'decide', 'many', 'hyper-parameters', 'relate', 'model', 'structure', 'opti-', 'mization', 'algorithm', 'data', 'preprocessing', 'operation', 'all', 'hyper-', 'parameter', 'tune', 'algorithm', 'work', 'empirical', 'trial', 'random', 'search', 'randomly', 'select', 'value', 'hyper-parameter', 'try', 'show', 'efficient', 'grid', 'search', 'enumerate', 'possible', 'hyper-parameter', 'combination', 'bayesian', 'optimization', 'assume', 'optimization', 'function', 'hyper-parameters', 'input', 'inference', 'performance', 'output', 'follow', 'gaussian', 'process', 'sample', 'next', 'point', 'hyper-parameter', 'space', 'base', 'exist', 'trial', 'accord', 'acquisition', 'function', 'reinforcement', 'learn', 'recently', 'apply', 'tune', 'archi-', 'tecture', 'relate', 'hyper-parameters', 'google', 'vizier', 'provide', 'hyper-parameter', 'tune', 'service', 'cloud', 'rafiki', 'provide', 'dis-', 'tributed', 'hyper-parameter', 'tune', 'service', 'compatible', 'mention', 'hyper-parameter', 'tune', 'algorithm', 'ad-', 'dition', 'support', 'collaborative', 'tune', 'share', 'model', 'parame-', 'ters', 'across', 'trial', 'our', 'experiment', 'confirm', 'effectiveness', 'collaborative', 'tune', 'scheme', '2.3', 'inference', 'optimization', 'improve', 'inference', 'accuracy', 'ensemble', 'model', 'train', 'deploy', 'multiple', 'model', 'widely', 'apply', 'for', 'real-time', 'in-', 'ference', 'latency', 'another', 'critical', 'metric', 'inference', 'service', 'noscope', 'propose', 'specific', 'inference', 'optimization', 'video', 'query', 'clipper', 'study', 'multiple', 'optimization', 'technique', 'improve', 'throughput', 'via', 'batch', 'size', 'reduce', 'latency', 'via', 'cache', 'also', 'propose', 'model', 'selection', 'ensemble', 'mod-', 'eling', 'use', 'multi-armed', 'bandit', 'algorithm', 'compare', 'clip-', 'per', 'rafiki', 'provide', 'train', 'inference', 'service', 'whereas', 'clipper', 'focus', 'inference', 'service', 'also', 'clipper', 'op-', 'timizes', 'throughput', 'latency', 'accuracy', 'separately', 'whereas', 'rafiki', 'model', 'together', 'find', 'optimal', 'model', 'selection', 'batch', 'size', 'tensorflow', 'serve', 'tfx', 'provide', 'inference', 'service', 'model', 'train', 'use', 'tensorflow', 'rafiki', 'clipper', 'implementation', 'agnostic', 'they', 'communicate', 'train', 'inference', 'program', 'docker', 'container', 'via', 'rpc', '2.4', 'reinforcement', 'learn', 'reinforcement', 'learn', 'time', 'agent', 'take', 'one', 'action', 'enter', 'next', 'state', 'the', 'environment', 'return', 'reward', 'base', 'action', 'state', 'the', 'learn', 'objective', 'maximize', 'aggregate', 'reward', 'algorithm', 'decide', 'ac-', 'tion', 'take', 'base', 'current', 'state', 'experience', 'gain', 'previous', 'trial', 'exploration', 'policy', 'gradient', 'base', 'algorithm', 'maximize', 'expect', 'reward', 'take', 'action', 'follow', 'policy', 'function', 'at|st', 'step', 'equation', 'represent', 'trajectory', 'action', 'state', 'reward', 'tuples', 'decay', 'factor', 'the', 'expectation', 'take', 'possible', 'trajec-', 'tory', 'usually', 'implement', 'use', 'multi-layer', 'perceptron', 'model', 'represent', 'parameter', 'take', 'state', 'vector', 'input', 'generate', 'action', 'scalar', 'value', 'continuous', 'action', 'softmax', 'output', 'discrete', 'action', 'equation', 'optimize', 'use', 'stochastic', 'gradient', 'ascent', 'method', 'equation', 'use', 'surrogate', 'function', 'objective', 'gradient', 'easy', 'com-', 'pute', 'via', 'automatic', 'differentiation', 'eς∼πθ', 't=0', 'γtrt', 'oθj', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'eς∼πθ', 't=0', 'log', 'at|st', 't=0', 'γtrt', 'many', 'approach', 'propose', 'improve', 'policy', 'gra-', 'dient', 'reduce', 'variance', 'reward', 'include', 'actor-critic', 'model', 'subtract', 'reward', 'baseline', 'estimation', 'reward', 'also', 'approximate', 'use', 'neural', 'network', 'like', 'policy', 'function', 'then', 'equation', 'becomesrt−v', 'yuxi', 'do', 'survey', 'deep', 'reinforcement', 'learn', 'include', 'actor-critic', 'model', 'use', 'paper', 'system', 'overview', 'section', 'present', 'system', 'architecture', 'rafiki', 'illustrate', 'usability', 'use', 'case', 'use', 'rafiki', 'user', 'simply', 'configure', 'train', 'inference', 'job', 'either', 'restful', 'apis', 'python', 'sdk', 'figure', 'leave', 'column', 'show', 'one', 'image', 'classification', 'example', 'use', 'python', 'sdk', 'the', 'train', 'code', 'consist', 'line', 'the', 'first', 'line', 'load', 'image', 'folder', 'rafiki', 'distribute', 'data', 'stor-', 'age', 'hdfs', 'image', 'subfolder', 'label', 'subfolder', 'name', 'i.e', 'food', 'name', 'the', 'second', 'line', 'create', 'configuration', 'object', 'represent', 'hyper-parameter', 'tune', 'option', 'see', 'section', '4.2', 'detail', 'the', 'third', 'line', 'create', 'train', 'job', 'pass', 'data', 'option', 'input/output', 'shape', 'tuple', 'list', 'tuples', 'the', 'input-output', 'shape', 'use', 'model', 'cus-', 'tomization', 'for', 'example', 'convnets', 'usually', 'accept', 'input', 'image', 'fix', 'shape', 'i.e', 'input', 'shape', 'adapt', 'final', 'output', 'layer', 'generate', 'number', 'output', 'output', 'shape', 'could', 'total', 'number', 'class', 'bounding-box', 'shape', 'the', 'last', 'line', 'submit', 'job', 'restful', 'apis', 'rafiki', 'exe-', 'cution', 'return', 'job', 'handle', 'job', 'monitor', 'once', 'train', 'finish', 'deploy', 'model', 'instantly', 'show', 'infer.py', 'get', 'model', 'instance', 'consist', 'model', 'name', 'parameter', 'name', 'retrieve', 'parameter', 'value', 'rafiki', 'parameter', 'server', 'us', 'second', 'line', 'create', 'inference', 'job', 'give', 'model', 'after', 'model', 'deploy', 'line', 'application', 'user', 'submit', 'request', 'job', 'prediction', 'show', 'code', 'query.py', 'ap-', 'plication', 'like', 'mobile', 'app', 'send', 'restful', 'request', 'query', 'for', 'train', 'job', 'rafiki', 'select', 'correspond', 'built-in', 'model', 'base', 'task', 'type', 'the', 'table', 'figure', 'list', 'built-in', 'task', 'model', 'with', 'proliferation', 'machine', 'learn', 'able', 'find', 'open', 'source', 'implementation', 'al-', 'every', 'model', 'figure', 'compare', 'memory', 'footprint', 'ac-', 'curacy', 'inference', 'speed', 'open', 'source', 'convnets5', 'group', 'convnets', 'compare', 'include', 'inception', 'convnets', 'mobilenet', 'nasnets', 'resnets', 'vggs', 'the', 'accuracy', 'measure', 'base', 'top-1', 'prediction', 'image', 'validation', 'dataset', 'imagenet', 'the', 'inference', 'time', 'mem-', 'ory', 'footprint', 'average', 'iteration', 'image', 'i.e', 'batch', 'size=50', '5https', '//github.com/tensorflow/models/tree/master/research/slim/', 'data', 'hyper-tune', 'hyper-tune', 'ensemble', 'model', 'resnet', 'parameter', 'task', 'model', 'image', 'classification', 'vgg', 'resnet', 'squeezenet', 'xceptionnet', 'inceptionnet', 'object', 'detection', 'yolo', 'ssd', 'fasterrcnn', 'sentiment', 'analysis', 'temporalcnn', 'fasttext', 'characterrnn', 'resnet', 'resnetvgg', 'vgg', 'vgg', 'master', 'worker', 'rafiki', 'user', 'code', 'rafiki', 'application', 'user', 'code', 'train.py', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'infer.py', 'model', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'model', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'ret', 'label', 'figure', 'overview', 'rafiki', '0.2', '0.4', '0.6', '0.8', '1.0', 'time', 'each', 'iteration', '0.70', '0.75', '0.80', 'inception_resnet_v2', 'inception_v1', 'inception_v2', 'inception_v3', 'inception_v4', 'mobilenet_v1', 'nasnet_large', 'nasnet_mobile', 'resnet_v1_50', 'resnet_v1_101', 'resnet_v1_152', 'resnet_v2_50', 'resnet_v2_101', 'resnet_v2_152', 'vgg_16', 'vgg_19', 'figure', 'accuracy', 'inference', 'time', 'memory', 'footprint', 'popular', 'convnets', 'hyper-parameter', 'tune', 'see', 'section', '4.2', 'conduct', 'every', 'select', 'model', 'for', 'example', 'two', 'set', 'hyper-parameters', 'be-', 'ing', 'test', 'resnet', 'resp', 'vgg', 'show', 'figure', 'the', 'train', 'model', 'parameter', 'store', 'global', 'parameter', 'server', 'persistent', 'distribute', 'in-memory', 'storage', 'once', 'train', 'do', 'inference', 'worker', 'fetch', 'parame-', 'ters', 'efficiently', 'the', 'inference', 'job', 'launch', 'model', 'pass', 'user', 'configuration', 'ensemble', 'model', 'see', 'section', 'apply', 'optimize', 'inference', 'accuracy', 'request', 'application', 'e.g', 'database', 'user', 'rafiki', 'compatible', 'machine', 'learn', 'framework', 'in-', 'cluding', 'tensorflow', 'scikit-learn', 'kears', 'etc.', 'although', 'build', 'top', 'apache', 'singa', 'due', 'efficiency', 'scalable', 'architecture', 'more', 'detail', 'rafiki', 'implementation', 'describe', 'section', 'train', 'service', 'the', 'train', 'service', 'consist', 'two', 'step', 'namely', 'model', 'selec-', 'tion', 'hyper-parameter', 'tune', 'adopt', 'simple', 'model', 'selec-', 'tion', 'strategy', 'rafiki', 'for', 'hyper-parameter', 'tune', 'first', 'pro-', 'pose', 'general', 'program', 'model', 'distribute', 'tune', 'propose', 'collaborative', 'tune', 'scheme', '4.1', 'model', 'selection', 'every', 'built-in', 'model', 'rafiki', 'register', 'task', 'e.g', 'im-', 'age', 'classification', 'sentiment', 'analysis', 'each', 'model', 'associate', 'meta', 'data', 'include', 'train', 'cost', 'e.g', 'speed', 'memory', 'consumption', 'performance', 'dataset', 'e.g', 'accuracy', 'area-under-curve', 'ease.ml', 'propose', 'convert', 'model', 'selection', 'multi-armed', 'bandit', 'problem', 'ev-', 'ery', 'model', 'i.e', 'arm', 'get', 'chance', 'train', 'after', 'many', 'trial', 'chance', 'under-performed', 'model', 'would', 'decrease', 'observe', 'model', 'task', 'perform', 'consis-', 'tently', 'across', 'datasets', 'for', 'example', 'resnet', 'better', 'alexnet', 'squeezenet', 'bunch', 'datasets', 'include', 'ima-', 'genet', 'cifar-106', 'etc..', 'therefore', 'adopt', 'simple', 'model', 'selection', 'strategy', 'without', 'advance', 'analysis', 'select', 'model', 'similar', 'performance', 'different', 'architecture', 'this', 'create', 'diverse', 'model', 'set', 'whose', 'performance', 'would', 'boost', 'apply', 'ensemble', 'model', '4.2', 'distribute', 'hyper-parameter', 'tune', 'hyper-parameter', 'tune', 'usually', 'run', 'many', 'different', 'set', 'hyper-parameters', 'distribute', 'tune', 'run', 'instance', 'parallel', 'natural', 'solution', 'reduce', 'tune', 'time', 'there', '6https', '//www.cs.toronto.edu/', 'kriz/cifar.html', 'table', 'hyper-parameter', 'group', 'group', 'hyper-parameter', 'example', 'domain', 'data', 'preprocessing', 'image', 'rotation', '0,30', 'image', 'crop', '0,32', 'whiten', 'pca', 'zca', 'model', 'architecture', 'number', 'layer', 'cluster', 'kernel', 'linear', 'rbf', 'poly', 'train', 'algorithm', 'learn', 'rate', 'weight', 'decay', 'momentum', 'three', 'popular', 'approach', 'hyper-parameter', 'tune', 'namely', 'grid', 'search', 'random', 'search', 'bayesian', 'optimization', 'support', 'algorithm', 'need', 'general', 'extensible', 'pro-', 'gramming', 'model', '4.2.1', 'program', 'model', 'cluster', 'hyper-parameters', 'involve', 'train', 'machine', 'learn', 'model', 'three', 'group', 'show', 'table', 'data', 'prepro-', 'cessing', 'adopt', 'different', 'approach', 'normalize', 'data', 'augment', 'dataset', 'extract', 'feature', 'raw', 'data', 'i.e', 'feature', 'en-', 'gineering', 'most', 'machine', 'learn', 'model', 'tune', 'knob', 'form', 'architecture', 'hyper-parameters', 'e.g', 'number', 'tree', 'random', 'forest', 'number', 'layer', 'convnets', 'kernel', 'function', 'svm', 'the', 'optimization', 'algorithm', 'especially', 'gradient', 'base', 'optimization', 'algorithm', 'like', 'sgd', 'many', 'hyper-parameters', 'include', 'initial', 'learn', 'rate', 'decay', 'rate', 'decay', 'method', 'linear', 'exponential', 'etc', 'from', 'table', 'see', 'hyper-parameters', 'could', 'come', 'range', 'list', 'number', 'category', 'all', 'possible', 'as-', 'signments', 'hyper-parameters', 'construct', 'hyper-parameter', 'space', 'denote', 'follow', 'convention', 'call', 'one', 'point', 'space', 'trial', 'denote', 'rafiki', 'provide', 'hyper-', 'space', 'class', 'function', 'show', 'figure', 'developer', 'specify', 'hyper-parameter', 'space', 'import', 'rafiki', 'data', 'rafiki.import_images', "'food/", 'hyper', 'rafiki.hyperconf', 'job', 'rafiki.train', "name='train", 'data=data', 'task=', 'imageclassification', 'input_shape=', '3,256,256', 'output_shape=', '120', 'hyper', 'hyper', 'job_id', 'job.run', 'model', 'rafiki.get_models', 'job_id', 'job', 'rafiki.inference', 'model', 'job_id', 'job.run', 'img', 'image.load', "'test.jpg", 'ret', 'rafiki.query', 'job=job_id', 'data=', "'img", 'img', 'print', 'ret', "'label", 'class', 'hyperspace', 'def', 'add_range_knob', 'name', 'dtype', 'min', 'max', 'depends=none', 'pre_hook=none', 'post_hook=none', 'def', 'add_categorical_knob', 'name', 'dtype', 'list', 'depends=none', 'pre_hook=none', 'post_hook=none', 'figure', 'hyperspace', 'apis', 'the', 'first', 'function', 'define', 'domain', 'hyper-parameter', 'range', 'min', 'max', 'dtype', 'represent', 'data', 'type', 'could', 'float', 'integer', 'string', 'depend', 'list', 'hyper-parameters', 'whose', 'value', 'directly', 'affect', 'generation', 'hyper-parameter', 'for', 'example', 'initial', 'learn', 'rate', 'large', 'would', 'prefer', 'larger', 'decay', 'rate', 'decease', 'learn', 'rate', 'quickly', 'there-', 'fore', 'decay', 'rate', 'generate', 'generate', 'learn-', 'ing', 'rate', 'enforce', 'relation', 'add', 'learn', 'rate', 'depend', 'list', 'add', 'post', 'hook', 'function', 'adjust', 'value', 'learn', 'rate', 'decay', 'the', 'second', 'function', 'define', 'categori-', 'cal', 'hyper-parameter', 'list', 'represent', 'candidate', 'depend', 'pre', 'hook', 'post', 'hook', 'analogous', 'range', 'knob', 'the', 'whole', 'hyper-parameter', 'tune', 'process', 'one', 'model', 'dataset', 'call', 'study', 'the', 'performance', 'trial', 'de-', 'note', 'larger', 'indicate', 'better', 'performance', 'e.g', 'ac-', 'curacy', 'for', 'distribute', 'hyper-parameter', 'tune', 'master', 'multiple', 'worker', 'study', 'the', 'master', 'generate', 'trial', 'worker', 'worker', 'evaluate', 'trial', 'one', 'time', 'worker', 'train', 'model', 'give', 'trial', 'the', 'workflow', 'study', 'master', 'side', 'explain', 'algorithm', 'the', 'master', 'iter-', 'eat', 'event', 'loop', 'collect', 'performance', 'trial', 'i.e', 'generate', 'next', 'trial', 'trialadvisor', 'im-', 'plements', 'hyper-parameter', 'search', 'algorithm', 'e.g', 'random', 'search', 'bayesian', 'optimization', 'stop', 'trial', 'test', 'user', 'configure', 'stop', 'criterion', 'satisfy', 'e.g', 'total', 'num-', 'ber', 'trial', 'finally', 'best', 'parameter', 'put', 'parameter', 'server', 'inference', 'service', 'the', 'worker', 'side', 'keep', 'request', 'trial', 'master', 'conduct', 'train', 'report', 'result', 'master', 'algorithm', 'study', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', 'trial', 'adv.next', 'msg.worker', 'trial', 'nil', 'break', 'else', 'send', 'msg.worker', 'trial', 'end', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'else', 'msg.type', 'kfinish', 'num', 'adv.is', 'best', 'msg.worker', 'send', 'msg.worker', 'kput', 'end', 'end', 'end', 'return', 'adv.best', 'trial', '4.2.2', 'collaborative', 'tune', 'section', 'introduce', 'distribute', 'hyper-', 'parameter', 'tune', 'framework', 'next', 'extend', 'framework', 'propose', 'collaborative', 'tune', 'scheme', 'sgd', 'widely', 'use', 'train', 'machine', 'learn', 'model', 'often', 'observe', 'train', 'loss', 'stay', 'plateau', 'drop', 'suddenly', 'decrease', 'learn', 'rate', 'sgd', 'e.g', '0.1', '0.01', '0.01', '0.001', 'base', 'observation', 'see', 'hyper-parameters', 'change', 'train', 'get', 'plateau', 'de-', 'rive', 'better', 'performance', 'therefore', 'fix', 'model', 'architec-', 'ture', 'tune', 'hyper-parameters', 'group', 'table', 'model', 'parameter', 'train', 'use', 'one', 'hyper-parameter', 'trial', 'reuse', 'initialize', 'model', 'another', 'trial', 'select', 'parameter', 'top', 'perform', 'trial', 'continue', 'hyper-parameter', 'tune', 'old', 'trial', 'like', 'pre-', 'train', 'fact', 'good', 'model', 'initialization', 'result', 'faster', 'convergence', 'better', 'performance', 'user', 'typically', 'fine-tune', 'popular', 'convnet', 'architecture', 'datasets', 'conse-', 'quently', 'collaborative', 'tune', 'scheme', 'likely', 'converge', 'good', 'state', 'straightforward', 'tune', 'hyper-parameters', 'relate', 'model', 'architecture', 'this', 'architecture', 'change', 'parameter', 'also', 'change', 'for', 'example', 'parameter', 'convolution', 'layer', 'filter', 'size', '3x3', 'use', 'initialize', 'convolution', 'layer', 'another', 'convnet', 'whose', 'filter', 'size', '5x5', 'however', 'architecture', 'tune', 'many', 'architecture', 'available', 'likely', 'architecture', 'share', 'config-', 'urations', 'one', 'convolution', 'layer', 'for', 'instance', 'convnet', '3rd', 'convolution', 'layer', 'convnet', '3rd', 'layer', 'convo-', 'lution', 'set', 'use', 'parametersw', 'convnet', '3rd', 'layer', 'initialize', 'convnet', '3rd', 'layer', 'store', 'allw', 'parameter', 'server', 'fetch', 'shape', 'match', 'initialize', 'layer', 'new', 'trial', 'convnets', 'performance', 'new', 'trail', 'better', 'older', 'one', 'overwrite', 'parameter', 'server', 'new', 'value', '0.1', '0.01', '0.1', '0.01', '0.1', 'figure', 'collaborative', 'tune', 'example', 'the', 'whole', 'process', 'illustrate', 'figure', 'worker', 'run', 'trial', 'tune', 'hyper-parameters', 'e.g', 'learn', 'rate', 'model', 'after', 'performance', 'worker', 'stop', 'increase', 'the', 'train', 'stop', 'automatically', 'accord', 'early', 'stop', 'criterion', 'e.g', 'train', 'loss', 'decrease', 'consecutive', 'epoch', 'early', 'stop', 'widely', 'use', 'train', 'machine', 'learn', 'models7', 'the', 'new', 'trial', 'worker', 'us', 'pa-', 'rameters', 'current', 'best', 'worker', 'the', 'work', 'do', 'serf', 'pre-training', 'new', 'trial', 'similarly', 'enter', 'plateau', 'master', 'instruct', 'start', 'new', 'trial', 'use', 'parameter', 'whose', 'model', 'best', 'performance', 'point', 'time', 'the', 'control', 'flow', 'collaborative', 'tune', 'scheme', 'describe', 'algorithm', 'similar', 'algorithm', 'except', 'master', 'instruct', 'worker', 'save', 'model', 'parameter', 'global', 'pa-', 'rameter', 'server', 'line', 'model', 'performance', 'significantly', 'larger', 'current', 'best', 'performance', 'line', 'the', 'performance', 'difference', 'i.e', 'conf.delta', 'configuration', 'parameter', 'hyper-', 'conf', 'set', 'accord', 'user', 'expectation', 'performance', 'model', 'for', 'example', 'mnist', 'image', 'classi-', 'fication', 'improvement', '0.1', 'large', 'current', 'best', 'performance', 'for', 'cifar-10', 'image', 'classification', 'may', 'set', 'delta', '0.5', 'best', 'accuracy', '97.4', 'mean', 'bigger', 'improvement', 'space', 'notice', 'bad', 'parameter', 'initialization', 'degrade', 'perfor-', 'mance', 'experiment', 'this', 'serious', 'random', 'search', 'because', 'checkpoint', 'one', 'trial', 'poor', 'accuracy', 'would', 'affect', 'next', 'trial', 'model', 'parameter', 'initialize', 'poor', 'state', 'resolve', 'problem', 'α-greedy', 'strategy', 'intro-', 'duced', 'implementation', 'initialize', 'model', 'param-', 'eters', 'either', 'random', 'initialization', 'pre-trained', 'model', 'checkpoint', 'file', 'threshold', 'represent', 'probability', 'choos-', 'ing', 'random', 'initialization', '1-α', 'represent', 'probability', 'us-', 'ing', 'pre-trained', 'checkpoint', 'file', 'decrease', 'gradually', 'decrease', 'chance', 'random', 'initialization', 'i.e', 'increase', 'chance', 'costudy', 'this', 'α-greedy', 'strategy', 'widely', 'use', 'reinforcement', 'learn', 'balance', 'exploration', 'exploitation', 'inference', 'service', '7https', '//keras.io/callbacks/', 'earlystopping', 'algorithm', 'costudy', 'hypertune', 'conf', 'trialadvisor', 'adv', 'num', 'best', 'conf.stop', 'num', 'msg', 'receivemsg', 'msg.type', 'krequest', '...', 'algorithm', 'else', 'msg.type', 'kreport', 'adv.collect', 'msg.worker', 'msg.p', 'msg.trial', 'msg.p', 'best', 'conf.delta', 'send', 'msg.worker', 'kput', 'best', 'msg.p', 'else', 'adv.early', 'stop', 'msg.worker', 'conf', 'send', 'msg.worker', 'kstop', 'end', 'else', 'msg.type', 'kfinish', 'num', 'end', 'end', 'return', 'adv.best', 'trial', 'inference', 'service', 'provide', 'real-time', 'request', 'serve', 'deploy-', 'ing', 'train', 'model', 'other', 'service', 'like', 'database', 'service', 'sim-', 'ply', 'optimize', 'throughput', 'constraint', 'latency', 'set', 'manually', 'service', 'level', 'objective', 'slo', 'denote', 'e.g', '0.1', 'second', 'for', 'machine', 'learn', 'service', 'accuracy', 'become', 'important', 'optimization', 'objective', 'the', 'accuracy', 'refer', 'wide', 'range', 'performance', 'measurement', 'e.g', 'negative', 'error', 'precision', 'recall', 'area', 'curve', 'etc', 'larger', 'value', 'accuracy', 'indicate', 'better', 'performance', 'set', 'latency', 'hard', 'constraint', 'show', 'equation', 'overdue', 'request', 'would', 'get', 'time', 'response', 'typically', 'delay', 'response', 'better', 'error', 'time', 'end-users', 'hence', 'process', 'request', 'queue', 'se-', 'quentially', 'follow', 'fifo', 'first-in-first-out', 'the', 'objective', 'maximize', 'accuracy', 'minimize', 'exceed', 'time', 'accord-', 'ing', 'however', 'typically', 'trade-off', 'accuracy', 'latency', 'for', 'example', 'ensemble', 'model', 'model', 'increase', 'accuracy', 'latency', 'shall', 'optimize', 'model', 'selection', 'ensemble', 'model', 'section', '5.2', 'before', 'discus', 'simpler', 'case', 'single', 'inference', 'model', 'table', 'summarize', 'notation', 'use', 'section', 'maxaccuracy', 'subject', '5.1', 'single', 'inference', 'model', 'when', 'one', 'single', 'model', 'deploy', 'application', 'accuracy', 'inference', 'service', 'fix', 'system', 'per-', 'spective', 'therefore', 'optimization', 'objective', 'reduce', 'mini-', 'mizing', 'exceed', 'time', 'formalize', 'equation', 'min', 's∈smax', '|s|', 'the', 'latency', 'request', 'include', 'wait', 'time', 'queue', 'inference', 'time', 'depend', 'model', 'complexity', 'hardware', 'efficiency', 'i.e', 'flop', 'batch', 'size', 'the', 'batch', 'size', 'decide', 'number', 'request', 'process', 'to-', 'gether', 'modern', 'process', 'unit', 'like', 'cpu', 'gpu', 'exploit', 'data', 'parallelism', 'technique', 'e.g', 'simd', 'improve', 'throughput', 'reduce', 'computation', 'cost', 'hence', 'large', 'batch', 'size', 'necessary', 'table', 'notation', 'name', 'definition', 'request', 'list', 'model', 'list', 'latency', 'requirement', 'one', 'batch', 'size', 'candidate', 'list', 'k−th', 'oldest', 'request', 'queue', 'oldest', 'request', 'latest', '|q|', 'request', 'inference', 'time', 'batch', 'size', 'inference', 'time', 'model', 'batch', 'size', 'wait', 'time', 'request', 'queue', 'latency', 'wait', 'inference', 'time', 'request', 'balance', 'factor', 'accuracy', 'latency', 'binary', 'vector', 'model', 'selection', 'reward', 'function', 'set', 'request', 'saturate', 'parallelism', 'capacity', 'once', 'model', 'deploy', 'cloud', 'platform', 'model', 'complexity', 'hardware', 'efficiency', 'fix', 'therefore', 'rafiki', 'tune', 'batch', 'size', 'optimize', 'latency', 'construct', 'large', 'batch', 'e.g', 'request', 'delay', 'process', 'request', 'arrive', 'may', 'incur', 'large', 'latency', 'old', 'request', 'request', 'arrival', 'rate', 'low', 'the', 'op-', 'timal', 'batch', 'size', 'thus', 'influence', 'slo', 'queue', 'status', 'e.g', 'wait', 'time', 'request', 'arrival', 'rate', 'vary', 'along', 'time', 'since', 'inference', 'time', 'two', 'similar', 'batch', 'size', 'vary', 'lit-', 'tle', 'e.g', 'b=8', 'b=9', 'candidate', 'batch', 'size', 'list', 'include', 'value', 'significant', 'difference', 'w.r.t', 'in-', 'ference', 'time', 'e.g', '...', 'the', 'largest', 'batch', 'size', 'determine', 'system', 'gpu', 'memory', 'latency', 'process', 'batch', 'request', 'determine', 'hard-', 'ware', 'resource', 'e.g', 'gpu', 'memory', 'model', 'complexity', 'figure', 'show', 'inference', 'time', 'memory', 'footprint', 'accuracy', 'popular', 'convnets', 'train', 'imagenet', 'algorithm', 'show', 'greedy', 'solution', 'problem', 'al-', 'way', 'apply', 'largest', 'batch', 'size', 'possible', 'queue', 'length', 'i.e', 'number', 'request', 'queue', 'larger', 'largest', 'batch', 'size', 'max', 'oldest', 'request', 'process', 'one', 'batch', 'otherwise', 'wait', 'oldest', 'request', 'overdue', 'check', 'line', 'largest', 'batch', 'size', 'smaller', 'equal', 'queue', 'length', 'line', 'back-off', 'constant', 'equivalent', 'reduce', 'batch', 'size', 'additive-increase-multiplicative-decrease', 'scheme', 'aimd', 'e.g', '0.1τ', 'algorithm', 'inference', 'queue', 'model', 'true', 'maxb', 'len', 'm.infer', 'deque', 'else', 'max', 'len', 'm.infer', 'deque', 'end', 'end', 'end', '5.2', 'multiple', 'inference', 'model', 'single', 'model', 'two', 'model', 'three', 'model', 'four', 'model', 'ensemble', 'method', '0.75', '0.76', '0.77', '0.78', '0.79', '0.80', '0.81', '0.82', '0.83', 'resnet_v2_101', 'inception_v3', 'inception_v4', 'inception_resnet_v2', 'figure', 'accuracy', 'ensemble', 'model', 'different', 'model', 'ensemble', 'model', 'effective', 'popular', 'approach', 'im-', 'prove', 'inference', 'accuracy', 'give', 'example', 'compare', 'performance', 'different', 'ensemble', 'convnets', 'show', 'figure', 'majority', 'vote', 'apply', 'aggregate', 'prediction', 'the', 'accuracy', 'evaluate', 'validation', 'dataset', 'imagenet', 'generally', 'model', 'accuracy', 'better', 'the', 'exception', 'ensemble', 'resnet', '101', 'inception', 'good', 'single', 'best', 'model', 'i.e', 'inception', 'resnet', 'fact', 'prediction', 'ensemble', 'model', 'incep-', 'tion', 'tie', 'prediction', 'model', 'best', 'accuracy', 'select', 'final', 'prediction', 'parallel', 'ensemble', 'model', 'run', 'one', 'model', 'per', 'node', 'gpu', 'straight-forward', 'way', 'scale', 'system', 'improve', 'throughput', 'however', 'latency', 'could', 'high', 'due', 'straggler', 'for', 'example', 'show', 'figure', 'node', 'run', 'nasnet', 'large', 'would', 'slow', 'although', 'accuracy', 'high', 'addition', 'en-', 'semble', 'model', 'also', 'costly', 'term', 'throughput', 'com-', 'par', 'serve', 'different', 'request', 'different', 'node', 'i.e', 'ensemble', 'see', 'trade-off', 'latency', 'throughput', 'accuracy', 'control', 'model', 'selec-', 'tion', 'request', 'arrive', 'slowly', 'simply', 'run', 'model', 'batch', 'get', 'best', 'accuracy', 'however', 'request', 'arrival', 'rate', 'high', 'like', 'section', '5.1', 'select', 'different', 'model', 'different', 'request', 'increase', 'throughput', 'reduce', 'latency', 'addition', 'model', 'selection', 'current', 'batch', 'also', 'affect', 'next', 'batch', 'for', 'example', 'use', 'model', 'batch', 'next', 'batch', 'wait', 'least', 'one', 'model', 'finish', 'solve', 'equation', 'balance', 'accuracy', 'latency', 'get', 'single', 'optimization', 'objective', 'move', 'latency', 'term', 'objective', 'show', 'equation', 'maximize', 'reward', 'functionr', 'relate', 'prediction', 'accuracy', 'penalize', 'overdue', 'request', 'balance', 'accuracy', 'latency', 'objective', 'grind', 'truth', 'request', 'available', 'evaluate', 'accuracy', 'normal', 'case', 'find', 'surrogate', 'accuracy', 'maxr', 'like', 'analysis', 'single', 'inference', 'model', 'need', 'consider', 'batch', 'size', 'selection', 'well', 'difficult', 'design', 'optimal', 'policy', 'complex', 'decision', 'make', 'problem', 'decide', 'model', 'selection', 'batch', 'size', 'selection', 'paper', 'propose', 'optimize', 'equation', 'use', 'reinforcement', 'learn', 'optimize', 'objective', 'long', 'term', 'try', 'different', 'action', 'enter', 'correspond', 'state', 'collect', 'reward', 'set', 'reward', 'equation', 'define', 'action', 'model', 'selection', 'batch', 'selection', 'apply', 'optimization', 'problem', 'three', 'core', 'concept', 'namely', 'action', 'reward', 'state', 'once', 'three', 'concept', 'define', 'apply', 'exist', 'al-', 'gorithms', 'optimization', 'define', 'three', 'concept', 'w.r.t', 'optimization', 'problem', 'follow', 'first', 'state', 'space', 'consist', 'queue', 'status', 'represent', 'wait', 'time', 'request', 'queue', 'the', 'wait', 'time', 'request', 'form', 'feature', 'vec-', 'tor', 'generate', 'fix', 'length', 'feature', 'vector', 'pad', 'shorter', 'queue', 'truncate', 'longer', 'queue', 'model', 'status', 'represent', 'vector', 'include', 'inference', 'time', 'different', 'model', 'different', 'batch', 'size', 'i.e', 'leave', 'time', 'finish', 'exist', 'request', 'dispatch', 'the', 'two', 'feature', 'vector', 'concatenate', 'state', 'feature', 'vector', 'input', 'model', 'generate', 'action', 'second', 'action', 'decide', 'batch', 'size', 'model', 'selection', 'represent', 'binary', 'vector', 'length', 'select', 'unselected', 'the', 'action', 'space', 'size', 'thus', '2|m|−', '|b|', 'exclude', 'case', 'i.e', 'none', 'model', 'select', 'third', 'follow', 'equation', 'reward', 'one', 'batch', 'request', 'without', 'grind', 'truth', 'label', 'define', 'equation', 'accuracy', 'select', 'model', 'ensemble', 'model', 'paper', 'use', 'accuracy', 'evaluate', 'validation', 'dataset', 'surrogate', 'accu-', 'racy', 'experiment', 'use', 'imagenet', 'validation', 'dataset', 'evaluate', 'accuracy', 'different', 'ensemble', 'combination', 'im-', 'age', 'classification', 'the', 'result', 'show', 'figure', 'the', 'reward', 'show', 'equation', 'consider', 'accuracy', 'latency', 'indirectly', 'represent', 'number', 'overdue', 'request', 'number', 'request', 'batch|l', 'with', 'state', 'action', 'reward', 'well', 'define', 'apply', 'actor-critic', 'algorithm', 'optimize', 'overall', 'reward', 'learn-', 'ing', 'good', 'policy', 'select', 'model', 'batch', 'size', 'system', 'implementation', 'section', 'introduce', 'implementation', 'detail', 'rafiki', 'include', 'cluster', 'management', 'data', 'parameter', 'storage', 'failure', 'recovery', '6.1', 'cluster', 'management', 'manager', 'master', 'data', 'worker', 'worker', 'parameter', 'master', 'data', 'worker', 'worker', 'parameter', 'train', 'inference', 'node', 'node', 'cnode', 'figure', 'rafiki', 'cluster', 'topology', 'rafiki', 'us', 'kubernetes', 'manage', 'docker', 'container', 'run', 'master', 'worker', 'data', 'server', 'parameter', 'server', 'show', 'figure', 'docker', 'container', 'widely', 'use', 'applica-', 'tion', 'deployment', 'bundle', 'application', 'code', 'e.g', 'train', 'inference', 'code', 'library', 'e.g', 'kera', 'avoid', 'tedious', 'en-', 'vironment', 'setup', 'new', 'model', 'hyper-parameter', 'tune', 'algorithm', 'ensemble', 'model', 'approach', 'deploy', 'new', 'docker', 'container', 'physical', 'node', 'could', 'multiple', 'master', 'worker', 'different', 'job', 'include', 'train', 'infer-', 'ence', 'job', 'these', 'job', 'start', 'rafiki', 'manager', 'accept', 'job', 'submission', 'user', 'see', 'figure', 'once', 'job', 'launch', 'user', 'communicate', 'master', 'directly', 'get', 'train', 'progress', 'submit', 'query', 'request', 'rafiki', 'prefer', 'locate', 'master', 'worker', 'job', 'physical', 'node', 'avoid', 'network', 'communication', 'overhead', '6.2', 'data', 'parameter', 'storage', 'deep', 'learn', 'model', 'typically', 'train', 'large', 'datasets', 'would', 'consume', 'lot', 'space', 'store', 'cpu', 'memory', 'there-', 'fore', 'rafiki', 'us', 'hdfs', 'data', 'storage', 'data', 'node', 'also', 'docker', 'container', 'user', 'upload', 'datasets', 'hdfs', 'via', 'rafiki', 'utility', 'function', 'e.g', 'rafiki.import', 'image', 'see', 'fig-', 'ure', 'the', 'train', 'dataset', 'download', 'local', 'directory', 'be-', 'fore', 'train', 'via', 'rafiki.download', 'pass', 'dataset', 'name', 'for', 'model', 'parameter', 'rafiki', 'distribute', 'parameter', 'server', 'the', 'parameter', 'server', 'design', 'special', 'optimiza-', 'tion', 'hyper-parameter', 'train', 'inference', 'particular', 'hyper-parameters', 'cache', 'memory', 'access', 'frequently', 'e.g', 'rafiki', 'hyper-parameter', 'train', 'otherwise', 'store', 'hdfs', 'the', 'parameter', 'train', 'model', 'different', 'datasets', 'share', 'long', 'privacy', 'set', 'public', 'show', 'train', 'warm-up', 'use', 'parameter', 'pre-trained', 'datasets', 'speed', 'train', '6.3', 'failure', 'recovery', 'for', 'hyper-parameter', 'train', 'inference', 'service', 'worker', 'stateless', 'hence', 'rafiki', 'manager', 'easily', 'recover', 'node', 'run', 'new', 'docker', 'container', 'register', 'train', 'inference', 'master', 'however', 'master', 'state', 'information', 'for', 'example', 'master', 'train', 'ser-', 'vice', 'record', 'current', 'best', 'hyper-parameter', 'trial', 'the', 'master', 'inference', 'service', 'state', 'action', 'reward', 'reinforce-', 'ment', 'learn', 'rafiki', 'checkpoint', 'small', 'state', 'information', 'master', 'fast', 'failure', 'recovery', 'experimental', 'study', 'section', 'evaluate', 'scalability', 'efficiency', 'effec-', 'tiveness', 'rafiki', 'hyper-parameter', 'tune', 'inference', 'ser-', 'vice', 'optimization', 'respectively', 'the', 'experiment', 'conduct', 'three', 'machine', 'nvidia', 'gtx', '1080ti', 'gpus', 'intel', 'e5-1650v4', 'cpu', '64gb', 'memory', '7.1', 'evaluation', 'hyper-parameter', 'tune', 'task', 'dataset', 'test', 'rafiki', 'distribute', 'hyper-parameter', 'tune', 'service', 'run', 'tune', 'hyper-parameters', 'deep', 'convnets', 'cifar-10', 'image', 'classification', 'cifar-10', 'popular', 'benchmark', 'dataset', 'rgb', 'image', 'category', 'each', 'category', '5000', 'train', 'image', 'include', '1000', 'validation', 'image', '1000', 'test', 'image', 'all', 'image', 'size', '32x32', 'there', 'standard', 'sequence', 'preprocessing', 'step', 'cifar-10', 'subtract', 'mean', 'divide', 'standard', 'deviation', 'channel', 'compute', 'train', 'image', 'pad', 'image', 'pixel', 'zero', 'side', 'obtain', '40x40', 'pixel', 'image', 'ran-', 'domly', 'crop', '32x32', 'patch', 'flip', 'horizontal', 'direction', 'image', 'randomly', 'probability', '0.5', '100', '200', 'trial', 'index', 'lid', 'without', 'costudy', '100', '200', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', '200', 'total', 'train', 'epoch', 'lid', 'wihtout', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tune', 'base', 'random', 'search', '100', 'trial', 'index', 'lid', 'without', 'costudy', '100', 'trial', 'index', 'with', 'costudy', 'validation', 'accuracy', '100', 'ria', 'without', 'costudywith', 'costudy', '100', 'total', 'train', 'epoch', 'lid', 'without', 'costudy', 'with', 'costudy', 'figure', 'hyper-parameter', 'tune', 'base', 'bayesian', 'optimization', '7.1.1', 'tune', 'optimization', 'hyper-parameters', 'fix', 'convnet', 'architecture', 'show', 'table', 'convolution', 'layer', 'the', 'hyper-parameters', 'tune', 'optimization', 'algorithm', 'include', 'momen-', 'tum', 'learn', 'rate', 'weight', 'decay', 'coefficient', 'dropout', 'rate', 'standard', 'deviation', 'gaussian', 'distribution', 'weight', 'initial-', 'ization', 'run', 'trial', 'early', 'stop', 'terminate', 'train', 'validation', 'loss', 'stop', 'decrease', 'compare', 'naı̈ve', 'distribute', 'tune', 'algorithm', 'i.e', 'study', 'algorithm', 'collaborative', 'tune', 'algorithm', 'i.e', 'cos-', 'tudy', 'algorithm', 'different', 'trialadvisor', 'algorithm', 'figure', 'show', 'comparison', 'use', 'random', 'search', 'trialadvisor', 'particular', 'point', 'figure', 'stand', 'one', 'trial', 'see', 'top', 'area', 'costudy', 'denser', 'study', 'word', 'costudy', 'likely', 'get', 'better', 'performance', 'this', 'confirm', 'figure', 'show', 'costudy', 'trial', 'high', 'accuracy', 'i.e', 'accuracy', 'study', 'fewer', 'trial', 'low', 'accuracy', 'i.e.', 'accuracy≤50', 'figure', 'illustrate', 'tune', 'progress', 'two', 'approach', 'point', 'line', 'represent', 'best', 'performance', 'among', 'trial', 'conduct', 'far', 'the', 'x-axis', 'total', 'number', 'train', 'epochs8', 'corre-', 'sponds', 'tune', 'time', '=total', 'number', 'epoch', 'time', 'time', 'per', 'epoch', 'observe', 'costudy', 'faster', 'study', 'achieve', 'better', 'accuracy', 'study', 'notice', 'validation', 'ac-', 'curacy', 'high', 'therefore', 'small', 'difference', 'indicate', 'significant', 'improvement', 'figure', 'compare', 'study', 'costudy', 'use', 'gaussian', 'process', 'base', 'bayesian', 'optimization', 'trialadvisor', 'compare', 'figure', 'figure', 'see', 'point', 'top', 'area', 'figure', 'word', 'better', 'random', '8training', 'model', 'scan', 'dataset', 'call', 'one', 'epoch', '9https', '//github.com/scikit-optimize', 'searchwhich', 'observe', 'paper', 'figure', 'costudy', 'point', 'right', 'bottom', 'area', 'cos-', 'tudy', 'after', 'in-depth', 'inspection', 'find', 'point', 'trial', 'initialize', 'randomly', 'instead', 'pre-trained', 'model', 'for', 'study', 'always', 'us', 'random', 'initialization', 'hence', 'algo-', 'rithm', 'fix', 'prior', 'initialization', 'method', 'however', 'costuy', 'initialization', 'pre-trained', 'model', 'time', 'these', 'random', 'initialization', 'trial', 'change', 'prior', 'thus', 'get', 'bias', 'estimation', 'gaussian', 'process', 'lead', 'poor', 'accuracy', 'since', 'decay', 'reduce', 'chance', 'random', 'initialization', 'fewer', 'fewer', 'point', 'right', 'bottom', 'area', 'overall', 'costudy', 'achieve', 'better', 'accuracy', 'show', 'figure', 'figure', 'study', 'scalability', 'rafiki', 'vary', 'number', 'work-', 'er', 'figure', 'compare', 'job', 'run', 'gpus', 'respectively', 'each', 'point', 'curve', 'figure', 'represent', 'best', 'validation', 'performance', 'among', 'trial', 'test', 'far', 'the', 'x-axis', 'wall', 'clock', 'time', 'see', 'gpus', 'tune', 'become', 'faster', 'scale', 'almost', 'linearly', '7.2', 'evaluation', 'inference', 'optimization', 'use', 'image', 'classification', 'application', 'test', 'opti-', 'mization', 'technique', 'introduce', 'section', 'the', 'inference', 'model', 'convnets', 'train', 'imagenet', 'benchmark', 'dataset', 'imagenet', 'popular', 'image', 'classification', 'benchmark', 'many', 'open-source', 'convnets', 'train', 'figure', '1.2', 'million', 'rgb', 'train', 'image', '50,000', 'validation', 'image', 'our', 'environment', 'simulator', 'randomly', 'sample', 'image', 'validation', 'dataset', 'request', 'the', 'number', 'request', 'deter-', 'mine', 'follow', 'first', 'simulate', 'scenario', 'high', 'arrive', 'rate', 'low', 'arrive', 'rate', 'set', 'arrive', 'rate', 'base', 'maximum', 'throughput', 'minimum', 'throughput', 'specifically', 'maximum', 'throughput', 'sum', 'model', 'throughput', 'achieve', 'model', 'run', 'asynchronously', '250', '500', '750', '1000', '1250', '1500', 'time', 'second', '100', '200', '300', '400', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arrive', 'rate', 'define', 'base', 'maximum', 'throughput', 'number', 'worker', '500', '1000', '1500', '250', '500', '750', '1000', 'wall', 'time', 'minute', 'lid', 'worker', 'worker', 'worker', 'worker', 'figure', 'scalability', 'test', 'distribute', 'hyper-parameter', 'tune', 't/2t/4', '0.1t', '0.1t', 'figure', 'sine', 'function', 'control', 'request', 'arrive', 'rate', 'process', 'different', 'batch', 'request', 'contrast', 'mod-', 'el', 'run', 'synchronously', 'slowest', 'model', 'throughput', 'minimum', 'throughput', 'second', 'use', 'sine', 'function', 'extreme', 'throughput', 'value', 'define', 'request', 'arrive', 'rate', 'i.e', 'γsin', 'the', 'slope', 'intercept', 'derive', 'solve', 'equation', 'cycle', 'period', 'configure', '500', 'experiment', 'the', 'first', 'equation', 'make', 'sure', 'request', 'generate', 'cycle', 'period', 'figure', '0.2t', 'way', 'simulate', 'real-life', 'environment', 'overwhelm', 'request', 'come', 'time', 'the', 'second', 'equa-', 'tion', 'make', 'sure', 'highest', 'arrive', 'rate', 'large', 'otherwise', 'request', 'queue', 'would', 'fill', 'quickly', 'new', 'request', 'drop', 'finally', 'small', 'random', 'noise', 'apply', 'prevent', 'algorithm', 'remember', 'sine', 'function', 'conclude', 'number', 'new', 'request', 'γsin', '0.1', 'time', 'span', 'last', 'invocation', 'simulator', 'current', 'time', 'sin', 't/2−', '0.2×', '2t/2', 'sin', 't/2', '1.1×', '7.2.1', 'single', 'inference', 'model', 'use', 'inception', 'train', 'imagenet', 'single', 'infer-', 'ence', 'model', 'besides', 'greedy', 'algorithm', 'algorithm', 'also', 'run', 'algorithm', 'section', '5.2', 'decide', 'batch', 'size', 'the', 'state', 'section', '5.2', 'except', 'model', 'relate', 'status', 'remove', 'the', 'batch', 'size', 'list', 'the', 'maximum', 'throughput', 'max', 'b/c', '64/0.23', '272', 'images/second', 'minimum', 'throughput', 'min', 'b/c', '16/0.07', '228', 'set', '0.56s', 'figure', 'compare', 'algorithm', 'greedy', 'algorithm', 'arrive', 'rate', 'define', 'base', 'maximum', 'throughput', 'see', 'iteration', 'perform', 'similarly', 'greedy', 'algorithm', 'request', 'arrive', 'rate', 'high', 'when', 'low', 'perform', 'better', 'greedy', 'algorithm', 'this', 'request', 'leave', 'queue', 'length', 'equal', 'batch', 'size', 'line', 'algorithm', 'these', 'leave', 'request', 'likely', 'overdue', 'new', 'request', 'come', 'slowly', 'form', 'new', 'batch', 'figure', 'compare', 'algorithm', 'greedy', 'algorithm', 'ar-', 'rive', 'rate', 'define', 'base', 'minimum', 'throughput', 'see', 'perform', 'better', 'greedy', 'algorithm', 'ar-', 'rive', 'rate', 'either', 'high', 'low', 'overall', 'since', 'arrive', 'rate', 'smaller', 'figure', 'fewer', 'overdue', 'request', '7.2.2', 'multiple', 'inference', 'model', 'follow', 'experiment', 'select', 'inception', 'inception', 'inception', 'resnet', 'construct', 'model', 'list', 'the', 'maxi-', 'mum', 'throughput', 'minimum', 'throughput', '572', 'requests/second', '128', 'requests/second', 'respectively', 'the', 'experimental', 'result', 'plot', 'figure', 'figure', 'figure', 'the', 'legend', 'text', 'overdue', 'represent', 'number', 'overdue', 'request', 'per', 'sec-', 'ond', 'arrive', 'stand', 'request', 'arrive', 'rate', 'compare', 'algorithm', 'two', 'baseline', 'algorithm', 're-', 'spectively', 'for', 'baseline', 'use', 'greedy', 'algorithm', 'find', 'batch', 'size', 'they', 'differ', 'model', 'selection', 'strategy', 'the', 'first', 'baseline', 'run', 'model', 'synchronously', 'batch', 'request', 'correspondingly', 'request', 'generate', 'use', 'rate', 'base', 'from', 'figure', '14a', 'figure', '14b', 'see', 'greedy', 'algorithm', 'fix', 'accuracy', 'whereas', 'algorithm', 'ac-', 'curacy', 'high', 'resp', 'low', 'rate', 'low', 'resp', 'high', '250', '500', '750', '1000', '1250', '1500', 'time', 'second', '100', '150', '200', '250', '300', 'greedy', 'request', 'rate', 'figure', 'single', 'inference', 'model', 'arrive', 'rate', 'define', 'base', 'minimum', 'throughput', '500', '1000', 'time', 'second', '0.78', '0.80', '0.82', '0.84', '100', '125', '150', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'second', '0.802', '0.804', '0.806', '0.808', '0.810', '100', '125', '150', 'algorithm', '500', '1000', 'time', 'second', '100', '150', '200', 'overdue', 'arrive', 'greedy', 'algorithm', '23000', '23500', '24000', 'time', 'second', '100', '150', '200', 'overdue', 'arrive', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arrive', 'rate', 'define', 'base', 'minimum', 'throughput', '500', '1000', 'time', 'second', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'second', '0.76', '0.78', '0.80', '0.82', '0.84', '100', '200', '300', '400', '500', '600', 'algorithm', '500', '1000', 'time', 'second', '200', '400', '600', '800', '1000', 'overdue', 'arrive', 'greedy', 'algorithm', '13500', '14000', '14500', 'time', 'second', '200', '400', '600', '800', '1000', 'overdue', 'arrive', 'algorithm', 'figure', 'multiple', 'model', 'inference', 'arrive', 'rate', 'define', 'base', 'maximum', 'throughput', '2000', '4000', '6000', 'time', 'second', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'second', '0.795', '0.800', '0.805', '0.810', '100', '125', '150', '2000', '4000', '6000', 'time', 'second', '100', '150', '200', 'overdue', 'arrive', '2000', '4000', '6000', 'time', 'second', '100', '150', '200', 'overdue', 'arrive', 'figure', 'comparison', 'effect', 'different', 'algorithm', 'fact', 'synchronous', 'algorithm', 'always', 'us', 'model', 'en-', 'semble', 'model', 'whereas', 'algorithm', 'us', 'fewer', 'model', 'ensemble', 'model', 'arrive', 'rate', 'high', 'since', 'request', 'arrive', 'rate', 'low', 'baseline', 'able', 'handle', 'al-', 'request', 'similar', 'figure', 'overdue', 'request', 'figure', '14c', 'due', 'mismatch', 'queue', 'size', 'batch', 'size', 'algorithm', 'the', 'second', 'baseline', 'run', 'model', 'asynchronously', 'one', 'model', 'per', 'batch', 'request', 'word', 'ensemble', 'mod-', 'eling', 'correspondingly', 'request', 'generate', 'use', 'rate', 'base', 'see', 'better', 'accuracy', 'figure', '15a', '15b', 'fewer', 'overdue', 'request', 'figure', '15c', '15d', 'baseline', 'moreover', 'adaptive', 'request', 'arrive', 'rate', 'when', 'rate', 'high', 'us', 'fewer', 'model', 'serve', 'batch', 'im-', 'prove', 'throughput', 'reduce', 'overdue', 'request', 'when', 'rate', 'low', 'us', 'model', 'serve', 'batch', 'improve', 'accuracy', 'also', 'compare', 'effect', 'different', 'namely', 'reward', 'function', 'i.e', 'equation', 'figure', 'show', 'result', 'request', 'generate', 'base', 'see', 'smaller', 'accuracy', 'figure', '16a', 'higher', 'this', 'reward', 'function', 'focus', 'accuracy', 'part', 'con-', 'sequently', 'many', 'overdue', 'request', 'show', 'figure', '16c', 'contrast', 'reward', 'function', 'try', 'avoid', 'overdue', 'request', 'reduce', 'number', 'model', 'ensemble', 'there-', 'fore', 'accuracy', 'number', 'overdue', 'request', 'smaller', 'figure', '16b', 'figure', '16d', 'case', 'study', 'usability', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'figure', 'sql', 'table', 'creation', 'section', 'detail', 'rafiki', 'help', 'database', 'expert', 'use', 'deep', 'learn', 'service', 'easily', 'exist', 'application', 'present', 'scenario', 'analyze', 'food', 'preference', 'user', 'food', 'log', 'application', 'show', 'figure', 'this', 'application', 'keep', 'log', 'food', 'user', 'eat', 'store', 'time', 'loca-', 'tion', 'photo', 'meal', 'for', 'simplicity', 'assume', 'data', 'store', 'one', 'table', 'create', 'figure', 'each', 'row', 'table', 'contain', 'information', 'meal', 'the', 'image', 'path', 'file', 'path', 'image', 'this', 'image', 'contain', 'picture', 'food', 'however', 'direct', 'way', 'query', 'information', 'e.g.', 'name', 'food', 'image', 'use', 'rafiki', 'database', 'developer', 'collaborate', 'deep', 'learn', 'expert', 'develop', 'train', 'image', 'recog-', 'nition', 'model', 'food', 'image', 'this', 'train', 'model', 'share', 'rafiki', 'provide', 'recognition', 'service', 'database', 'user', 'black', 'box', 'via', 'web', 'apis', 'figure', 'display', 'web', 'interface', 'rafiki', 'figure', 'rafiki', 'web', 'interface', 'deep', 'learn', 'expert', 'the', 'deep', 'learn', 'expert', 'prepare', 'train', 'train.py', 'serve', 'serve.py', 'script', 'deep', 'learn', 'model', 'use', 'apache', 'singa', '10http', '//singa.apache.org/', 'database', 'user', 'after', 'upload', 'train', 'dataset', 'i.e', 'set', 'food', 'image', 'label', 'pair', 'rafiki', 'database', 'user', 'start', 'train', 'job', 'once', 'train', 'finish', 'user', 'deploy', 'train', 'model', 'serve', 'job', 'afterwards', 'exploit', 'deep', 'learn', 'service', 'get', 'food', 'name', 'send', 'request', 'rafiki', 'via', 'user-defined', 'function', 'udf', 'the', 'food', 'name', 'function', 'call', 'web', 'api', 'serve', 'application', 'rafiki', 'particular', 'function', 'execute', 'image', 'row', 'sat-', 'isfy', 'condition', 'age', 'greater', 'consequently', 'save', 'much', 'time', 'batch', 'process', 'support', 'rafiki', 'side', 'im-', 'prove', 'efficiency', 'furthermore', 'model', 'modify', 're-trained', 'rafiki', 'change', 'sql', 'query', 'database', 'user', 'side', 'curl', '-f=', 'image.jpg', 'http', 'rafiki', 'app', 'port', '/api', 'create', 'table', 'foodlog', 'user_id', 'integer', 'age', 'integer', 'not', 'null', 'location', 'text', 'not', 'null', 'time', 'text', 'not', 'null', 'image_path', 'text', 'not', 'null', 'primary', 'key', 'user_id', 'time', 'select', 'udf_food_name', 'image_path', 'food_name', 'count', 'from', 'foodlog', 'where', 'age', 'group', 'food_name', 'select', 'food_name', 'image_path', 'name', 'count', 'foodlog', 'age', 'group', 'name', 'this', 'service', 'also', 'serve', 'request', 'mobile', 'apps', 'demon-', 'strated', 'figure', 'create', 'food', 'log', 'app', 'send', 'request', 'rafiki', 'food', 'image', 'prediction', 'conclusion', 'complex', 'analytics', 'become', 'inherent', 'expect', 'func-', 'tionality', 'support', 'big', 'data', 'system', 'however', 'widely', 'recognize', 'machine', 'learn', 'model', 'easy', 'build', 'train', 'sensitive', 'data', 'distribution', 'characteris-', 'tic', 'therefore', 'important', 'reduce', 'pain', 'point', 'imple-', 'menting', 'tune', 'dataset', 'specific', 'model', 'step', 'towards', 'make', 'usable', 'paper', 'present', 'rafiki', 'provide', 'train', 'inference', 'service', 'machine', 'learn', 'model', 'facilitate', 'complex', 'analytics', 'top', 'cloud', 'data', 'storage', 'system', 'rafiki', 'support', 'effective', 'distribute', 'hyper-parameter', 'tune', 'train', 'service', 'online', 'ensemble', 'model', 'inference', 'service', 'amenable', 'trade', 'latency', 'accu-', 'racy', 'the', 'system', 'evaluate', 'various', 'benchmark', 'illustrate', 'efficiency', 'effectiveness', 'scalability', 'also', 'conduct', 'case', 'study', 'demonstrate', 'system', 'enable', 'database', 'developer', 'use', 'deep', 'learn', 'service', 'easily', 'reference', 'provide', 'database', 'service', 'proceed', '18th', 'international', 'conference', 'data', 'engineer', 'icde', 'page', '29–', 'washington', 'usa', '2002', 'ieee', 'computer', 'society', 'abadi', 'barham', 'chen', 'chen', 'davis', 'dean', 'devin', 'ghemawat', 'irving', 'isard', 'kudlur', 'levenberg', 'monga', 'moore', 'murray', 'steiner', 'tucker', 'vasudevan', 'warden', 'wicke', 'zheng', 'tensorflow', 'system', 'large-scale', 'machine', 'learn', '12th', 'usenix', 'symposium', 'operate', 'system', 'design', 'implementation', 'osdi', 'page', '265–283', '2016', 'usenix', 'association', 'bergstra', 'bengio', 'random', 'search', 'hyper-parameter', 'optimization', 'mach', 'learn', 'res.', '13:281–305', 'feb.', '2012', 'collobert', 'weston', 'bottou', 'karlen', 'kavukcuoglu', 'kuksa', 'natural', 'language', 'process', 'almost', 'scratch', 'corr', 'abs/1103.0398', '2011', 'crankshaw', 'wang', 'zhou', 'franklin', 'gonzalez', 'stoica', 'clipper', 'low-latency', 'online', 'prediction', 'serve', 'system', '14th', 'usenix', 'symposium', 'network', 'system', 'design', 'implementation', 'nsdi', 'page', '613–627', 'boston', '2017', 'usenix', 'association', 'curino', 'philip', 'charles', 'jones', 'popa', 'malviya', 'madden', 'balakrishnan', 'zeldovich', 'relational', 'cloud', 'database-as-a-service', 'cloud', '2011', 'deng', 'dong', 'socher', 'l.-j', 'fei-fei', 'imagenet', 'large-scale', 'hierarchical', 'image', 'database', 'cvpr09', '2009', 'devries', 'taylor', 'improve', 'regularization', 'convolutional', 'neural', 'network', 'cutout', 'corr', 'abs/1708.04552', '2017', 'golovin', 'solnik', 'moitra', 'kochanski', 'karro', 'sculley', 'editor', 'google', 'vizier', 'service', 'black-box', 'optimization', '2017', 'zhang', 'ren', 'sun', 'deep', 'residual', 'learn', 'image', 'recognition', 'corr', 'abs/1512.03385', '2015', 'hinton', 'osindero', 'y.-w.', 'teh', 'fast', 'learn', 'algorithm', 'deep', 'belief', 'net', 'neural', 'comput.', ':1527–1554', 'july', '2006', 'howard', 'zhu', 'chen', 'kalenichenko', 'wang', 'weyand', 'andreetto', 'adam', 'mobilenets', 'efficient', 'convolutional', 'neural', 'network', 'mobile', 'vision', 'application', 'corr', 'abs/1704.04861', '2017', 'iandola', 'moskewicz', 'ashraf', 'han', 'dally', 'keutzer', 'squeezenet', 'alexnet-level', 'accuracy', '50x', 'fewer', 'parameter', '1mb', 'model', 'size', 'corr', 'abs/1602.07360', '2016', 'kang', 'emmons', 'abuzaid', 'bailis', 'zaharia', 'noscope', 'optimize', 'neural', 'network', 'query', 'video', 'scale', 'proc', 'vldb', 'endow.', ':1586–1597', 'aug.', '2017', 'krizhevsky', 'sutskever', 'hinton', 'imagenet', 'classification', 'deep', 'convolutional', 'neural', 'network', 'nip', 'page', '1106–1114', '2012', 'kuncheva', 'whitaker', 'measure', 'diversity', 'classifier', 'ensemble', 'relationship', 'ensemble', 'accuracy', 'mach', 'learn.', ':181–207', 'may', '2003', 'lecun', 'bengio', 'hinton', 'deep', 'learn', 'nature', '521', '7553', ':436–444', '2015', 'zhong', 'liu', 'zhang', 'ease.ml', 'towards', 'multi-tenant', 'resource', 'share', 'machine', 'learn', 'workload', 'arxiv:1708.07308', '2017', 'deep', 'reinforcement', 'learn', 'overview', 'corr', 'abs/1701.07274', '2017', 'mnih', 'puigdomènech', 'badia', 'mirza', 'graf', 'lillicrap', 'harley', 'silver', 'kavukcuoglu', 'asynchronous', 'method', 'deep', 'reinforcement', 'learn', 'arxiv', 'e-prints', 'feb.', '2016', 'modi', 'koo', 'foo', 'mewald', 'baylor', 'breck', 'h.-t.', 'cheng', 'wilkiewicz', 'koc', 'lew', 'zinkevich', 'wicke', 'ispir', 'polyzotis', 'fiedel', 'haykal', 'whang', 'roy', 'ramesh', 'jain', 'zhang', 'haque', 'tfx', 'tensorflow-based', 'production-scale', 'machine', 'learn', 'platform', 'kdd', '2017', '2017', 'ooi', 'tan', 'wang', 'wang', 'cai', 'chen', 'gao', 'luo', 'tung', 'wang', 'xie', 'zhang', 'zheng', 'singa', 'distribute', 'deep', 'learn', 'platform', 'acm', 'multimedia', 'page', '685–688', '2015', 'ré', 'agrawal', 'balazinska', 'cafarella', 'jordan', 'kraska', 'ramakrishnan', 'machine', 'learn', 'database', 'the', 'sound', 'thing', 'come', 'cacophony', 'hype', 'sigmod', 'page', '283–284', '2015', 'schulman', 'wolski', 'dhariwal', 'radford', 'klimov', 'proximal', 'policy', 'optimization', 'algorithm', 'corr', 'abs/1707.06347', '2017', 'sculley', 'holt', 'golovin', 'davydov', 'phillips', 'ebner', 'chaudhary', 'young', 'machine', 'learn', 'the', 'high', 'interest', 'credit', 'card', 'technical', 'debt', 'se4ml', 'software', 'engineer', 'machine', 'learn', 'nip', '2014', 'workshop', '2014', 'shahriari', 'swersky', 'wang', 'adam', 'freitas', 'take', 'human', 'loop', 'review', 'bayesian', 'optimization', 'proceed', 'ieee', '104', ':148–175', 'jan', '2016', 'simonyan', 'zisserman', 'very', 'deep', 'convolutional', 'network', 'large-scale', 'image', 'recognition', 'corr', 'abs/1409.1556', '2014', 'snoek', 'larochelle', 'adam', 'practical', 'bayesian', 'optimization', 'machine', 'learn', 'algorithm', 'arxiv', 'e-prints', 'june', '2012', 'snoek', 'rippel', 'swersky', 'kiros', 'satish', 'sundaram', 'patwary', 'prabhat', 'adam', 'scalable', 'bayesian', 'optimization', 'use', 'deep', 'neural', 'network', 'arxiv', 'e-prints', 'feb.', '2015', 'sutskever', 'marten', 'dahl', 'hinton', 'importance', 'initialization', 'momentum', 'deep', 'learn', 'proceed', '30th', 'international', 'conference', 'international', 'conference', 'machine', 'learn', 'volume', 'icml', 'page', 'iii–1139–iii–1147', 'jmlr.org', '2013', 'sutton', 'barto', 'introduction', 'reinforcement', 'learn', 'mit', 'press', 'cambridge', 'usa', '1st', 'edition', '1998', 'szegedy', 'liu', 'jia', 'sermanet', 'reed', 'anguelov', 'erhan', 'vanhoucke', 'rabinovich', 'go', 'deeper', 'convolution', 'corr', 'abs/1409.4842', '2014', 'wang', 'chen', 'chen', 'dinh', 'gao', 'ooi', 'k.-l.', 'tan', 'wang', 'deep', 'learn', 'scale', 'ease', 'transaction', 'multimedia', 'compute', 'communication', 'application', '2016', 'wang', 'chen', 'dinh', 'gao', 'ooi', 'tan', 'wang', 'singa', 'put', 'deep', 'learn', 'hand', 'multimedia', 'user', 'acm', 'multimedia', 'page', '25–34', '2015', 'wang', 'yang', 'ooi', 'zhang', 'zhuang', 'effective', 'deep', 'learning-based', 'multi-modal', 'retrieval', 'the', 'vldb', 'journal', 'page', '1–23', '2015', 'wang', 'zhang', 'chen', 'jagadish', 'ooi', 'k.-l.', 'tan', 'database', 'meet', 'deep', 'learn', 'challenge', 'opportunity', 'acm', 'sigmod', 'record', ':17–22', '2016', 'zhang', 'zeng', 'zhang', 'how', 'good', 'machine', 'learn', 'cloud', 'binary', 'classification', 'good', 'feature', 'corr', 'abs/1707.09562', '2017', 'zoph', 'neural', 'architecture', 'search', 'reinforcement', 'learn', 'corr', 'abs/1611.01578', '2016']
